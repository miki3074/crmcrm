import{r as h,j as y,o as a,c as n,a as i,d as c,F as x,e as g,f,t as _}from"./app-e92293fe.js";const w={class:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6"},v={class:"flex items-center justify-between mb-3"},C={key:0},F={key:0,class:"space-y-2"},$=["href"],j=["onClick"],B={key:1,class:"text-sm text-gray-500"},N={__name:"SubtaskFiles",props:["subtask","user"],emits:["refresh"],setup(o,{emit:p}){const l=o,d=p,m=h(null),u=y(()=>{const{subtask:t,user:e}=l;return!t||!e?!1:t.creator_id===e.id||(t.executors||[]).some(s=>s.id===e.id)||(t.responsibles||[]).some(s=>s.id===e.id)}),k=async t=>{const e=t.target.files[0];if(!e)return;const s=new FormData;s.append("file",e);try{await f.post(`/api/subtasks/${l.subtask.id}/files`,s,{headers:{"Content-Type":"multipart/form-data"}}),d("refresh")}catch{alert("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏")}},b=async t=>{confirm("–£–¥–∞–ª–∏—Ç—å?")&&(await f.delete(`/api/subtask-files/${t}`),d("refresh"))};return(t,e)=>{var s;return a(),n("div",w,[i("div",v,[e[1]||(e[1]=i("h3",{class:"font-semibold dark:text-white"},"üìé –§–∞–π–ª—ã",-1)),u.value?(a(),n("div",C,[i("input",{type:"file",onChange:k,class:"hidden",ref_key:"fileInput",ref:m},null,544),i("button",{onClick:e[0]||(e[0]=r=>t.$refs.fileInput.click()),class:"px-3 py-1 bg-blue-600 text-white rounded text-sm"},"–ó–∞–≥—Ä—É–∑–∏—Ç—å")])):c("",!0)]),(s=o.subtask.files)!=null&&s.length?(a(),n("ul",F,[(a(!0),n(x,null,g(o.subtask.files,r=>(a(),n("li",{key:r.id,class:"flex justify-between items-center bg-gray-50 dark:bg-gray-700 p-2 rounded"},[i("a",{href:`/api/subtask-files/${r.id}/download`,class:"text-blue-600 hover:underline text-sm"},_(r.filename),9,$),u.value?(a(),n("button",{key:0,onClick:I=>b(r.id),class:"text-red-500"},"‚ùå",8,j)):c("",!0)]))),128))])):(a(),n("p",B,"–ù–µ—Ç —Ñ–∞–π–ª–æ–≤"))])}}};export{N as default};
