import{r as c,m as A,o,f as r,b as t,g as p,F as _,s as C,t as u,j as $,v as P,i as k,n as ve,x as K,Q as Oe,q as Ze,a as ue,u as Ce,w as $e,Z as Qe,d as Ge,k as ce}from"./app-a5a3f45a.js";import{_ as Je}from"./AuthenticatedLayout-b25ea513.js";import{_ as Ke}from"./_plugin-vue_export-helper-c27b6911.js";import"./ApplicationLogo-900c99c9.js";const Xe={class:"mt-4 bg-white dark:bg-slate-800 p-4 rounded-xl shadow relative"},Ye={key:0,class:"text-gray-500 text-sm"},et={key:1,class:"space-y-4"},tt={class:"flex justify-between"},st={class:"text-xs text-gray-500"},at={key:0},lt={class:"mt-2 flex gap-2"},ot=["onClick"],rt={key:1},nt=["innerHTML"],dt={key:2,class:"mt-4 relative"},it={key:0,class:"absolute left-0 mt-1 bg-white dark:bg-slate-700 border rounded-lg shadow p-2 max-h-40 overflow-auto z-50 w-64"},ut=["onClick"],ct={__name:"SubtaskComments",props:{subtaskId:Number,comments:Array,canWrite:Boolean,members:{type:Array,default:()=>[]}},emits:["updated"],setup(U,{emit:W}){const b=U,s=W,i=c(""),x=c(null),E=c(""),D=c(!1),T=c(""),R=c(0),M=v=>{const m=v.target.value,g=v.target.selectionStart;R.value=g;const F=m.slice(0,g).match(/@([\w–ê-–Ø–∞-—è–Å—ë]*)$/);F?(T.value=F[1].toLowerCase(),D.value=!0):D.value=!1},y=A(()=>T.value?b.members.filter(v=>v.name.toLowerCase().includes(T.value)):b.members),B=v=>{const m=`@${v.name}`,g=i.value,f=R.value,F=g.slice(0,f).replace(/@([\w–ê-–Ø–∞-—è–Å—ë]*)$/,m+" "),pe=g.slice(f);i.value=F+pe,D.value=!1,T.value="",setTimeout(()=>{const Z=document.querySelector("#subtask-comment-input");Z&&(Z.selectionStart=Z.selectionEnd=F.length,Z.focus())},0)},q=v=>v.replace(/@([A-Za-z0-9_]+)/g,'<span class="text-indigo-600 font-semibold">@$1</span>'),H=async()=>{if(!i.value.trim())return;const m=(i.value.match(/@([\w–ê-–Ø–∞-—è–Å—ë]+)/g)||[]).map(f=>b.members.find(F=>F.name===f.substring(1))).filter(Boolean).map(f=>f.id),{data:g}=await k.post(`/api/subtasks/${b.subtaskId}/comments`,{comment:i.value,mentions:m});s("updated",{type:"add",comment:g}),i.value=""},O=async v=>{if(!E.value.trim())return;const{data:m}=await k.patch(`/api/subtask-comments/${v}`,{comment:E.value});s("updated",{type:"update",comment:m}),x.value=null,E.value=""};return(v,m)=>(o(),r("div",Xe,[m[3]||(m[3]=t("h3",{class:"text-lg font-semibold mb-3"},"üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏",-1)),!U.comments||U.comments.length===0?(o(),r("p",Ye," –ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. ")):p("",!0),U.comments&&U.comments.length?(o(),r("div",et,[(o(!0),r(_,null,C(U.comments,g=>(o(),r("div",{key:g.id,class:"p-3 border dark:border-slate-700 rounded-lg"},[t("div",tt,[t("strong",null,u(g.user.name),1),t("span",st,u(new Date(g.created_at).toLocaleString("ru-RU")),1)]),x.value===g.id?(o(),r("div",at,[$(t("textarea",{"onUpdate:modelValue":m[0]||(m[0]=f=>E.value=f),class:"w-full border rounded-lg px-2 py-1 mt-2 dark:bg-slate-700 dark:text-white",rows:"2"},null,512),[[P,E.value]]),t("div",lt,[t("button",{onClick:f=>O(g.id),class:"px-3 py-1 bg-green-600 text-white rounded-lg text-sm"}," –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ",8,ot),t("button",{onClick:m[1]||(m[1]=f=>x.value=null),class:"px-3 py-1 bg-gray-400 text-white rounded-lg text-sm"}," –û—Ç–º–µ–Ω–∞ ")])])):(o(),r("div",rt,[t("p",{class:"mt-2 whitespace-pre-line",innerHTML:q(g.comment)},null,8,nt)]))]))),128))])):p("",!0),U.canWrite?(o(),r("div",dt,[$(t("textarea",{id:"subtask-comment-input","onUpdate:modelValue":m[2]||(m[2]=g=>i.value=g),onInput:M,onClick:M,placeholder:"–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏ –æ—Ç–º–µ—Ç–∏—Ç—å —á–µ–ª–æ–≤–µ–∫–∞ —á–µ—Ä–µ–∑ @...",class:"w-full border rounded-lg px-3 py-2 dark:bg-slate-700 dark:text-white",rows:"3"},null,544),[[P,i.value]]),D.value&&y.value.length?(o(),r("div",it,[(o(!0),r(_,null,C(y.value,g=>(o(),r("div",{key:g.id,class:"p-1 cursor-pointer hover:bg-gray-200 dark:hover:bg-slate-600",onClick:f=>B(g)}," @"+u(g.name),9,ut))),128))])):p("",!0),t("button",{onClick:H,class:"mt-3 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700"}," ‚û§ –î–æ–±–∞–≤–∏—Ç—å ")])):p("",!0)]))}},pt=Ke(ct,[["__scopeId","data-v-388871ef"]]),mt={class:"mt-6 p-4 bg-white dark:bg-slate-800 rounded-xl shadow"},vt={key:0,class:"text-gray-500 text-sm"},gt={key:1,class:"space-y-3"},bt={class:"flex items-center gap-3"},xt=["checked","onChange"],yt={key:0,class:"text-xs text-gray-500"},kt={key:2,class:"mt-4"},ft=["value"],ht={__name:"SubtaskChecklist",props:{subtaskId:Number,checklist:{type:Array,default:()=>[]},executors:{type:Array,default:()=>[]},responsibles:{type:Array,default:()=>[]},canWrite:Boolean},emits:["updated"],setup(U,{emit:W}){const b=U,s=A(()=>b.checklist??[]),i=c(""),x=c(null),E=W,D=async()=>{if(!i.value.trim())return;const{data:R}=await k.post(`/api/subtasks/${b.subtaskId}/checklist`,{title:i.value,responsible_id:x.value});E("updated",{type:"add",item:R}),i.value="",x.value=null},T=async R=>{const{data:M}=await k.patch(`/api/subtask-checklist/${R.id}/toggle`);E("updated",{type:"toggle",id:R.id,completed:M.completed})};return(R,M)=>(o(),r("div",mt,[M[3]||(M[3]=t("h3",{class:"text-lg font-semibold mb-3"},"üìù –ß–µ–∫-–ª–∏—Å—Ç",-1)),s.value.length===0?(o(),r("p",vt," –ü—É—Å—Ç–æ. ")):(o(),r("div",gt,[(o(!0),r(_,null,C(s.value,y=>(o(),r("div",{key:y.id,class:"p-3 border rounded-lg dark:border-slate-700 flex justify-between items-center"},[t("div",bt,[t("input",{type:"checkbox",checked:y.completed,onChange:B=>T(y),class:"w-5 h-5"},null,40,xt),t("div",null,[t("p",{class:ve(y.completed?"line-through text-gray-400":"")},u(y.title),3),y.responsible?(o(),r("p",yt," üë§ "+u(y.responsible.name),1)):p("",!0)])])]))),128))])),U.canWrite?(o(),r("div",kt,[$(t("input",{"onUpdate:modelValue":M[0]||(M[0]=y=>i.value=y),class:"w-full border rounded-lg px-3 py-2 dark:bg-slate-700 dark:text-white",placeholder:"–ù–æ–≤—ã–π –ø—É–Ω–∫—Ç..."},null,512),[[P,i.value]]),$(t("select",{"onUpdate:modelValue":M[1]||(M[1]=y=>x.value=y),class:"w-full border rounded-lg px-3 py-2 mt-2 dark:bg-slate-700 dark:text-white"},[M[2]||(M[2]=t("option",{value:null},"–ë–µ–∑ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ",-1)),(o(!0),r(_,null,C([...U.executors,...U.responsibles],y=>(o(),r("option",{key:y.id,value:y.id},u(y.name),9,ft))),128))],512),[[K,x.value]]),t("button",{onClick:D,class:"mt-2 bg-indigo-600 text-white px-4 py-2 rounded-lg"}," ‚ûï –î–æ–±–∞–≤–∏—Ç—å ")])):p("",!0)]))}},wt={class:"flex items-center justify-between gap-3"},_t={class:"text-xl font-bold text-gray-800 dark:text-gray-200"},Ct={key:0,class:"flex items-center gap-2"},$t={class:"inline-flex items-center gap-2 text-sm px-3 py-1 rounded-full ring-1 ring-gray-200 dark:ring-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"},jt={key:4,class:"px-3 py-1.5 rounded-md bg-emerald-100 text-emerald-700 text-sm dark:bg-emerald-900/30 dark:text-emerald-300"},Mt={class:"max-w-4xl mx-auto py-8 px-4"},Et={key:0,class:"grid gap-6"},St={class:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6"},Ut={class:"grid sm:grid-cols-2 gap-4 text-sm"},It={class:"font-medium text-gray-900 dark:text-white"},Vt={class:"font-medium text-gray-900 dark:text-white"},Rt={class:"font-medium text-gray-900 dark:text-white"},zt={key:0,class:"flex flex-wrap gap-2 mt-4"},At={key:0,class:"mt-4 p-3 bg-gray-100 dark:bg-gray-700 rounded-lg bg-white dark:bg-gray-800 rounded-2xl shadow p-6"},Dt={style:{"word-break":"break-all"},class:"whitespace-pre-line"},Ft={class:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6"},Tt={class:"flex items-center justify-between mb-3"},Lt={class:"text-sm text-gray-500 dark:text-gray-400"},Pt={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},Bt={class:"font-medium text-gray-900 dark:text-white"},Nt={class:"font-medium text-gray-900 dark:text-white"},Wt={class:"flex mt-2 space-x-1 select-none"},qt=["title","onClick"],Ht={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-2"},Ot={class:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6 mt-6"},Zt={class:"flex items-center justify-between mb-3"},Qt={key:0},Gt={key:0,class:"space-y-2"},Jt=["href"],Kt=["onClick"],Xt={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},Yt={key:1,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},es={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl"},ts=["value"],ss=["value"],as={key:0,class:"text-rose-600 text-sm mt-2"},ls={class:"flex justify-end gap-2 mt-4"},os={key:2,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},rs={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl"},ns={class:"space-y-4"},ds={class:"max-h-40 overflow-y-auto border rounded-lg p-2 dark:border-gray-600"},is=["value"],us={class:"max-h-40 overflow-y-auto border rounded-lg p-2 dark:border-gray-600"},cs=["value"],ps={key:0,class:"text-rose-600 text-sm mt-3"},ms={class:"flex justify-end gap-2 mt-5"},vs=["disabled"],gs={key:0},bs={key:1},xs={key:3,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},ys={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl"},ks=["value"],fs=["value"],hs={key:0,class:"text-rose-600 text-sm mt-2"},ws={class:"flex justify-end gap-2 mt-4"},_s={key:4,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},Cs={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl"},$s={class:"max-h-60 overflow-y-auto border rounded-lg p-2 dark:border-gray-600"},js=["value"],Ms={class:"flex justify-end gap-2 mt-4"},Es={key:5,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},Ss={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl"},Us={class:"max-h-60 overflow-y-auto border rounded-lg p-2 dark:border-gray-600"},Is=["value"],Vs={class:"flex justify-end gap-2 mt-4"},Rs={key:6,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},zs={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-3xl shadow-xl"},As={key:0,class:"text-sm text-rose-600 mb-3"},Ds={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},Fs={class:"space-y-2"},Ts=["onClick"],Ls={key:0,class:"text-sm text-gray-500"},Ps={class:"space-y-2"},Bs=["onClick"],Ns={key:0,class:"text-sm text-gray-500"},Ws={class:"flex justify-end mt-6"},qs={class:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6 mt-6"},Hs={class:"flex items-center justify-between mb-3"},Os={key:0,class:"space-y-2"},Zs={class:"font-medium"},Qs={class:"text-xs text-gray-500 ml-2"},Gs=["href"],Js={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},Ks={"data-v-585ee726":"",class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},Xs={key:7,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},Ys={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl"},ea={class:"space-y-4"},ta={key:0,class:"text-rose-600 text-sm mt-3"},sa={class:"flex justify-end gap-2 mt-5"},aa=["disabled"],la={key:0},oa={key:1},ra={key:8,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},na={class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-xl w-full max-w-lg"},da={class:"mt-4 flex justify-end gap-2"},ia={key:1,class:"text-gray-600 dark:text-gray-300"},ga={__name:"Show",setup(U){var ye;const{props:W}=Oe(),b=W.id,s=c(null),i=(ye=W.auth)==null?void 0:ye.user,x=async()=>{const{data:l}=await k.get(`/api/subtasks/${b}`);s.value=l},E=A(()=>{var S,L;if(!s.value||!i)return!1;const l=((S=s.value.task)==null?void 0:S.project)||{},e=(s.value.executors||[]).some(w=>w.id===i.id),n=(s.value.responsibles||[]).some(w=>w.id===i.id),d=(l.executors||[]).some(w=>w.id===i.id),h=(l.managers||[]).some(w=>w.id===i.id),j=((L=l.company)==null?void 0:L.user_id)===i.id,V=s.value.creator_id===i.id;return e||n||d||h||j||V}),D=A(()=>s.value?E.value&&s.value.progress===100&&!s.value.completed:!1),T=async l=>{if(!E.value)return;const{data:e}=await k.patch(`/api/subtasks/${b}/progress`,{progress:l});s.value.progress=e.progress},R=async()=>{if(!D.value||!confirm("–ó–∞–≤–µ—Ä—à–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É?"))return;const{data:l}=await k.patch(`/api/subtasks/${b}/complete`);s.value.completed=l.completed,s.value.completed_at=l.completed_at},M=async l=>{var e,n;if(confirm("–£–¥–∞–ª–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É?"))try{await k.delete(`/api/subtasks/${l}`,{withCredentials:!0}),alert("–ü–æ–¥–∑–∞–¥–∞—á–∞ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞"),window.history.back()}catch(d){alert(((n=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:n.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–¥–∑–∞–¥–∞—á–∏")}},y=l=>{var n,d,h,j,V;const e=i==null?void 0:i.id;return e?e===l.creator_id||e===((h=(d=(n=l.task)==null?void 0:n.project)==null?void 0:d.company)==null?void 0:h.user_id)||(((V=(j=l.task)==null?void 0:j.project)==null?void 0:V.managers)||[]).some(S=>S.id===e):!1},B=c(!1),q=c(!1),H=c(!1),O=c(!1),v=c([]);c(null);const m=c([]),g=A(()=>{var l,e,n,d,h,j,V;return!s.value||!i?!1:i.id===((n=(e=(l=s.value.task)==null?void 0:l.project)==null?void 0:e.company)==null?void 0:n.user_id)||(((h=(d=s.value.task)==null?void 0:d.project)==null?void 0:h.managers)||[]).some(S=>S.id===i.id)||(((V=(j=s.value.task)==null?void 0:j.project)==null?void 0:V.executors)||[]).some(S=>S.id===i.id)}),f=async()=>{const{data:l}=await k.get(`/api/projects/${s.value.task.project.id}/employees`);v.value=l},F=async()=>{await f(),B.value=!0},pe=async()=>{await f(),q.value=!0},Z=async()=>{await f(),H.value=!0},je=async()=>{await f(),O.value=!0},Me=async()=>{var l,e;if(!m.value.length)return alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.");try{await k.post(`/api/subtasks/${b}/executors/add`,{user_ids:m.value}),await x(),H.value=!1,m.value=[]}catch(n){alert(((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π")}},Ee=async()=>{var l,e;if(!m.value.length)return alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.");try{await k.post(`/api/subtasks/${b}/responsibles/add`,{user_ids:m.value}),await x(),O.value=!1,m.value=[]}catch(n){alert(((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö")}},X=c(null),Y=c(null),ee=c(null),te=c(null),G=c(""),J=c(""),Se=A(()=>{if(!v.value.length||!s.value)return[];const l=(s.value.executors||[]).map(e=>e.id);return v.value.filter(e=>!l.includes(e.id))}),Ue=A(()=>{if(!v.value.length||!s.value)return[];const l=(s.value.responsibles||[]).map(e=>e.id);return v.value.filter(e=>!l.includes(e.id))}),Ie=async()=>{var l,e;if(G.value="",!X.value||!Y.value){G.value="–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–≥–æ –∏ –Ω–∞ –∫–æ–≥–æ –∑–∞–º–µ–Ω–∏—Ç—å.";return}try{await k.patch(`/api/subtasks/${b}/executor/change`,{replace_user_id:X.value,user_id:Y.value}),B.value=!1,await x()}catch(n){G.value=((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–º–µ–Ω–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è"}},Ve=async()=>{var l,e;if(J.value="",!ee.value||!te.value){J.value="–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–≥–æ –∏ –Ω–∞ –∫–æ–≥–æ –∑–∞–º–µ–Ω–∏—Ç—å.";return}try{await k.patch(`/api/subtasks/${b}/responsible/change`,{replace_user_id:ee.value,user_id:te.value}),q.value=!1,await x()}catch(n){J.value=((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–º–µ–Ω–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ"}},me=c(!1),Q=c(""),Re=async l=>{var e,n;Q.value="";try{await k.delete(`/api/subtasks/${b}/executors`,{data:{user_id:l}}),await x()}catch(d){Q.value=((n=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:n.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è"}},ze=async l=>{var e,n;Q.value="";try{await k.delete(`/api/subtasks/${b}/responsibles`,{data:{user_id:l}}),await x()}catch(d){Q.value=((n=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:n.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ"}},se=c(!1),ae=c(!1),le=c(""),N=c({title:"",due_date:""}),Ae=()=>{s.value&&(N.value.title=s.value.title,N.value.due_date=s.value.due_date,se.value=!0)},De=async()=>{var l,e;le.value="",ae.value=!0;try{await k.patch(`/api/subtasks/${b}/update`,N.value),await x(),se.value=!1}catch(n){le.value=((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ–¥–∑–∞–¥–∞—á–∏"}finally{ae.value=!1}},ge=A(()=>{var e,n;if(!s.value||!i)return!1;const l=(e=s.value.task)==null?void 0:e.project;return i.id===s.value.creator_id||i.id===((n=l==null?void 0:l.company)==null?void 0:n.user_id)||((l==null?void 0:l.managers)||[]).some(d=>d.id===i.id)||((l==null?void 0:l.executors)||[]).some(d=>d.id===i.id)}),be=A(()=>{var e,n;if(!s.value||!i)return!1;const l=((e=s.value.task)==null?void 0:e.project)||{};return i.id===s.value.creator_id||(s.value.executors||[]).some(d=>d.id===i.id)||(s.value.responsibles||[]).some(d=>d.id===i.id)||(l.executors||[]).some(d=>d.id===i.id)||(l.managers||[]).some(d=>d.id===i.id)||((n=l.company)==null?void 0:n.user_id)===i.id}),Fe=c(null),Te=async l=>{var d,h;const e=l.target.files[0];if(!e)return;const n=new FormData;n.append("file",e);try{await k.post(`/api/subtasks/${b}/files`,n,{headers:{"Content-Type":"multipart/form-data"}}),await x()}catch(j){alert(((h=(d=j==null?void 0:j.response)==null?void 0:d.data)==null?void 0:h.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞")}},Le=async l=>{var e,n;if(confirm("–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª?"))try{await k.delete(`/api/subtask-files/${l}`),await x()}catch(d){alert(((n=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:n.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞")}},oe=c(!1),re=c(!1),ne=c(""),z=c({title:"",due_date:"",executor_ids:[],responsible_ids:[]}),Pe=async()=>{await f(),oe.value=!0},Be=async()=>{var l,e;if(s.value){ne.value="",re.value=!0;try{await k.post(`/api/subtasks/${b}/children`,z.value),await x(),oe.value=!1,z.value={title:"",due_date:"",executor_ids:[],responsible_ids:[]}}catch(n){ne.value=((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–¥–∑–∞–¥–∞—á–∏"}finally{re.value=!1}}},Ne=({type:l,comment:e,id:n})=>{if(s.value.comments||(s.value.comments=[]),l==="add"&&s.value.comments.push(e),l==="update"){const d=s.value.comments.findIndex(h=>h.id===e.id);d!==-1&&(s.value.comments[d]=e)}l==="delete"&&(s.value.comments=s.value.comments.filter(d=>d.id!==n))},xe=A(()=>{var S,L;if(!s.value||!i)return!1;const l=((S=s.value.task)==null?void 0:S.project)||{},e=s.value.creator_id===i.id,n=(l.managers||[]).some(w=>w.id===i.id),d=(l.executors||[]).some(w=>w.id===i.id),h=((L=l.company)==null?void 0:L.user_id)===i.id,j=(s.value.executors||[]).some(w=>w.id===i.id),V=(s.value.responsibles||[]).some(w=>w.id===i.id);return e||n||d||h||j||V}),We=l=>{if(s.value.checklist||(s.value.checklist=[]),l.type==="add"&&s.value.checklist.push(l.item),l.type==="toggle"){const e=s.value.checklist.find(n=>n.id===l.id);e&&(e.completed=l.completed)}l.type==="delete"&&(s.value.checklist=s.value.checklist.filter(e=>e.id!==l.id))},de=c(!1),ie=c(""),qe=()=>{ie.value=s.value.description||"",de.value=!0},He=async()=>{var l,e;try{const{data:n}=await k.patch(`/api/subtasks/${b}/description`,{description:ie.value});s.value.description=n.description,de.value=!1}catch(n){alert(((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.message)||"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è")}};return Ze(x),(l,e)=>(o(),r(_,null,[ue(Ce(Qe),{title:"–ü–æ–¥–∑–∞–¥–∞—á–∞"}),ue(Je,null,{header:$e(()=>{var n,d;return[t("div",wt,[t("h2",_t," –ü–æ–¥–∑–∞–¥–∞—á–∞: "+u(((n=s.value)==null?void 0:n.title)??"–ó–∞–≥—Ä—É–∑–∫–∞..."),1),s.value?(o(),r("div",Ct,[t("span",$t,[t("span",{class:ve(["w-2 h-2 rounded-full",{"bg-red-500":(s.value.progress??0)<30,"bg-amber-500":(s.value.progress??0)>=30&&(s.value.progress??0)<70,"bg-green-500":(s.value.progress??0)>=70}])},null,2),Ge(" "+u(s.value.progress??0)+"% ",1)]),D.value?(o(),r("button",{key:0,onClick:R,class:"px-3 py-1.5 rounded-md bg-emerald-600 text-white text-sm hover:bg-emerald-700"}," –ó–∞–≤–µ—Ä—à–∏—Ç—å ")):p("",!0),ge.value?(o(),r("button",{key:1,onClick:Ae,class:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-md"}," ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É ")):p("",!0),Ce(i).id===s.value.creator_id?(o(),r("button",{key:2,onClick:qe,class:"px-3 py-1 bg-indigo-600 text-white rounded-lg mt-3"}," ‚úè –û–ø–∏—Å–∞–Ω–∏–µ ")):p("",!0),y(s.value)?(o(),r("button",{key:3,onClick:e[0]||(e[0]=h=>M(s.value.id)),class:"px-3 py-1 bg-rose-600 hover:bg-rose-700 text-white text-sm rounded-md"}," üóë –£–¥–∞–ª–∏—Ç—å ")):s.value.completed?(o(),r("span",jt," –ó–∞–≤–µ—Ä—à–µ–Ω–∞ ‚Ä¢ "+u(((d=s.value.completed_at)==null?void 0:d.slice(0,16))??""),1)):p("",!0)])):p("",!0)])]}),default:$e(()=>{var n,d,h,j,V,S,L,w,ke,fe,he,we,_e;return[t("div",Mt,[s.value?(o(),r("div",Et,[t("div",St,[t("div",Ut,[t("div",null,[e[24]||(e[24]=t("p",{class:"text-gray-500 dark:text-gray-400"},"–ê–≤—Ç–æ—Ä",-1)),t("p",It,u((n=s.value.creator)==null?void 0:n.name),1),e[25]||(e[25]=t("p",{class:"text-gray-500 dark:text-gray-400 mt-4"},"–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å",-1)),t("p",Vt,u((d=s.value.executors)!=null&&d.length?s.value.executors.map(a=>a.name).join(", "):"‚Äî"),1),e[26]||(e[26]=t("p",{class:"text-gray-500 dark:text-gray-400 mt-4"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π",-1)),t("p",Rt,u((h=s.value.responsibles)!=null&&h.length?s.value.responsibles.map(a=>a.name).join(", "):"‚Äî"),1)]),g.value?(o(),r("div",zt,[t("button",{onClick:F,class:"px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded-md"}," ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è "),t("button",{onClick:pe,class:"px-3 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded-md"}," ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ "),t("button",{onClick:Z,class:"px-3 py-1 bg-emerald-500 hover:bg-emerald-600 text-white rounded-md"}," ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è "),t("button",{onClick:je,class:"px-3 py-1 bg-amber-500 hover:bg-amber-600 text-white rounded-md"}," ‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ "),t("button",{onClick:e[1]||(e[1]=a=>me.value=!0),class:"px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg"}," üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ ")])):p("",!0)])]),s.value.description?(o(),r("div",At,[e[27]||(e[27]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-white"},"–û–ø–∏—Å–∞–Ω–∏–µ",-1)),t("p",Dt,u(s.value.description),1)])):p("",!0),t("div",Ft,[t("div",Tt,[e[28]||(e[28]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-white"},"–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–¥–∑–∞–¥–∞—á–∏",-1)),t("span",Lt,"–í—ã–ø–æ–ª–Ω–µ–Ω–æ "+u(s.value.progress??0)+"%",1)]),t("div",Pt,[t("div",null,[e[29]||(e[29]=t("p",{class:"text-gray-500 dark:text-gray-400"},"–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞",-1)),t("p",Bt,u(s.value.start_date),1)]),t("div",null,[e[30]||(e[30]=t("p",{class:"text-gray-500 dark:text-gray-400"},"–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è",-1)),t("p",Nt,u(s.value.due_date),1)])]),t("div",Wt,[(o(),r(_,null,C(10,a=>{var I;return t("div",{key:a,title:a*10+"%",onClick:ua=>E.value?T(a*10):null,class:ve(["h-4 sm:h-5 flex-1 rounded transition",{"cursor-pointer hover:opacity-80":E.value,"bg-green-600":(s.value.progress??0)>=a*10,"bg-gray-200 dark:bg-gray-700":(s.value.progress??0)<a*10,"pointer-events-none opacity-60":(I=s.value)==null?void 0:I.completed}])},null,10,qt)}),64))]),E.value?p("",!0):(o(),r("p",Ht," –ò–∑–º–µ–Ω—è—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –∏ –∞–≤—Ç–æ—Ä –ø–æ–¥–∑–∞–¥–∞—á–∏. "))]),t("div",Ot,[t("div",Zt,[e[31]||(e[31]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-white"},"üìé –§–∞–π–ª—ã –ø–æ–¥–∑–∞–¥–∞—á–∏",-1)),be.value?(o(),r("div",Qt,[t("input",{type:"file",onChange:Te,class:"hidden",ref_key:"fileInput",ref:Fe},null,544),t("button",{onClick:e[2]||(e[2]=a=>l.$refs.fileInput.click()),class:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm"}," ‚¨ÜÔ∏è –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª ")])):p("",!0)]),(j=s.value.files)!=null&&j.length?(o(),r("ul",Gt,[(o(!0),r(_,null,C(s.value.files,a=>(o(),r("li",{key:a.id,class:"flex justify-between items-center bg-gray-50 dark:bg-gray-700 p-2 rounded-lg"},[t("a",{href:`/api/subtask-files/${a.id}/download`,class:"text-blue-600 dark:text-blue-400 hover:underline"},u(a.filename),9,Jt),be.value?(o(),r("button",{key:0,onClick:I=>Le(a.id),class:"text-rose-500 hover:text-rose-700 text-sm"}," ‚ùå ",8,Kt)):p("",!0)]))),128))])):(o(),r("p",Xt,"–ù–µ—Ç –ø—Ä–∏–∫—Ä–µ–ø–ª—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤"))]),B.value?(o(),r("div",Yt,[t("div",es,[e[34]||(e[34]=t("h3",{class:"text-lg font-semibold mb-3 text-gray-900 dark:text-white"}," ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è ",-1)),e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –ö–æ–≥–æ –∑–∞–º–µ–Ω–∏—Ç—å: ",-1)),$(t("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>X.value=a),class:"w-full border rounded-lg p-2 mb-4 dark:bg-gray-700 dark:text-white"},[e[32]||(e[32]=t("option",{value:""},"–í—ã–±–µ—Ä–∏—Ç–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è",-1)),(o(!0),r(_,null,C(((V=s.value)==null?void 0:V.executors)||[],a=>(o(),r("option",{key:a.id,value:a.id},u(a.name),9,ts))),128))],512),[[K,X.value]]),e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –ù–∞ –∫–æ–≥–æ –∑–∞–º–µ–Ω–∏—Ç—å: ",-1)),$(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>Y.value=a),class:"w-full border rounded-lg p-2 dark:bg-gray-700 dark:text-white"},[e[33]||(e[33]=t("option",{value:""},"–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–≤–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è",-1)),(o(!0),r(_,null,C(Se.value,a=>(o(),r("option",{key:a.id,value:a.id},u(a.name)+" ("+u(a.email)+") ",9,ss))),128))],512),[[K,Y.value]]),G.value?(o(),r("p",as,u(G.value),1)):p("",!0),t("div",ls,[t("button",{onClick:e[5]||(e[5]=a=>B.value=!1),class:"px-4 py-2 border rounded-lg text-gray-600"}," –û—Ç–º–µ–Ω–∞ "),t("button",{onClick:Ie,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg"}," –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ")])])])):p("",!0),oe.value?(o(),r("div",os,[t("div",rs,[e[41]||(e[41]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," ‚ûï –ù–æ–≤–∞—è –¥–æ—á–µ—Ä–Ω—è—è –ø–æ–¥–∑–∞–¥–∞—á–∞ ",-1)),t("div",ns,[t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –ù–∞–∑–≤–∞–Ω–∏–µ ",-1)),$(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>z.value.title=a),type:"text",class:"w-full border rounded-lg p-2 dark:bg-gray-700 dark:text-white",placeholder:"–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏"},null,512),[[P,z.value.title]])]),t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è ",-1)),$(t("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>z.value.due_date=a),type:"date",class:"w-full border rounded-lg p-2 dark:bg-gray-700 dark:text-white"},null,512),[[P,z.value.due_date]])]),t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ ",-1)),t("div",ds,[(o(!0),r(_,null,C(v.value,a=>(o(),r("label",{key:a.id,class:"flex items-center gap-2 py-1"},[$(t("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=I=>z.value.executor_ids=I),value:a.id},null,8,is),[[ce,z.value.executor_ids]]),t("span",null,u(a.name)+" ("+u(a.email)+")",1)]))),128))])]),t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ ",-1)),t("div",us,[(o(!0),r(_,null,C(v.value,a=>(o(),r("label",{key:a.id,class:"flex items-center gap-2 py-1"},[$(t("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=I=>z.value.responsible_ids=I),value:a.id},null,8,cs),[[ce,z.value.responsible_ids]]),t("span",null,u(a.name)+" ("+u(a.email)+")",1)]))),128))])])]),ne.value?(o(),r("p",ps,u(ne.value),1)):p("",!0),t("div",ms,[t("button",{onClick:e[10]||(e[10]=a=>oe.value=!1),class:"px-4 py-2 border rounded-lg text-gray-600"}," –û—Ç–º–µ–Ω–∞ "),t("button",{onClick:Be,class:"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg",disabled:re.value},[re.value?(o(),r("span",bs,"–°–æ–∑–¥–∞—é...")):(o(),r("span",gs,"–°–æ–∑–¥–∞—Ç—å"))],8,vs)])])])):p("",!0),q.value?(o(),r("div",xs,[t("div",ys,[e[44]||(e[44]=t("h3",{class:"text-lg font-semibold mb-3 text-gray-900 dark:text-white"}," ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ ",-1)),e[45]||(e[45]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –ö–æ–≥–æ –∑–∞–º–µ–Ω–∏—Ç—å: ",-1)),$(t("select",{"onUpdate:modelValue":e[11]||(e[11]=a=>ee.value=a),class:"w-full border rounded-lg p-2 mb-4 dark:bg-gray-700 dark:text-white"},[e[42]||(e[42]=t("option",{value:""},"–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ",-1)),(o(!0),r(_,null,C(((S=s.value)==null?void 0:S.responsibles)||[],a=>(o(),r("option",{key:a.id,value:a.id},u(a.name),9,ks))),128))],512),[[K,ee.value]]),e[46]||(e[46]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –ù–∞ –∫–æ–≥–æ –∑–∞–º–µ–Ω–∏—Ç—å: ",-1)),$(t("select",{"onUpdate:modelValue":e[12]||(e[12]=a=>te.value=a),class:"w-full border rounded-lg p-2 dark:bg-gray-700 dark:text-white"},[e[43]||(e[43]=t("option",{value:""},"–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ",-1)),(o(!0),r(_,null,C(Ue.value,a=>(o(),r("option",{key:a.id,value:a.id},u(a.name)+" ("+u(a.email)+") ",9,fs))),128))],512),[[K,te.value]]),J.value?(o(),r("p",hs,u(J.value),1)):p("",!0),t("div",ws,[t("button",{onClick:e[13]||(e[13]=a=>q.value=!1),class:"px-4 py-2 border rounded-lg text-gray-600"}," –û—Ç–º–µ–Ω–∞ "),t("button",{onClick:Ve,class:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg"}," –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ")])])])):p("",!0),H.value?(o(),r("div",_s,[t("div",Cs,[e[47]||(e[47]=t("h3",{class:"text-lg font-semibold mb-3 text-gray-900 dark:text-white"}," ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π ",-1)),t("div",$s,[(o(!0),r(_,null,C(v.value,a=>(o(),r("label",{key:a.id,class:"flex items-center gap-2 py-1"},[$(t("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=I=>m.value=I),value:a.id},null,8,js),[[ce,m.value]]),t("span",null,u(a.name)+" ("+u(a.email)+")",1)]))),128))]),t("div",Ms,[t("button",{onClick:e[15]||(e[15]=a=>H.value=!1),class:"px-4 py-2 border rounded-lg text-gray-600"}," –û—Ç–º–µ–Ω–∞ "),t("button",{onClick:Me,class:"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg"}," –î–æ–±–∞–≤–∏—Ç—å ")])])])):p("",!0),O.value?(o(),r("div",Es,[t("div",Ss,[e[48]||(e[48]=t("h3",{class:"text-lg font-semibold mb-3 text-gray-900 dark:text-white"}," ‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö ",-1)),t("div",Us,[(o(!0),r(_,null,C(v.value,a=>(o(),r("label",{key:a.id,class:"flex items-center gap-2 py-1"},[$(t("input",{type:"checkbox","onUpdate:modelValue":e[16]||(e[16]=I=>m.value=I),value:a.id},null,8,Is),[[ce,m.value]]),t("span",null,u(a.name)+" ("+u(a.email)+")",1)]))),128))]),t("div",Vs,[t("button",{onClick:e[17]||(e[17]=a=>O.value=!1),class:"px-4 py-2 border rounded-lg text-gray-600"}," –û—Ç–º–µ–Ω–∞ "),t("button",{onClick:Ee,class:"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded-lg"}," –î–æ–±–∞–≤–∏—Ç—å ")])])])):p("",!0),me.value?(o(),r("div",Rs,[t("div",zs,[e[51]||(e[51]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ ",-1)),Q.value?(o(),r("p",As,u(Q.value),1)):p("",!0),t("div",Ds,[t("div",null,[e[49]||(e[49]=t("h4",{class:"text-gray-800 dark:text-gray-200 font-medium mb-2"},"–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏",-1)),t("ul",Fs,[(o(!0),r(_,null,C(((L=s.value)==null?void 0:L.executors)||[],a=>(o(),r("li",{key:a.id,class:"flex justify-between items-center bg-gray-50 dark:bg-gray-700 p-2 rounded-lg"},[t("span",null,u(a.name),1),t("button",{onClick:I=>Re(a.id),class:"text-rose-500 hover:text-rose-700",title:"–£–¥–∞–ª–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è"}," ‚ùå ",8,Ts)]))),128)),(ke=(w=s.value)==null?void 0:w.executors)!=null&&ke.length?p("",!0):(o(),r("li",Ls,"–ù–µ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π"))])]),t("div",null,[e[50]||(e[50]=t("h4",{class:"text-gray-800 dark:text-gray-200 font-medium mb-2"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ",-1)),t("ul",Ps,[(o(!0),r(_,null,C(((fe=s.value)==null?void 0:fe.responsibles)||[],a=>(o(),r("li",{key:a.id,class:"flex justify-between items-center bg-gray-50 dark:bg-gray-700 p-2 rounded-lg"},[t("span",null,u(a.name),1),t("button",{onClick:I=>ze(a.id),class:"text-rose-500 hover:text-rose-700",title:"–£–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ"}," ‚ùå ",8,Bs)]))),128)),(we=(he=s.value)==null?void 0:he.responsibles)!=null&&we.length?p("",!0):(o(),r("li",Ns,"–ù–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö"))])])]),t("div",Ws,[t("button",{onClick:e[18]||(e[18]=a=>me.value=!1),class:"px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-white rounded-lg"}," –ó–∞–∫—Ä—ã—Ç—å ")])])])):p("",!0),t("div",qs,[t("div",Hs,[e[52]||(e[52]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-white"},"üß© –í–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–¥–∑–∞–¥–∞—á–∏",-1)),ge.value?(o(),r("button",{key:0,onClick:Pe,class:"px-3 py-1 bg-emerald-600 hover:bg-emerald-700 text-white rounded-md text-sm"}," ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É ")):p("",!0)]),(_e=s.value.children)!=null&&_e.length?(o(),r("ul",Os,[(o(!0),r(_,null,C(s.value.children,a=>(o(),r("li",{key:a.id,class:"flex justify-between items-center bg-gray-50 dark:bg-gray-700 p-2 rounded-lg"},[t("div",null,[t("span",Zs,u(a.title),1),t("span",Qs,u(a.progress??0)+"%",1)]),t("a",{href:`/subtasks/${a.id}`,class:"text-blue-600 dark:text-blue-400 hover:underline text-sm"}," –û—Ç–∫—Ä—ã—Ç—å ‚Üí ",8,Gs)]))),128))])):(o(),r("p",Js,"–ù–µ—Ç –¥–æ—á–µ—Ä–Ω–∏—Ö –ø–æ–¥–∑–∞–¥–∞—á"))]),t("div",Ks,[ue(ht,{"subtask-id":s.value.id,checklist:s.value.checklist,executors:s.value.executors,responsibles:s.value.responsibles,"can-write":xe.value,onUpdated:We},null,8,["subtask-id","checklist","executors","responsibles","can-write"]),ue(pt,{"subtask-id":s.value.id,comments:s.value.comments,"can-write":xe.value,members:[...s.value.executors??[],...s.value.responsibles??[]],onUpdated:Ne},null,8,["subtask-id","comments","can-write","members"])]),se.value?(o(),r("div",Xs,[t("div",Ys,[e[55]||(e[55]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É ",-1)),t("div",ea,[t("div",null,[e[53]||(e[53]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –ù–∞–∑–≤–∞–Ω–∏–µ ",-1)),$(t("input",{required:"","onUpdate:modelValue":e[19]||(e[19]=a=>N.value.title=a),type:"text",class:"w-full border rounded-lg p-2 dark:bg-gray-700 dark:text-white",placeholder:"–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ"},null,512),[[P,N.value.title]])]),t("div",null,[e[54]||(e[54]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è ",-1)),$(t("input",{"onUpdate:modelValue":e[20]||(e[20]=a=>N.value.due_date=a),type:"date",class:"w-full border rounded-lg p-2 dark:bg-gray-700 dark:text-white"},null,512),[[P,N.value.due_date]])])]),le.value?(o(),r("p",ta,u(le.value),1)):p("",!0),t("div",sa,[t("button",{onClick:e[21]||(e[21]=a=>se.value=!1),class:"px-4 py-2 border rounded-lg text-gray-600"}," –û—Ç–º–µ–Ω–∞ "),t("button",{onClick:De,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg",disabled:ae.value},[ae.value?(o(),r("span",oa,"–°–æ—Ö—Ä–∞–Ω—è—é...")):(o(),r("span",la,"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"))],8,aa)])])])):p("",!0),de.value?(o(),r("div",ra,[t("div",na,[e[56]||(e[56]=t("h3",{class:"text-lg font-semibold mb-3"},"–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏",-1)),$(t("textarea",{"onUpdate:modelValue":e[22]||(e[22]=a=>ie.value=a),class:"w-full border rounded-lg px-3 py-2 dark:bg-gray-700 dark:text-white",rows:"6",placeholder:"–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ..."},null,512),[[P,ie.value]]),t("div",da,[t("button",{onClick:e[23]||(e[23]=a=>de.value=!1),class:"px-4 py-2 bg-gray-500 text-white rounded-lg"}," –ó–∞–∫—Ä—ã—Ç—å "),t("button",{onClick:He,class:"px-4 py-2 bg-indigo-600 text-white rounded-lg"}," –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ")])])])):p("",!0)])):(o(),r("div",ia,"–ó–∞–≥—Ä—É–∑–∫–∞..."))])]}),_:1})],64))}};export{ga as default};
