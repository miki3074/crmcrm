import{h as k,c as x,o as a,a as o,b as e,u as K,f as v,g as i,m as Q,M as X,O as Y,j as g,N as Z,t as m,w as y,v as z,P as F,F as f,d as h,l as ee}from"./app-c38d94e2.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";const se={class:"space-y-6"},ae={class:"flex flex-wrap items-center justify-between gap-4 p-1"},oe={class:"flex flex-wrap items-center gap-2"},le={key:0,class:"bg-slate-50 dark:bg-slate-800/50 rounded-2xl p-5 border border-slate-200 dark:border-slate-700"},ne={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4"},re={class:"grid grid-cols-2 sm:grid-cols-4 gap-3"},ie={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},de={class:"relative w-full max-w-md bg-white dark:bg-slate-800 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]"},ue={class:"px-6 py-4 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center bg-slate-50 dark:bg-slate-800"},ce={class:"font-bold text-lg text-slate-800 dark:text-white"},ve={class:"p-6 overflow-y-auto custom-scrollbar"},me={key:0},pe={key:1},be={class:"relative"},xe={key:2},ke={key:3},ge=["value"],ye={class:"modal-actions"},fe=["disabled"],he={key:4},we={class:"border border-slate-200 dark:border-slate-700 rounded-xl max-h-60 overflow-y-auto divide-y divide-slate-100 dark:divide-slate-700"},je=["value"],Ce={class:"text-sm"},Me={class:"font-medium text-slate-700 dark:text-slate-200"},$e={class:"text-xs text-slate-400"},_e={class:"modal-actions"},Ve=["disabled"],Be={key:5},Ue=["value"],Ee=["value"],Ne={class:"modal-actions"},ze=["disabled"],Fe={key:6,class:"space-y-6"},Le={key:0,class:"text-sm text-slate-400 italic"},Pe={class:"space-y-2"},De={class:"font-medium text-slate-700 dark:text-slate-200"},He=["onClick"],Te={key:0,class:"text-sm text-slate-400 italic"},We={class:"space-y-2"},Ie={class:"font-medium text-slate-700 dark:text-slate-200"},Oe=["onClick"],Se={key:0,class:"text-sm text-slate-400 italic"},Ae={class:"space-y-2"},Re={class:"font-medium text-slate-700 dark:text-slate-200"},qe=["onClick"],Ge={__name:"ProjectMenu",props:["project","user","employees"],emits:["refresh"],setup(u,{emit:T}){const n=u,w=T,r=k(null),_=k(""),V=k(""),B=k(""),j=k(null),C=k([]),p=k({old:null,new:null}),U=x(()=>{var l;return((l=n.project.company)==null?void 0:l.user_id)===n.user.id}),L=x(()=>{var l;return(l=n.project.managers)==null?void 0:l.some(t=>t.id===n.user.id)}),W=x(()=>{var l;return(l=n.project.executors)==null?void 0:l.some(t=>t.id===n.user.id)}),P=x(()=>n.project.initiator_id===n.user.id),D=x(()=>U.value||L.value||W.value),I=x(()=>U.value),O=x(()=>U.value||L.value||P.value),S=x(()=>U.value||P.value),b=l=>{r.value=l,l==="name"&&(_.value=n.project.name),l==="budget"&&(V.value=n.project.budget),l==="desc"&&(B.value=n.project.description),j.value=null,C.value=[]},d=()=>{r.value=null},A=async()=>{await g.patch(`/api/projects/${n.project.id}/name`,{name:_.value}),w("refresh"),d()},R=async()=>{await g.patch(`/api/projects/${n.project.id}/budget`,{budget:V.value}),w("refresh"),d()},q=async()=>{await g.patch(`/api/projects/${n.project.id}/description`,{description:B.value}),w("refresh"),d()},G=async()=>{confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.")&&(await g.delete(`/api/projects/${n.project.id}`),window.location.href="/")},H=async l=>{var M,$;const t=l==="executors"?{user_ids:C.value}:{user_id:j.value},c=l==="executors"?"executors":l;try{await g.post(`/api/projects/${n.project.id}/${c}`,t),w("refresh"),d()}catch(s){alert((($=(M=s.response)==null?void 0:M.data)==null?void 0:$.message)||"–û—à–∏–±–∫–∞")}},J=async()=>{try{await g.post(`/api/projects/${n.project.id}/replace-manager`,{old_manager_id:p.value.old,new_manager_id:p.value.new}),w("refresh"),d()}catch{alert("–û—à–∏–±–∫–∞")}},N=async(l,t)=>{if(l==="manager"&&n.project.managers.length<=1)return alert("–í –ø—Ä–æ–µ–∫—Ç–µ –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞—Ç—å—Å—è —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å");await g.delete(`/api/projects/${n.project.id}/members`,{data:{user_id:t,role:l}}),w("refresh")};return(l,t)=>(a(),o("div",se,[e("div",ae,[u.project.company?(a(),o("button",{key:0,onClick:t[0]||(t[0]=c=>K(Z).visit(`/companies/${u.project.company.id}`)),class:"flex items-center gap-2 text-sm font-medium transition-colors"},t[18]||(t[18]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),v(" –ù–∞–∑–∞–¥ –∫ –∫–æ–º–ø–∞–Ω–∏–∏ ",-1)]))):i("",!0),e("div",oe,[D.value?(a(),o("button",{key:0,onClick:t[1]||(t[1]=c=>b("name")),class:"btn-secondary"},t[19]||(t[19]=[e("svg",{class:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),v(" –ù–∞–∑–≤–∞–Ω–∏–µ ",-1)]))):i("",!0),I.value?(a(),o("button",{key:1,onClick:t[2]||(t[2]=c=>b("budget")),class:"btn-secondary"},t[20]||(t[20]=[e("svg",{class:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),v(" –ë—é–¥–∂–µ—Ç ",-1)]))):i("",!0),D.value?(a(),o("button",{key:2,onClick:t[3]||(t[3]=c=>b("desc")),class:"btn-secondary"},t[21]||(t[21]=[e("svg",{class:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),v(" –û–ø–∏—Å–∞–Ω–∏–µ ",-1)]))):i("",!0),t[23]||(t[23]=e("div",{class:"h-6 w-px bg-slate-200 dark:bg-slate-700 mx-1"},null,-1)),S.value?(a(),o("button",{key:3,onClick:G,class:"btn-danger"},t[22]||(t[22]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),v(" –£–¥–∞–ª–∏—Ç—å ",-1)]))):i("",!0)])]),O.value?(a(),o("div",le,[e("div",ne,[t[24]||(t[24]=e("h4",{class:"text-sm uppercase tracking-wider text-slate-500 font-bold flex items-center gap-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})]),v(" –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π ")],-1)),e("button",{onClick:t[4]||(t[4]=c=>b("manageList")),class:"text-xs font-semibold text-indigo-600 hover:text-indigo-700 hover:underline"}," –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ ")]),e("div",re,[e("button",{onClick:t[5]||(t[5]=c=>b("addManager")),class:"btn-team border-emerald-200 bg-emerald-50 text-emerald-700 hover:bg-emerald-100 dark:bg-emerald-900/20 dark:border-emerald-800 dark:text-emerald-400"},t[25]||(t[25]=[e("span",{class:"text-lg"},"üëë",-1),v(" –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å ",-1)])),e("button",{onClick:t[6]||(t[6]=c=>b("replaceManager")),class:"btn-team border-amber-200 bg-amber-50 text-amber-700 hover:bg-amber-100 dark:bg-amber-900/20 dark:border-amber-800 dark:text-amber-400"},t[26]||(t[26]=[e("span",{class:"text-lg"},"üîÑ",-1),v(" –°–º–µ–Ω–∏—Ç—å —Ä—É–∫. ",-1)])),e("button",{onClick:t[7]||(t[7]=c=>b("addExecutor")),class:"btn-team border-indigo-200 bg-indigo-50 text-indigo-700 hover:bg-indigo-100 dark:bg-indigo-900/20 dark:border-indigo-800 dark:text-indigo-400"},t[27]||(t[27]=[e("span",{class:"text-lg"},"üõ†",-1),v(" –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å ",-1)])),e("button",{onClick:t[8]||(t[8]=c=>b("addWatcher")),class:"btn-team border-purple-200 bg-purple-50 text-purple-700 hover:bg-purple-100 dark:bg-purple-900/20 dark:border-purple-800 dark:text-purple-400"},t[28]||(t[28]=[e("span",{class:"text-lg"},"üëÄ",-1),v(" –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å ",-1)]))])])):i("",!0),Q(Y,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:X(()=>{var c,M,$;return[r.value?(a(),o("div",ie,[e("div",{class:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity",onClick:d}),e("div",de,[e("div",ue,[e("h3",ce,m(r.value==="name"?"–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ":r.value==="budget"?"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–æ–º":r.value==="desc"?"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ":r.value==="addManager"?"–î–æ–±–∞–≤–∏—Ç—å —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è":r.value==="replaceManager"?"–°–º–µ–Ω–∞ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è":r.value==="addExecutor"?"–î–æ–±–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π":r.value==="addWatcher"?"–î–æ–±–∞–≤–∏—Ç—å –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è":"–£—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞"),1),e("button",{onClick:d,class:"text-slate-400 hover:text-slate-600 transition"},"‚úï")]),e("div",ve,[r.value==="name"?(a(),o("div",me,[y(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>_.value=s),type:"text",class:"input-primary",placeholder:"–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞",autofocus:""},null,512),[[z,_.value]]),e("div",{class:"modal-actions"},[e("button",{onClick:d,class:"btn-ghost"},"–û—Ç–º–µ–Ω–∞"),e("button",{onClick:A,class:"btn-primary"},"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å")])])):i("",!0),r.value==="budget"?(a(),o("div",pe,[e("div",be,[t[29]||(t[29]=e("span",{class:"absolute left-3 top-2.5 text-slate-500"},"‚ÇΩ",-1)),y(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>V.value=s),type:"number",class:"input-primary pl-8",placeholder:"0.00"},null,512),[[z,V.value]])]),e("div",{class:"modal-actions"},[e("button",{onClick:d,class:"btn-ghost"},"–û—Ç–º–µ–Ω–∞"),e("button",{onClick:R,class:"btn-primary"},"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å")])])):i("",!0),r.value==="desc"?(a(),o("div",xe,[y(e("textarea",{"onUpdate:modelValue":t[11]||(t[11]=s=>B.value=s),rows:"5",class:"input-primary",placeholder:"–û–ø–∏—à–∏—Ç–µ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞..."},null,512),[[z,B.value]]),e("div",{class:"modal-actions"},[e("button",{onClick:d,class:"btn-ghost"},"–û—Ç–º–µ–Ω–∞"),e("button",{onClick:q,class:"btn-primary"},"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å")])])):i("",!0),["addManager","addWatcher"].includes(r.value)?(a(),o("div",ke,[y(e("select",{"onUpdate:modelValue":t[12]||(t[12]=s=>j.value=s),class:"input-primary"},[t[30]||(t[30]=e("option",{value:null},"–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞...",-1)),(a(!0),o(f,null,h(u.employees,s=>(a(),o("option",{value:s.id,key:s.id},m(s.name)+" ("+m(s.email)+")",9,ge))),128))],512),[[F,j.value]]),e("div",ye,[e("button",{onClick:d,class:"btn-ghost"},"–û—Ç–º–µ–Ω–∞"),e("button",{onClick:t[13]||(t[13]=s=>H(r.value==="addManager"?"add-manager":"watchers")),class:"btn-primary",disabled:!j.value},"–î–æ–±–∞–≤–∏—Ç—å",8,fe)])])):i("",!0),r.value==="addExecutor"?(a(),o("div",he,[e("div",we,[(a(!0),o(f,null,h(u.employees,s=>(a(),o("label",{key:s.id,class:"flex items-center gap-3 p-3 hover:bg-slate-50 dark:hover:bg-slate-700/50 cursor-pointer transition"},[y(e("input",{type:"checkbox","onUpdate:modelValue":t[14]||(t[14]=E=>C.value=E),value:s.id,class:"w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500"},null,8,je),[[ee,C.value]]),e("div",Ce,[e("div",Me,m(s.name),1),e("div",$e,m(s.email),1)])]))),128))]),e("div",_e,[e("button",{onClick:d,class:"btn-ghost"},"–û—Ç–º–µ–Ω–∞"),e("button",{onClick:t[15]||(t[15]=s=>H("executors")),class:"btn-primary",disabled:!C.value.length},"–î–æ–±–∞–≤–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö",8,Ve)])])):i("",!0),r.value==="replaceManager"?(a(),o("div",Be,[t[33]||(t[33]=e("label",{class:"block text-xs font-bold text-slate-500 uppercase mb-1"},"–¢–µ–∫—É—â–∏–π —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å",-1)),y(e("select",{"onUpdate:modelValue":t[16]||(t[16]=s=>p.value.old=s),class:"input-primary mb-4"},[t[31]||(t[31]=e("option",{value:null},"–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–≥–æ –∑–∞–º–µ–Ω–∏—Ç—å",-1)),(a(!0),o(f,null,h(u.project.managers,s=>(a(),o("option",{value:s.id,key:s.id},m(s.name),9,Ue))),128))],512),[[F,p.value.old]]),t[34]||(t[34]=e("label",{class:"block text-xs font-bold text-slate-500 uppercase mb-1"},"–ù–æ–≤—ã–π —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å",-1)),y(e("select",{"onUpdate:modelValue":t[17]||(t[17]=s=>p.value.new=s),class:"input-primary"},[t[32]||(t[32]=e("option",{value:null},"–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–µ–º–Ω–∏–∫–∞",-1)),(a(!0),o(f,null,h(u.employees,s=>(a(),o("option",{value:s.id,key:s.id},m(s.name),9,Ee))),128))],512),[[F,p.value.new]]),e("div",Ne,[e("button",{onClick:d,class:"btn-ghost"},"–û—Ç–º–µ–Ω–∞"),e("button",{onClick:J,class:"btn-primary bg-amber-500 hover:bg-amber-600",disabled:!p.value.old||!p.value.new},"–ó–∞–º–µ–Ω–∏—Ç—å",8,ze)])])):i("",!0),r.value==="manageList"?(a(),o("div",Fe,[e("div",null,[t[35]||(t[35]=e("h4",{class:"text-xs font-bold text-emerald-600 uppercase mb-2"},"–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–∏",-1)),(c=u.project.managers)!=null&&c.length?i("",!0):(a(),o("div",Le,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö")),e("ul",Pe,[(a(!0),o(f,null,h(u.project.managers,s=>(a(),o("li",{key:s.id,class:"member-item"},[e("span",De,m(s.name),1),e("button",{onClick:E=>N("manager",s.id),class:"btn-remove"},"–ò—Å–∫–ª—é—á–∏—Ç—å",8,He)]))),128))])]),e("div",null,[t[36]||(t[36]=e("h4",{class:"text-xs font-bold text-indigo-600 uppercase mb-2"},"–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏",-1)),(M=u.project.executors)!=null&&M.length?i("",!0):(a(),o("div",Te,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö")),e("ul",We,[(a(!0),o(f,null,h(u.project.executors,s=>(a(),o("li",{key:s.id,class:"member-item"},[e("span",Ie,m(s.name),1),e("button",{onClick:E=>N("executor",s.id),class:"btn-remove"},"–ò—Å–∫–ª—é—á–∏—Ç—å",8,Oe)]))),128))])]),e("div",null,[t[37]||(t[37]=e("h4",{class:"text-xs font-bold text-purple-600 uppercase mb-2"},"–ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏",-1)),($=u.project.watchers)!=null&&$.length?i("",!0):(a(),o("div",Se,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö")),e("ul",Ae,[(a(!0),o(f,null,h(u.project.watchers,s=>(a(),o("li",{key:s.id,class:"member-item"},[e("span",Re,m(s.name),1),e("button",{onClick:E=>N("watcher",s.id),class:"btn-remove"},"–ò—Å–∫–ª—é—á–∏—Ç—å",8,qe)]))),128))])]),e("div",{class:"mt-6 pt-4 border-t border-slate-100 dark:border-slate-700 flex justify-end"},[e("button",{onClick:d,class:"btn-ghost"},"–ó–∞–∫—Ä—ã—Ç—å")])])):i("",!0)])])])):i("",!0)]}),_:1})]))}},Qe=te(Ge,[["__scopeId","data-v-77dda1f4"]]);export{Qe as default};
