import{r as p,q as V,o as a,c as $,w as i,i as k,b as e,f as l,x,t as o,n as C,F as m,a as h,g as c,h as R,ae as B,d as N,j as z,v as L}from"./app-b180998f.js";import{_ as M}from"./AuthenticatedLayout-8518e191.js";import{_ as F}from"./_plugin-vue_export-helper-c27b6911.js";import"./ApplicationLogo-138a66be.js";const I={class:"max-w-6xl mx-auto p-6 relative"},O={class:"grid md:grid-cols-2 lg:grid-cols-3 gap-4"},W=["onClick"],q={class:"flex justify-between items-center mb-2"},E={class:"font-semibold text-slate-800 dark:text-slate-100"},G={class:"text-slate-600 dark:text-slate-300 line-clamp-3"},H={key:0,class:"fixed right-0 top-0 h-full w-full sm:w-[1020px] bg-white dark:bg-slate-900 shadow-xl z-50 border-l border-slate-200 dark:border-slate-700 flex flex-col"},U={class:"p-4 border-b dark:border-slate-700 flex justify-between items-center"},A={class:"font-semibold text-lg text-slate-800 dark:text-slate-100"},J={key:0,class:"mt-3 space-y-3"},K=["src"],P={key:1,controls:"",class:"rounded-lg max-w-full border"},Q=["src"],X=["href"],Y={class:"p-4 flex-1 overflow-y-auto space-y-4"},Z={class:"bg-slate-50 dark:bg-slate-800 rounded-lg p-3"},ee={style:{"overflow-wrap":"break-word",width:"58%"},class:"text-slate-700 dark:text-slate-200 whitespace-pre-line"},te={key:0,class:"space-y-3 px-2"},se={key:0,class:"max-w-[75%] mt-5 bg-slate-100 dark:bg-slate-800 text-slate-800 dark:text-slate-100 rounded-2xl px-4 py-2 shadow-sm"},ae={style:{"overflow-wrap":"break-word"},class:"text-sm whitespace-pre-line"},le={class:"text-xs text-slate-400 mt-1 text-right"},oe={key:1,class:"max-w-[75%] mt-5 bg-blue-600 text-white rounded-2xl px-4 py-2 shadow-sm"},re={style:{"overflow-wrap":"break-word"},class:"whitespace-pre-line text-sm mt-1"},de={class:"text-xs text-blue-100 mt-1 text-right"},ne={key:1,class:"p-4 border-t dark:border-slate-700"},ie={__name:"supporthistory",setup(ce){const g=p([]),t=p(null),u=p(!1),S=p(!0),T=async()=>{const{data:n}=await k.get("/api/support/history");g.value=n.data,S.value=!1},j=n=>{t.value=n,u.value=!0},v=()=>{u.value=!1,t.value=null},D=async()=>{var n;if(!((n=t.value.newReply)!=null&&n.trim()))return alert("–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ");try{await k.post("/api/support/reply",{support_message_id:t.value.id,reply:t.value.newReply}),t.value.replies.push({reply:t.value.newReply,user:{name:"–í—ã"},created_at:new Date().toISOString()}),t.value.newReply=""}catch(d){console.error(d),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –æ—Ç–≤–µ—Ç–∞")}};return V(T),(n,d)=>(a(),$(M,null,{header:i(()=>d[1]||(d[1]=[e("h2",{class:"text-2xl font-semibold text-slate-800 dark:text-slate-100 flex items-center gap-2"}," üí¨ –ò—Å—Ç–æ—Ä–∏—è –æ–±—Ä–∞—â–µ–Ω–∏–π ",-1)])),default:i(()=>[e("div",I,[e("div",O,[(a(!0),l(m,null,x(g.value,r=>(a(),l("div",{key:r.id,onClick:s=>j(r),class:"cursor-pointer p-5 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl shadow-sm hover:shadow-md transition"},[e("div",q,[e("h3",E," –û–±—Ä–∞—â–µ–Ω–∏–µ ‚Ññ"+o(r.id),1),e("span",{class:C(["px-2 py-1 text-xs rounded-full",r.status==="closed"?"bg-gray-200 text-gray-700":"bg-blue-100 text-blue-700"])},o(r.status==="closed"?"–ó–∞–≤–µ—Ä—à–µ–Ω–æ":"–û—Ç–∫—Ä—ã—Ç–æ"),3)]),e("p",G,o(r.message),1)],8,W))),128))]),h(R,{name:"fade"},{default:i(()=>[u.value?(a(),l("div",{key:0,class:"fixed inset-0 bg-black/40 z-40",onClick:v})):c("",!0)]),_:1}),h(R,{name:"slide"},{default:i(()=>{var r;return[u.value&&t.value?(a(),l("div",H,[e("div",U,[e("h3",A," –û–±—Ä–∞—â–µ–Ω–∏–µ ‚Ññ"+o(t.value.id),1),e("button",{onClick:v,class:"text-slate-500 hover:text-slate-800"},"‚úï")]),(r=t.value.attachments)!=null&&r.length?(a(),l("div",J,[(a(!0),l(m,null,x(t.value.attachments,s=>(a(),l("div",{key:s.id,class:"flex flex-col gap-2"},[s.mime_type.startsWith("image")?(a(),l("img",{key:0,src:`/storage/${s.path}`,class:"rounded-lg max-w-96 border"},null,8,K)):s.mime_type.startsWith("video")?(a(),l("video",P,[e("source",{src:`/storage/${s.path}`},null,8,Q)])):(a(),l("a",{key:2,href:`/storage/${s.path}`,target:"_blank",class:"text-blue-600 underline"}," üìé "+o(s.original_name),9,X))]))),128))])):c("",!0),e("div",Y,[e("div",Z,[e("p",ee,o(t.value.message),1)]),t.value.replies.length?(a(),l("div",te,[h(B,{name:"fade",tag:"div"},{default:i(()=>[(a(!0),l(m,null,x(t.value.replies,s=>{var b,y,w,f;return a(),l("div",{key:s.id,class:C(["flex",(y=(b=s.user)==null?void 0:b.roles)!=null&&y.some(_=>_.name==="support")?"justify-end":"justify-start"])},[(f=(w=s.user)==null?void 0:w.roles)!=null&&f.some(_=>_.name==="support")?(a(),l("div",oe,[d[2]||(d[2]=e("p",{class:"flex items-center gap-1 text-sm"},[N(" üõ† "),e("strong",null,"–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞:")],-1)),e("p",re,o(s.reply),1),e("p",de,o(new Date(s.created_at).toLocaleTimeString()),1)])):(a(),l("div",se,[e("p",ae,o(s.reply),1),e("p",le,o(new Date(s.created_at).toLocaleTimeString()),1)]))],2)}),128))]),_:1})])):c("",!0)]),t.value.status!=="closed"?(a(),l("div",ne,[z(e("textarea",{"onUpdate:modelValue":d[0]||(d[0]=s=>t.value.newReply=s),placeholder:"–ù–∞–ø–∏—à–∏—Ç–µ –æ—Ç–≤–µ—Ç...",rows:"2",class:"w-full border border-slate-300 dark:border-slate-600 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 dark:bg-slate-800 dark:text-slate-100"},null,512),[[L,t.value.newReply]]),e("button",{onClick:D,class:"mt-2 w-full bg-blue-600 text-white rounded-lg py-2 text-sm hover:bg-blue-700 transition"}," –û—Ç–ø—Ä–∞–≤–∏—Ç—å ")])):c("",!0)])):c("",!0)]}),_:1})])]),_:1}))}},me=F(ie,[["__scopeId","data-v-56a9c941"]]);export{me as default};
