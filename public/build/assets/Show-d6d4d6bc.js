import{r as c,m as z,o,f as r,b as t,g as p,F as w,s as C,t as u,j as $,v as N,i as k,n as ge,x as Y,Q as Oe,q as Qe,a as pe,u as $e,w as je,Z as Ze,d as Ge,k as me}from"./app-7a51cb98.js";import{_ as Je}from"./AuthenticatedLayout-a3c2bfc8.js";import{_ as Ke}from"./_plugin-vue_export-helper-c27b6911.js";import"./ApplicationLogo-21747294.js";const Xe={class:"mt-4 bg-white dark:bg-slate-800 p-4 rounded-xl shadow relative"},Ye={key:0,class:"text-gray-500 text-sm"},et={key:1,class:"space-y-4"},tt={class:"flex justify-between"},st={class:"text-xs text-gray-500"},at={key:0},lt={class:"mt-2 flex gap-2"},ot=["onClick"],rt={key:1},nt=["innerHTML"],dt={key:2,class:"mt-4 relative"},it={key:0,class:"absolute left-0 mt-1 bg-white dark:bg-slate-700 border rounded-lg shadow p-2 max-h-40 overflow-auto z-50 w-64"},ut=["onClick"],ct={__name:"SubtaskComments",props:{subtaskId:Number,comments:Array,canWrite:Boolean,members:{type:Array,default:()=>[]}},emits:["updated"],setup(U,{emit:W}){const b=U,s=W,i=c(""),x=c(null),E=c(""),A=c(!1),D=c(""),R=c(0),M=g=>{const m=g.target.value,v=g.target.selectionStart;R.value=v;const P=m.slice(0,v).match(/@([\p{L}\d_]*)$/u);P?(D.value=P[1].toLowerCase(),A.value=!0):A.value=!1},y=z(()=>D.value?b.members.filter(g=>g.name.toLowerCase().includes(D.value)):b.members),T=g=>{const m=R.value,v=i.value,P=`@${g.name.replace(/\s+/g,"_")}`,Q=v.slice(0,m).replace(/@([\p{L}\d_]*)$/u,P+" "),J=v.slice(m);i.value=Q+J,A.value=!1,D.value="",setTimeout(()=>{const Z=document.querySelector("#subtask-comment-input");Z&&(Z.selectionStart=Z.selectionEnd=Q.length,Z.focus())},0)},q=g=>g.replace(/@([\p{L}\d_]+)/gu,(m,v)=>`<span class="mention">@${v.replace(/_/g," ")}</span>`),H=async()=>{if(!i.value.trim())return;const m=(i.value.match(/@([\p{L}\d_]+)/gu)||[]).map(_=>{const Q=_.substring(1).replace(/_/g," ");return b.members.find(J=>J.name===Q)}).filter(Boolean).map(_=>_.id),{data:v}=await k.post(`/api/subtasks/${b.subtaskId}/comments`,{comment:i.value,mentions:m});s("updated",{type:"add",comment:v}),i.value=""},O=async g=>{if(!E.value.trim())return;const{data:m}=await k.patch(`/api/subtask-comments/${g}`,{comment:E.value});s("updated",{type:"update",comment:m}),x.value=null,E.value=""};return(g,m)=>(o(),r("div",Xe,[m[3]||(m[3]=t("h3",{class:"text-lg font-semibold mb-3"},"üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏",-1)),!U.comments||U.comments.length===0?(o(),r("p",Ye," –ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. ")):p("",!0),U.comments&&U.comments.length?(o(),r("div",et,[(o(!0),r(w,null,C(U.comments,v=>(o(),r("div",{key:v.id,class:"p-3 border dark:border-slate-700 rounded-lg"},[t("div",tt,[t("strong",null,u(v.user.name),1),t("span",st,u(new Date(v.created_at).toLocaleString("ru-RU")),1)]),x.value===v.id?(o(),r("div",at,[$(t("textarea",{"onUpdate:modelValue":m[0]||(m[0]=_=>E.value=_),class:"w-full border rounded-lg px-2 py-1 mt-2 dark:bg-slate-700 dark:text-white",rows:"2"},null,512),[[N,E.value]]),t("div",lt,[t("button",{onClick:_=>O(v.id),class:"px-3 py-1 bg-green-600 text-white rounded-lg text-sm"}," –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ",8,ot),t("button",{onClick:m[1]||(m[1]=_=>x.value=null),class:"px-3 py-1 bg-gray-400 text-white rounded-lg text-sm"}," –û—Ç–º–µ–Ω–∞ ")])])):(o(),r("div",rt,[t("p",{class:"mt-2 whitespace-pre-line",innerHTML:q(v.comment)},null,8,nt)]))]))),128))])):p("",!0),U.canWrite?(o(),r("div",dt,[$(t("textarea",{id:"subtask-comment-input","onUpdate:modelValue":m[2]||(m[2]=v=>i.value=v),onInput:M,onClick:M,placeholder:"–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏ –æ—Ç–º–µ—Ç–∏—Ç—å —á–µ–ª–æ–≤–µ–∫–∞ —á–µ—Ä–µ–∑ @...",class:"w-full border rounded-lg px-3 py-2 dark:bg-slate-700 dark:text-white",rows:"3"},null,544),[[N,i.value]]),A.value&&y.value.length?(o(),r("div",it,[(o(!0),r(w,null,C(y.value,v=>(o(),r("div",{key:v.id,class:"p-1 cursor-pointer hover:bg-gray-200 dark:hover:bg-slate-600",onClick:_=>T(v)}," @"+u(v.name),9,ut))),128))])):p("",!0),t("button",{onClick:H,class:"mt-3 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700"}," ‚û§ –î–æ–±–∞–≤–∏—Ç—å ")])):p("",!0)]))}},pt=Ke(ct,[["__scopeId","data-v-a2794137"]]),mt={class:"mt-6 p-4 bg-white dark:bg-slate-800 rounded-xl shadow"},vt={key:0,class:"text-gray-500 text-sm"},gt={key:1,class:"space-y-3"},bt={class:"flex items-center gap-3"},xt=["checked","onChange"],yt={key:0,class:"text-xs text-gray-500"},kt={key:2,class:"mt-4"},ft=["value"],ht={__name:"SubtaskChecklist",props:{subtaskId:Number,checklist:{type:Array,default:()=>[]},executors:{type:Array,default:()=>[]},responsibles:{type:Array,default:()=>[]},canWrite:Boolean},emits:["updated"],setup(U,{emit:W}){const b=U,s=z(()=>b.checklist??[]),i=c(""),x=c(null),E=W,A=async()=>{if(!i.value.trim())return;const{data:R}=await k.post(`/api/subtasks/${b.subtaskId}/checklist`,{title:i.value,responsible_id:x.value});E("updated",{type:"add",item:R}),i.value="",x.value=null},D=async R=>{const{data:M}=await k.patch(`/api/subtask-checklist/${R.id}/toggle`);E("updated",{type:"toggle",id:R.id,completed:M.completed})};return(R,M)=>(o(),r("div",mt,[M[3]||(M[3]=t("h3",{class:"text-lg font-semibold mb-3"},"üìù –ß–µ–∫-–ª–∏—Å—Ç",-1)),s.value.length===0?(o(),r("p",vt," –ü—É—Å—Ç–æ. ")):(o(),r("div",gt,[(o(!0),r(w,null,C(s.value,y=>(o(),r("div",{key:y.id,class:"p-3 border rounded-lg dark:border-slate-700 flex justify-between items-center"},[t("div",bt,[t("input",{type:"checkbox",checked:y.completed,onChange:T=>D(y),class:"w-5 h-5"},null,40,xt),t("div",null,[t("p",{class:ge(y.completed?"line-through text-gray-400":"")},u(y.title),3),y.responsible?(o(),r("p",yt," üë§ "+u(y.responsible.name),1)):p("",!0)])])]))),128))])),U.canWrite?(o(),r("div",kt,[$(t("input",{"onUpdate:modelValue":M[0]||(M[0]=y=>i.value=y),class:"w-full border rounded-lg px-3 py-2 dark:bg-slate-700 dark:text-white",placeholder:"–ù–æ–≤—ã–π –ø—É–Ω–∫—Ç..."},null,512),[[N,i.value]]),$(t("select",{"onUpdate:modelValue":M[1]||(M[1]=y=>x.value=y),class:"w-full border rounded-lg px-3 py-2 mt-2 dark:bg-slate-700 dark:text-white"},[M[2]||(M[2]=t("option",{value:null},"–ë–µ–∑ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ",-1)),(o(!0),r(w,null,C([...U.executors,...U.responsibles],y=>(o(),r("option",{key:y.id,value:y.id},u(y.name),9,ft))),128))],512),[[Y,x.value]]),t("button",{onClick:A,class:"mt-2 bg-indigo-600 text-white px-4 py-2 rounded-lg"}," ‚ûï –î–æ–±–∞–≤–∏—Ç—å ")])):p("",!0)]))}},wt={class:"flex items-center justify-between gap-3"},_t={class:"text-xl font-bold text-gray-800 dark:text-gray-200"},Ct={key:0,class:"flex items-center gap-2"},$t={class:"inline-flex items-center gap-2 text-sm px-3 py-1 rounded-full ring-1 ring-gray-200 dark:ring-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"},jt={key:4,class:"px-3 py-1.5 rounded-md bg-emerald-100 text-emerald-700 text-sm dark:bg-emerald-900/30 dark:text-emerald-300"},Mt={class:"max-w-4xl mx-auto py-8 px-4"},Et={key:0,class:"grid gap-6"},St={class:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6"},Ut={class:"grid sm:grid-cols-2 gap-4 text-sm"},It={class:"font-medium text-gray-900 dark:text-white"},Vt={class:"font-medium text-gray-900 dark:text-white"},Rt={class:"font-medium text-gray-900 dark:text-white"},Lt={key:0,class:"flex flex-wrap gap-2 mt-4"},zt={key:0,class:"mt-4 p-3 bg-gray-100 dark:bg-gray-700 rounded-lg bg-white dark:bg-gray-800 rounded-2xl shadow p-6"},At={style:{"word-break":"break-all"},class:"whitespace-pre-line"},Dt={class:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6"},Ft={class:"flex items-center justify-between mb-3"},Nt={class:"text-sm text-gray-500 dark:text-gray-400"},Tt={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},Pt={class:"font-medium text-gray-900 dark:text-white"},Bt={class:"font-medium text-gray-900 dark:text-white"},Wt={class:"flex mt-2 space-x-1 select-none"},qt=["title","onClick"],Ht={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-2"},Ot={class:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6 mt-6"},Qt={class:"flex items-center justify-between mb-3"},Zt={key:0},Gt={key:0,class:"space-y-2"},Jt=["href"],Kt=["onClick"],Xt={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},Yt={key:1,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},es={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl"},ts=["value"],ss=["value"],as={key:0,class:"text-rose-600 text-sm mt-2"},ls={class:"flex justify-end gap-2 mt-4"},os={key:2,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},rs={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl"},ns={class:"space-y-4"},ds={class:"max-h-40 overflow-y-auto border rounded-lg p-2 dark:border-gray-600"},is=["value"],us={class:"max-h-40 overflow-y-auto border rounded-lg p-2 dark:border-gray-600"},cs=["value"],ps={key:0,class:"text-rose-600 text-sm mt-3"},ms={class:"flex justify-end gap-2 mt-5"},vs=["disabled"],gs={key:0},bs={key:1},xs={key:3,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},ys={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl"},ks=["value"],fs=["value"],hs={key:0,class:"text-rose-600 text-sm mt-2"},ws={class:"flex justify-end gap-2 mt-4"},_s={key:4,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},Cs={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl"},$s={class:"max-h-60 overflow-y-auto border rounded-lg p-2 dark:border-gray-600"},js=["value"],Ms={class:"flex justify-end gap-2 mt-4"},Es={key:5,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},Ss={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl"},Us={class:"max-h-60 overflow-y-auto border rounded-lg p-2 dark:border-gray-600"},Is=["value"],Vs={class:"flex justify-end gap-2 mt-4"},Rs={key:6,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},Ls={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-3xl shadow-xl"},zs={key:0,class:"text-sm text-rose-600 mb-3"},As={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},Ds={class:"space-y-2"},Fs=["onClick"],Ns={key:0,class:"text-sm text-gray-500"},Ts={class:"space-y-2"},Ps=["onClick"],Bs={key:0,class:"text-sm text-gray-500"},Ws={class:"flex justify-end mt-6"},qs={class:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6 mt-6"},Hs={class:"flex items-center justify-between mb-3"},Os={key:0,class:"space-y-2"},Qs={class:"font-medium"},Zs={class:"text-xs text-gray-500 ml-2"},Gs=["href"],Js={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},Ks={"data-v-585ee726":"",class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},Xs={key:7,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},Ys={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl"},ea={class:"space-y-4"},ta={key:0,class:"text-rose-600 text-sm mt-3"},sa={class:"flex justify-end gap-2 mt-5"},aa=["disabled"],la={key:0},oa={key:1},ra={key:8,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},na={class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-xl w-full max-w-lg"},da={class:"mt-4 flex justify-end gap-2"},ia={key:1,class:"text-gray-600 dark:text-gray-300"},ga={__name:"Show",setup(U){var ke;const{props:W}=Oe(),b=W.id,s=c(null),i=(ke=W.auth)==null?void 0:ke.user,x=async()=>{const{data:l}=await k.get(`/api/subtasks/${b}`);s.value=l},E=z(()=>{var S,F;if(!s.value||!i)return!1;const l=((S=s.value.task)==null?void 0:S.project)||{},e=(s.value.executors||[]).some(h=>h.id===i.id),n=(s.value.responsibles||[]).some(h=>h.id===i.id),d=(l.executors||[]).some(h=>h.id===i.id),f=(l.managers||[]).some(h=>h.id===i.id),j=((F=l.company)==null?void 0:F.user_id)===i.id,V=s.value.creator_id===i.id;return e||n||d||f||j||V}),A=z(()=>s.value?E.value&&s.value.progress===100&&!s.value.completed:!1),D=async l=>{if(!E.value)return;const{data:e}=await k.patch(`/api/subtasks/${b}/progress`,{progress:l});s.value.progress=e.progress},R=async()=>{if(!A.value||!confirm("–ó–∞–≤–µ—Ä—à–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É?"))return;const{data:l}=await k.patch(`/api/subtasks/${b}/complete`);s.value.completed=l.completed,s.value.completed_at=l.completed_at},M=async l=>{var e,n;if(confirm("–£–¥–∞–ª–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É?"))try{await k.delete(`/api/subtasks/${l}`,{withCredentials:!0}),alert("–ü–æ–¥–∑–∞–¥–∞—á–∞ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞"),window.history.back()}catch(d){alert(((n=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:n.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–¥–∑–∞–¥–∞—á–∏")}},y=l=>{var n,d,f,j,V;const e=i==null?void 0:i.id;return e?e===l.creator_id||e===((f=(d=(n=l.task)==null?void 0:n.project)==null?void 0:d.company)==null?void 0:f.user_id)||(((V=(j=l.task)==null?void 0:j.project)==null?void 0:V.managers)||[]).some(S=>S.id===e):!1},T=c(!1),q=c(!1),H=c(!1),O=c(!1),g=c([]);c(null);const m=c([]),v=z(()=>{var l,e,n,d,f,j,V;return!s.value||!i?!1:i.id===((n=(e=(l=s.value.task)==null?void 0:l.project)==null?void 0:e.company)==null?void 0:n.user_id)||(((f=(d=s.value.task)==null?void 0:d.project)==null?void 0:f.managers)||[]).some(S=>S.id===i.id)||(((V=(j=s.value.task)==null?void 0:j.project)==null?void 0:V.executors)||[]).some(S=>S.id===i.id)}),_=async()=>{const{data:l}=await k.get(`/api/projects/${s.value.task.project.id}/employees`);g.value=l},P=async()=>{await _(),T.value=!0},Q=async()=>{await _(),q.value=!0},J=async()=>{await _(),H.value=!0},Z=async()=>{await _(),O.value=!0},Me=async()=>{var l,e;if(!m.value.length)return alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.");try{await k.post(`/api/subtasks/${b}/executors/add`,{user_ids:m.value}),await x(),H.value=!1,m.value=[]}catch(n){alert(((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π")}},Ee=async()=>{var l,e;if(!m.value.length)return alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.");try{await k.post(`/api/subtasks/${b}/responsibles/add`,{user_ids:m.value}),await x(),O.value=!1,m.value=[]}catch(n){alert(((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö")}},ee=c(null),te=c(null),se=c(null),ae=c(null),K=c(""),X=c(""),Se=z(()=>{if(!g.value.length||!s.value)return[];const l=(s.value.executors||[]).map(e=>e.id);return g.value.filter(e=>!l.includes(e.id))}),Ue=z(()=>{if(!g.value.length||!s.value)return[];const l=(s.value.responsibles||[]).map(e=>e.id);return g.value.filter(e=>!l.includes(e.id))}),Ie=async()=>{var l,e;if(K.value="",!ee.value||!te.value){K.value="–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–≥–æ –∏ –Ω–∞ –∫–æ–≥–æ –∑–∞–º–µ–Ω–∏—Ç—å.";return}try{await k.patch(`/api/subtasks/${b}/executor/change`,{replace_user_id:ee.value,user_id:te.value}),T.value=!1,await x()}catch(n){K.value=((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–º–µ–Ω–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è"}},Ve=async()=>{var l,e;if(X.value="",!se.value||!ae.value){X.value="–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–≥–æ –∏ –Ω–∞ –∫–æ–≥–æ –∑–∞–º–µ–Ω–∏—Ç—å.";return}try{await k.patch(`/api/subtasks/${b}/responsible/change`,{replace_user_id:se.value,user_id:ae.value}),q.value=!1,await x()}catch(n){X.value=((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–º–µ–Ω–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ"}},ve=c(!1),G=c(""),Re=async l=>{var e,n;G.value="";try{await k.delete(`/api/subtasks/${b}/executors`,{data:{user_id:l}}),await x()}catch(d){G.value=((n=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:n.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è"}},Le=async l=>{var e,n;G.value="";try{await k.delete(`/api/subtasks/${b}/responsibles`,{data:{user_id:l}}),await x()}catch(d){G.value=((n=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:n.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ"}},le=c(!1),oe=c(!1),re=c(""),B=c({title:"",due_date:""}),ze=()=>{s.value&&(B.value.title=s.value.title,B.value.due_date=s.value.due_date,le.value=!0)},Ae=async()=>{var l,e;re.value="",oe.value=!0;try{await k.patch(`/api/subtasks/${b}/update`,B.value),await x(),le.value=!1}catch(n){re.value=((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ–¥–∑–∞–¥–∞—á–∏"}finally{oe.value=!1}},be=z(()=>{var e,n;if(!s.value||!i)return!1;const l=(e=s.value.task)==null?void 0:e.project;return i.id===s.value.creator_id||i.id===((n=l==null?void 0:l.company)==null?void 0:n.user_id)||((l==null?void 0:l.managers)||[]).some(d=>d.id===i.id)||((l==null?void 0:l.executors)||[]).some(d=>d.id===i.id)}),xe=z(()=>{var e,n;if(!s.value||!i)return!1;const l=((e=s.value.task)==null?void 0:e.project)||{};return i.id===s.value.creator_id||(s.value.executors||[]).some(d=>d.id===i.id)||(s.value.responsibles||[]).some(d=>d.id===i.id)||(l.executors||[]).some(d=>d.id===i.id)||(l.managers||[]).some(d=>d.id===i.id)||((n=l.company)==null?void 0:n.user_id)===i.id}),De=c(null),Fe=async l=>{var d,f;const e=l.target.files[0];if(!e)return;const n=new FormData;n.append("file",e);try{await k.post(`/api/subtasks/${b}/files`,n,{headers:{"Content-Type":"multipart/form-data"}}),await x()}catch(j){alert(((f=(d=j==null?void 0:j.response)==null?void 0:d.data)==null?void 0:f.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞")}},Ne=async l=>{var e,n;if(confirm("–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª?"))try{await k.delete(`/api/subtask-files/${l}`),await x()}catch(d){alert(((n=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:n.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞")}},ne=c(!1),de=c(!1),ie=c(""),L=c({title:"",due_date:"",executor_ids:[],responsible_ids:[]}),Te=async()=>{await _(),ne.value=!0},Pe=async()=>{var l,e;if(s.value){ie.value="",de.value=!0;try{await k.post(`/api/subtasks/${b}/children`,L.value),await x(),ne.value=!1,L.value={title:"",due_date:"",executor_ids:[],responsible_ids:[]}}catch(n){ie.value=((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–¥–∑–∞–¥–∞—á–∏"}finally{de.value=!1}}},Be=({type:l,comment:e,id:n})=>{if(s.value.comments||(s.value.comments=[]),l==="add"&&s.value.comments.push(e),l==="update"){const d=s.value.comments.findIndex(f=>f.id===e.id);d!==-1&&(s.value.comments[d]=e)}l==="delete"&&(s.value.comments=s.value.comments.filter(d=>d.id!==n))},ye=z(()=>{var S,F;if(!s.value||!i)return!1;const l=((S=s.value.task)==null?void 0:S.project)||{},e=s.value.creator_id===i.id,n=(l.managers||[]).some(h=>h.id===i.id),d=(l.executors||[]).some(h=>h.id===i.id),f=((F=l.company)==null?void 0:F.user_id)===i.id,j=(s.value.executors||[]).some(h=>h.id===i.id),V=(s.value.responsibles||[]).some(h=>h.id===i.id);return e||n||d||f||j||V}),We=l=>{if(s.value.checklist||(s.value.checklist=[]),l.type==="add"&&s.value.checklist.push(l.item),l.type==="toggle"){const e=s.value.checklist.find(n=>n.id===l.id);e&&(e.completed=l.completed)}l.type==="delete"&&(s.value.checklist=s.value.checklist.filter(e=>e.id!==l.id))},ue=c(!1),ce=c(""),qe=()=>{ce.value=s.value.description||"",ue.value=!0},He=async()=>{var l,e;try{const{data:n}=await k.patch(`/api/subtasks/${b}/description`,{description:ce.value});s.value.description=n.description,ue.value=!1}catch(n){alert(((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.message)||"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è")}};return Qe(x),(l,e)=>(o(),r(w,null,[pe($e(Ze),{title:"–ü–æ–¥–∑–∞–¥–∞—á–∞"}),pe(Je,null,{header:je(()=>{var n,d;return[t("div",wt,[t("h2",_t," –ü–æ–¥–∑–∞–¥–∞—á–∞: "+u(((n=s.value)==null?void 0:n.title)??"–ó–∞–≥—Ä—É–∑–∫–∞..."),1),s.value?(o(),r("div",Ct,[t("span",$t,[t("span",{class:ge(["w-2 h-2 rounded-full",{"bg-red-500":(s.value.progress??0)<30,"bg-amber-500":(s.value.progress??0)>=30&&(s.value.progress??0)<70,"bg-green-500":(s.value.progress??0)>=70}])},null,2),Ge(" "+u(s.value.progress??0)+"% ",1)]),A.value?(o(),r("button",{key:0,onClick:R,class:"px-3 py-1.5 rounded-md bg-emerald-600 text-white text-sm hover:bg-emerald-700"}," –ó–∞–≤–µ—Ä—à–∏—Ç—å ")):p("",!0),be.value?(o(),r("button",{key:1,onClick:ze,class:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-md"}," ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É ")):p("",!0),$e(i).id===s.value.creator_id?(o(),r("button",{key:2,onClick:qe,class:"px-3 py-1 bg-indigo-600 text-white rounded-lg mt-3"}," ‚úè –û–ø–∏—Å–∞–Ω–∏–µ ")):p("",!0),y(s.value)?(o(),r("button",{key:3,onClick:e[0]||(e[0]=f=>M(s.value.id)),class:"px-3 py-1 bg-rose-600 hover:bg-rose-700 text-white text-sm rounded-md"}," üóë –£–¥–∞–ª–∏—Ç—å ")):s.value.completed?(o(),r("span",jt," –ó–∞–≤–µ—Ä—à–µ–Ω–∞ ‚Ä¢ "+u(((d=s.value.completed_at)==null?void 0:d.slice(0,16))??""),1)):p("",!0)])):p("",!0)])]}),default:je(()=>{var n,d,f,j,V,S,F,h,fe,he,we,_e,Ce;return[t("div",Mt,[s.value?(o(),r("div",Et,[t("div",St,[t("div",Ut,[t("div",null,[e[24]||(e[24]=t("p",{class:"text-gray-500 dark:text-gray-400"},"–ê–≤—Ç–æ—Ä",-1)),t("p",It,u((n=s.value.creator)==null?void 0:n.name),1),e[25]||(e[25]=t("p",{class:"text-gray-500 dark:text-gray-400 mt-4"},"–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å",-1)),t("p",Vt,u((d=s.value.executors)!=null&&d.length?s.value.executors.map(a=>a.name).join(", "):"‚Äî"),1),e[26]||(e[26]=t("p",{class:"text-gray-500 dark:text-gray-400 mt-4"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π",-1)),t("p",Rt,u((f=s.value.responsibles)!=null&&f.length?s.value.responsibles.map(a=>a.name).join(", "):"‚Äî"),1)]),v.value?(o(),r("div",Lt,[t("button",{onClick:P,class:"px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded-md"}," ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è "),t("button",{onClick:Q,class:"px-3 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded-md"}," ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ "),t("button",{onClick:J,class:"px-3 py-1 bg-emerald-500 hover:bg-emerald-600 text-white rounded-md"}," ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è "),t("button",{onClick:Z,class:"px-3 py-1 bg-amber-500 hover:bg-amber-600 text-white rounded-md"}," ‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ "),t("button",{onClick:e[1]||(e[1]=a=>ve.value=!0),class:"px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg"}," üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ ")])):p("",!0)])]),s.value.description?(o(),r("div",zt,[e[27]||(e[27]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-white"},"–û–ø–∏—Å–∞–Ω–∏–µ",-1)),t("p",At,u(s.value.description),1)])):p("",!0),t("div",Dt,[t("div",Ft,[e[28]||(e[28]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-white"},"–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–¥–∑–∞–¥–∞—á–∏",-1)),t("span",Nt,"–í—ã–ø–æ–ª–Ω–µ–Ω–æ "+u(s.value.progress??0)+"%",1)]),t("div",Tt,[t("div",null,[e[29]||(e[29]=t("p",{class:"text-gray-500 dark:text-gray-400"},"–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞",-1)),t("p",Pt,u(s.value.start_date),1)]),t("div",null,[e[30]||(e[30]=t("p",{class:"text-gray-500 dark:text-gray-400"},"–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è",-1)),t("p",Bt,u(s.value.due_date),1)])]),t("div",Wt,[(o(),r(w,null,C(10,a=>{var I;return t("div",{key:a,title:a*10+"%",onClick:ua=>E.value?D(a*10):null,class:ge(["h-4 sm:h-5 flex-1 rounded transition",{"cursor-pointer hover:opacity-80":E.value,"bg-green-600":(s.value.progress??0)>=a*10,"bg-gray-200 dark:bg-gray-700":(s.value.progress??0)<a*10,"pointer-events-none opacity-60":(I=s.value)==null?void 0:I.completed}])},null,10,qt)}),64))]),E.value?p("",!0):(o(),r("p",Ht," –ò–∑–º–µ–Ω—è—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –∏ –∞–≤—Ç–æ—Ä –ø–æ–¥–∑–∞–¥–∞—á–∏. "))]),t("div",Ot,[t("div",Qt,[e[31]||(e[31]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-white"},"üìé –§–∞–π–ª—ã –ø–æ–¥–∑–∞–¥–∞—á–∏",-1)),xe.value?(o(),r("div",Zt,[t("input",{type:"file",onChange:Fe,class:"hidden",ref_key:"fileInput",ref:De},null,544),t("button",{onClick:e[2]||(e[2]=a=>l.$refs.fileInput.click()),class:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm"}," ‚¨ÜÔ∏è –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª ")])):p("",!0)]),(j=s.value.files)!=null&&j.length?(o(),r("ul",Gt,[(o(!0),r(w,null,C(s.value.files,a=>(o(),r("li",{key:a.id,class:"flex justify-between items-center bg-gray-50 dark:bg-gray-700 p-2 rounded-lg"},[t("a",{href:`/api/subtask-files/${a.id}/download`,class:"text-blue-600 dark:text-blue-400 hover:underline"},u(a.filename),9,Jt),xe.value?(o(),r("button",{key:0,onClick:I=>Ne(a.id),class:"text-rose-500 hover:text-rose-700 text-sm"}," ‚ùå ",8,Kt)):p("",!0)]))),128))])):(o(),r("p",Xt,"–ù–µ—Ç –ø—Ä–∏–∫—Ä–µ–ø–ª—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤"))]),T.value?(o(),r("div",Yt,[t("div",es,[e[34]||(e[34]=t("h3",{class:"text-lg font-semibold mb-3 text-gray-900 dark:text-white"}," ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è ",-1)),e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –ö–æ–≥–æ –∑–∞–º–µ–Ω–∏—Ç—å: ",-1)),$(t("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>ee.value=a),class:"w-full border rounded-lg p-2 mb-4 dark:bg-gray-700 dark:text-white"},[e[32]||(e[32]=t("option",{value:""},"–í—ã–±–µ—Ä–∏—Ç–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è",-1)),(o(!0),r(w,null,C(((V=s.value)==null?void 0:V.executors)||[],a=>(o(),r("option",{key:a.id,value:a.id},u(a.name),9,ts))),128))],512),[[Y,ee.value]]),e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –ù–∞ –∫–æ–≥–æ –∑–∞–º–µ–Ω–∏—Ç—å: ",-1)),$(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>te.value=a),class:"w-full border rounded-lg p-2 dark:bg-gray-700 dark:text-white"},[e[33]||(e[33]=t("option",{value:""},"–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–≤–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è",-1)),(o(!0),r(w,null,C(Se.value,a=>(o(),r("option",{key:a.id,value:a.id},u(a.name)+" ("+u(a.email)+") ",9,ss))),128))],512),[[Y,te.value]]),K.value?(o(),r("p",as,u(K.value),1)):p("",!0),t("div",ls,[t("button",{onClick:e[5]||(e[5]=a=>T.value=!1),class:"px-4 py-2 border rounded-lg text-gray-600"}," –û—Ç–º–µ–Ω–∞ "),t("button",{onClick:Ie,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg"}," –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ")])])])):p("",!0),ne.value?(o(),r("div",os,[t("div",rs,[e[41]||(e[41]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," ‚ûï –ù–æ–≤–∞—è –¥–æ—á–µ—Ä–Ω—è—è –ø–æ–¥–∑–∞–¥–∞—á–∞ ",-1)),t("div",ns,[t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –ù–∞–∑–≤–∞–Ω–∏–µ ",-1)),$(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>L.value.title=a),type:"text",class:"w-full border rounded-lg p-2 dark:bg-gray-700 dark:text-white",placeholder:"–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏"},null,512),[[N,L.value.title]])]),t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è ",-1)),$(t("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>L.value.due_date=a),type:"date",class:"w-full border rounded-lg p-2 dark:bg-gray-700 dark:text-white"},null,512),[[N,L.value.due_date]])]),t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ ",-1)),t("div",ds,[(o(!0),r(w,null,C(g.value,a=>(o(),r("label",{key:a.id,class:"flex items-center gap-2 py-1"},[$(t("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=I=>L.value.executor_ids=I),value:a.id},null,8,is),[[me,L.value.executor_ids]]),t("span",null,u(a.name)+" ("+u(a.email)+")",1)]))),128))])]),t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ ",-1)),t("div",us,[(o(!0),r(w,null,C(g.value,a=>(o(),r("label",{key:a.id,class:"flex items-center gap-2 py-1"},[$(t("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=I=>L.value.responsible_ids=I),value:a.id},null,8,cs),[[me,L.value.responsible_ids]]),t("span",null,u(a.name)+" ("+u(a.email)+")",1)]))),128))])])]),ie.value?(o(),r("p",ps,u(ie.value),1)):p("",!0),t("div",ms,[t("button",{onClick:e[10]||(e[10]=a=>ne.value=!1),class:"px-4 py-2 border rounded-lg text-gray-600"}," –û—Ç–º–µ–Ω–∞ "),t("button",{onClick:Pe,class:"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg",disabled:de.value},[de.value?(o(),r("span",bs,"–°–æ–∑–¥–∞—é...")):(o(),r("span",gs,"–°–æ–∑–¥–∞—Ç—å"))],8,vs)])])])):p("",!0),q.value?(o(),r("div",xs,[t("div",ys,[e[44]||(e[44]=t("h3",{class:"text-lg font-semibold mb-3 text-gray-900 dark:text-white"}," ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ ",-1)),e[45]||(e[45]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –ö–æ–≥–æ –∑–∞–º–µ–Ω–∏—Ç—å: ",-1)),$(t("select",{"onUpdate:modelValue":e[11]||(e[11]=a=>se.value=a),class:"w-full border rounded-lg p-2 mb-4 dark:bg-gray-700 dark:text-white"},[e[42]||(e[42]=t("option",{value:""},"–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ",-1)),(o(!0),r(w,null,C(((S=s.value)==null?void 0:S.responsibles)||[],a=>(o(),r("option",{key:a.id,value:a.id},u(a.name),9,ks))),128))],512),[[Y,se.value]]),e[46]||(e[46]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –ù–∞ –∫–æ–≥–æ –∑–∞–º–µ–Ω–∏—Ç—å: ",-1)),$(t("select",{"onUpdate:modelValue":e[12]||(e[12]=a=>ae.value=a),class:"w-full border rounded-lg p-2 dark:bg-gray-700 dark:text-white"},[e[43]||(e[43]=t("option",{value:""},"–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ",-1)),(o(!0),r(w,null,C(Ue.value,a=>(o(),r("option",{key:a.id,value:a.id},u(a.name)+" ("+u(a.email)+") ",9,fs))),128))],512),[[Y,ae.value]]),X.value?(o(),r("p",hs,u(X.value),1)):p("",!0),t("div",ws,[t("button",{onClick:e[13]||(e[13]=a=>q.value=!1),class:"px-4 py-2 border rounded-lg text-gray-600"}," –û—Ç–º–µ–Ω–∞ "),t("button",{onClick:Ve,class:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg"}," –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ")])])])):p("",!0),H.value?(o(),r("div",_s,[t("div",Cs,[e[47]||(e[47]=t("h3",{class:"text-lg font-semibold mb-3 text-gray-900 dark:text-white"}," ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π ",-1)),t("div",$s,[(o(!0),r(w,null,C(g.value,a=>(o(),r("label",{key:a.id,class:"flex items-center gap-2 py-1"},[$(t("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=I=>m.value=I),value:a.id},null,8,js),[[me,m.value]]),t("span",null,u(a.name)+" ("+u(a.email)+")",1)]))),128))]),t("div",Ms,[t("button",{onClick:e[15]||(e[15]=a=>H.value=!1),class:"px-4 py-2 border rounded-lg text-gray-600"}," –û—Ç–º–µ–Ω–∞ "),t("button",{onClick:Me,class:"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg"}," –î–æ–±–∞–≤–∏—Ç—å ")])])])):p("",!0),O.value?(o(),r("div",Es,[t("div",Ss,[e[48]||(e[48]=t("h3",{class:"text-lg font-semibold mb-3 text-gray-900 dark:text-white"}," ‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö ",-1)),t("div",Us,[(o(!0),r(w,null,C(g.value,a=>(o(),r("label",{key:a.id,class:"flex items-center gap-2 py-1"},[$(t("input",{type:"checkbox","onUpdate:modelValue":e[16]||(e[16]=I=>m.value=I),value:a.id},null,8,Is),[[me,m.value]]),t("span",null,u(a.name)+" ("+u(a.email)+")",1)]))),128))]),t("div",Vs,[t("button",{onClick:e[17]||(e[17]=a=>O.value=!1),class:"px-4 py-2 border rounded-lg text-gray-600"}," –û—Ç–º–µ–Ω–∞ "),t("button",{onClick:Ee,class:"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded-lg"}," –î–æ–±–∞–≤–∏—Ç—å ")])])])):p("",!0),ve.value?(o(),r("div",Rs,[t("div",Ls,[e[51]||(e[51]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ ",-1)),G.value?(o(),r("p",zs,u(G.value),1)):p("",!0),t("div",As,[t("div",null,[e[49]||(e[49]=t("h4",{class:"text-gray-800 dark:text-gray-200 font-medium mb-2"},"–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏",-1)),t("ul",Ds,[(o(!0),r(w,null,C(((F=s.value)==null?void 0:F.executors)||[],a=>(o(),r("li",{key:a.id,class:"flex justify-between items-center bg-gray-50 dark:bg-gray-700 p-2 rounded-lg"},[t("span",null,u(a.name),1),t("button",{onClick:I=>Re(a.id),class:"text-rose-500 hover:text-rose-700",title:"–£–¥–∞–ª–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è"}," ‚ùå ",8,Fs)]))),128)),(fe=(h=s.value)==null?void 0:h.executors)!=null&&fe.length?p("",!0):(o(),r("li",Ns,"–ù–µ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π"))])]),t("div",null,[e[50]||(e[50]=t("h4",{class:"text-gray-800 dark:text-gray-200 font-medium mb-2"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ",-1)),t("ul",Ts,[(o(!0),r(w,null,C(((he=s.value)==null?void 0:he.responsibles)||[],a=>(o(),r("li",{key:a.id,class:"flex justify-between items-center bg-gray-50 dark:bg-gray-700 p-2 rounded-lg"},[t("span",null,u(a.name),1),t("button",{onClick:I=>Le(a.id),class:"text-rose-500 hover:text-rose-700",title:"–£–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ"}," ‚ùå ",8,Ps)]))),128)),(_e=(we=s.value)==null?void 0:we.responsibles)!=null&&_e.length?p("",!0):(o(),r("li",Bs,"–ù–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö"))])])]),t("div",Ws,[t("button",{onClick:e[18]||(e[18]=a=>ve.value=!1),class:"px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-white rounded-lg"}," –ó–∞–∫—Ä—ã—Ç—å ")])])])):p("",!0),t("div",qs,[t("div",Hs,[e[52]||(e[52]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-white"},"üß© –í–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–¥–∑–∞–¥–∞—á–∏",-1)),be.value?(o(),r("button",{key:0,onClick:Te,class:"px-3 py-1 bg-emerald-600 hover:bg-emerald-700 text-white rounded-md text-sm"}," ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É ")):p("",!0)]),(Ce=s.value.children)!=null&&Ce.length?(o(),r("ul",Os,[(o(!0),r(w,null,C(s.value.children,a=>(o(),r("li",{key:a.id,class:"flex justify-between items-center bg-gray-50 dark:bg-gray-700 p-2 rounded-lg"},[t("div",null,[t("span",Qs,u(a.title),1),t("span",Zs,u(a.progress??0)+"%",1)]),t("a",{href:`/subtasks/${a.id}`,class:"text-blue-600 dark:text-blue-400 hover:underline text-sm"}," –û—Ç–∫—Ä—ã—Ç—å ‚Üí ",8,Gs)]))),128))])):(o(),r("p",Js,"–ù–µ—Ç –¥–æ—á–µ—Ä–Ω–∏—Ö –ø–æ–¥–∑–∞–¥–∞—á"))]),t("div",Ks,[pe(ht,{"subtask-id":s.value.id,checklist:s.value.checklist,executors:s.value.executors,responsibles:s.value.responsibles,"can-write":ye.value,onUpdated:We},null,8,["subtask-id","checklist","executors","responsibles","can-write"]),pe(pt,{"subtask-id":s.value.id,comments:s.value.comments,"can-write":ye.value,members:[...s.value.executors??[],...s.value.responsibles??[]],onUpdated:Be},null,8,["subtask-id","comments","can-write","members"])]),le.value?(o(),r("div",Xs,[t("div",Ys,[e[55]||(e[55]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É ",-1)),t("div",ea,[t("div",null,[e[53]||(e[53]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –ù–∞–∑–≤–∞–Ω–∏–µ ",-1)),$(t("input",{required:"","onUpdate:modelValue":e[19]||(e[19]=a=>B.value.title=a),type:"text",class:"w-full border rounded-lg p-2 dark:bg-gray-700 dark:text-white",placeholder:"–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ"},null,512),[[N,B.value.title]])]),t("div",null,[e[54]||(e[54]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è ",-1)),$(t("input",{"onUpdate:modelValue":e[20]||(e[20]=a=>B.value.due_date=a),type:"date",class:"w-full border rounded-lg p-2 dark:bg-gray-700 dark:text-white"},null,512),[[N,B.value.due_date]])])]),re.value?(o(),r("p",ta,u(re.value),1)):p("",!0),t("div",sa,[t("button",{onClick:e[21]||(e[21]=a=>le.value=!1),class:"px-4 py-2 border rounded-lg text-gray-600"}," –û—Ç–º–µ–Ω–∞ "),t("button",{onClick:Ae,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg",disabled:oe.value},[oe.value?(o(),r("span",oa,"–°–æ—Ö—Ä–∞–Ω—è—é...")):(o(),r("span",la,"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"))],8,aa)])])])):p("",!0),ue.value?(o(),r("div",ra,[t("div",na,[e[56]||(e[56]=t("h3",{class:"text-lg font-semibold mb-3"},"–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏",-1)),$(t("textarea",{"onUpdate:modelValue":e[22]||(e[22]=a=>ce.value=a),class:"w-full border rounded-lg px-3 py-2 dark:bg-gray-700 dark:text-white",rows:"6",placeholder:"–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ..."},null,512),[[N,ce.value]]),t("div",da,[t("button",{onClick:e[23]||(e[23]=a=>ue.value=!1),class:"px-4 py-2 bg-gray-500 text-white rounded-lg"}," –ó–∞–∫—Ä—ã—Ç—å "),t("button",{onClick:He,class:"px-4 py-2 bg-indigo-600 text-white rounded-lg"}," –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ")])])])):p("",!0)])):(o(),r("div",ia,"–ó–∞–≥—Ä—É–∑–∫–∞..."))])]}),_:1})],64))}};export{ga as default};
