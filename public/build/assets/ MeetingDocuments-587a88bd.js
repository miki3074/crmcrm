import{K as p,h as D,o as u,a as r,b as e,t as c,F as C,d as S,g as f,w as b,v as x,u as i,N as y}from"./app-2ace687b.js";const I={class:"bg-white shadow sm:rounded-lg p-6 mt-6"},B={class:"text-lg font-medium mb-4"},N={class:"space-y-4 mb-6"},U={key:0,class:"flex justify-between"},j={class:"min-w-0"},F=["href"],M={class:"text-xs text-gray-500"},P={key:0,class:"flex gap-2"},T=["onClick"],V=["onClick"],E={key:1,class:"bg-gray-50 p-3 rounded space-y-2"},$={class:"flex gap-2 justify-end"},L={key:0,class:"border-t pt-4"},O=["disabled"],K={__name:" MeetingDocuments",props:{meeting:Object,auth_user_id:Number,canManage:Boolean,myParticipation:Object},setup(s){const g=s,h=o=>new Date(o).toLocaleString("ru-RU"),l=p({file:null,name:""}),v=()=>{if(!l.file)return alert("Выберите файл");l.post(route("meetings.documents.store",g.meeting.id),{preserveScroll:!0,onSuccess:()=>{l.reset(),document.getElementById("fileInput").value=""}})},k=o=>{confirm("Удалить этот файл?")&&y.delete(route("meetings.documents.destroy",[g.meeting.id,o]),{preserveScroll:!0})},m=D(null),a=p({name:"",file:null,_method:"PUT"}),_=o=>{m.value=o.id,a.name=o.name,a.file=null},w=()=>{y.post(route("meetings.documents.update",[g.meeting.id,m.value]),{_method:"PUT",name:a.name,file:a.file},{preserveScroll:!0,onSuccess:()=>m.value=null})};return(o,n)=>(u(),r("div",I,[e("h3",B,"Документы ("+c(s.meeting.documents?s.meeting.documents.length:0)+")",1),e("ul",N,[s.meeting.documents?(u(!0),r(C,{key:0},S(s.meeting.documents,t=>(u(),r("li",{key:t.id,class:"border-b pb-2 last:border-0"},[m.value!==t.id?(u(),r("div",U,[e("div",j,[e("a",{href:o.route("meetings.documents.download",[s.meeting.id,t.id]),class:"text-blue-600 hover:underline font-medium block truncate",target:"_blank"},c(t.name),9,F),e("p",M,c(t.human_size)+" • "+c(t.uploader.name)+" • "+c(h(t.created_at)),1)]),t.user_id===s.auth_user_id?(u(),r("div",P,[e("button",{onClick:d=>_(t),class:"text-gray-400 hover:text-blue-500"},"✎",8,T),e("button",{onClick:d=>k(t.id),class:"text-gray-400 hover:text-red-500"},"✕",8,V)])):f("",!0)])):(u(),r("div",E,[b(e("input",{"onUpdate:modelValue":n[0]||(n[0]=d=>i(a).name=d),class:"w-full text-xs border rounded",placeholder:"Имя"},null,512),[[x,i(a).name]]),e("input",{type:"file",onInput:n[1]||(n[1]=d=>i(a).file=d.target.files[0]),class:"w-full text-xs"},null,32),e("div",$,[e("button",{onClick:w,class:"bg-blue-600 text-white px-2 py-1 rounded text-xs"},"Сохранить"),e("button",{onClick:n[2]||(n[2]=d=>m.value=null),class:"bg-gray-200 px-2 py-1 rounded text-xs"},"Отмена")])]))]))),128)):f("",!0)]),s.myParticipation||s.canManage?(u(),r("div",L,[b(e("input",{"onUpdate:modelValue":n[3]||(n[3]=t=>i(l).name=t),type:"text",placeholder:"Название (опционально)",class:"w-full text-sm border rounded mb-2 px-2 py-1"},null,512),[[x,i(l).name]]),e("input",{id:"fileInput",type:"file",onInput:n[4]||(n[4]=t=>i(l).file=t.target.files[0]),class:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:bg-blue-50 file:text-blue-700"},null,32),e("button",{onClick:v,disabled:i(l).processing||!i(l).file,class:"mt-2 w-full bg-gray-800 text-white px-4 py-2 rounded text-sm hover:bg-gray-700"},"Загрузить",8,O)])):f("",!0)]))}};export{K as default};
