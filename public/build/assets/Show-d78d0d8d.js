import{m as x,p as B,I as Te,o as a,f as l,b as e,F as $,s as j,t as r,g as c,h as S,v as I,l as b,n as U,q as _e,i as Ue,d as w,Q as De,k as F,a as T,u as Be,w as qe,Z as Ne,x as Oe,e as ze}from"./app-3eaeb582.js";import{_ as Le}from"./AuthenticatedLayout-48644156.js";import"./ApplicationLogo-fd4e1a1d.js";import"./_plugin-vue_export-helper-c27b6911.js";const Ee={class:"rounded-2xl border bg-white dark:bg-gray-800 p-5 mt-8"},He={class:"space-y-3 max-h-80 overflow-y-auto pr-1"},Ae={class:"flex-1"},Pe={class:"flex items-center gap-2"},Qe={class:"text-sm font-medium text-gray-900 dark:text-white"},Ze={class:"text-xs text-gray-500"},Ge=["onClick"],Je={class:"mt-1 text-sm text-gray-800 dark:text-gray-200 whitespace-pre-wrap"},Ke={key:0,class:"text-sm text-gray-500"},Re={key:0,class:"mt-4"},We={class:"mt-2 flex justify-end"},Xe=["disabled"],Ye={key:1,class:"mt-3 text-xs text-gray-500"},et={__name:"TaskChat",props:{taskId:{type:Number,required:!0},canChat:{type:Boolean,default:!0}},setup(f){const _=f,p=x([]),m=x("");let y=null;const s=async()=>{const{data:v}=await b.get(`/api/tasks/${_.taskId}/comments`,{withCredentials:!0});p.value=v},h=async()=>{m.value.trim()&&(await b.get("/sanctum/csrf-cookie"),await b.post(`/api/tasks/${_.taskId}/comments`,{body:m.value},{withCredentials:!0}),m.value="",await s())},C=async v=>{await b.delete(`/api/task-comments/${v}`),await s()};return B(async()=>{await s(),y=setInterval(s,1e4)}),Te(()=>{y&&clearInterval(y)}),(v,g)=>(a(),l("div",Ee,[g[1]||(g[1]=e("div",{class:"mb-4 flex items-center justify-between"},[e("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Комментарии")],-1)),e("div",He,[(a(!0),l($,null,j(p.value,o=>{var n;return a(),l("div",{key:o.id,class:"flex gap-3"},[e("div",Ae,[e("div",Pe,[e("div",Qe,r(((n=o.user)==null?void 0:n.name)??"—"),1),e("div",Ze,r(new Date(o.created_at).toLocaleString()),1),v.$page.props.auth.user&&o.user&&o.user.id===v.$page.props.auth.user.id?(a(),l("button",{key:0,class:"ml-auto text-xs text-red-600 hover:underline",onClick:k=>C(o.id)},"Удалить",8,Ge)):c("",!0)]),e("div",Je,r(o.body),1)])])}),128)),p.value.length?c("",!0):(a(),l("div",Ke,"Пока нет сообщений."))]),f.canChat?(a(),l("div",Re,[S(e("textarea",{"onUpdate:modelValue":g[0]||(g[0]=o=>m.value=o),rows:"2",placeholder:"Напишите комментарий…",class:"w-full rounded-lg border bg-white/80 dark:bg-gray-700 px-3 py-2 text-sm dark:text-white"},null,512),[[I,m.value]]),e("div",We,[e("button",{onClick:h,disabled:!m.value.trim(),class:"px-4 py-2 rounded-lg bg-indigo-600 text-white disabled:opacity-40"},"Отправить",8,Xe)])])):(a(),l("div",Ye," У вас нет прав на участие в чате этой задачи. "))]))}},tt={class:"mt-6"},st={key:0,class:"space-y-2"},at=["checked","onChange"],lt={key:0,class:"text-sm text-gray-500"},ot={key:1,class:"text-gray-500"},it={key:2,class:"fixed inset-0 bg-black/50 flex items-center justify-center"},dt={class:"bg-white rounded p-6 w-96"},rt=["value"],nt=["value"],ut=["value"],gt={class:"flex items-center gap-2 mb-2"},ct={class:"flex justify-end gap-2"},pt={__name:"TaskChecklists",props:{taskId:Number,executor:Object,responsible:Object,creator:Object},setup(f){const _=f,p=x([]),m=x(!1),y=x(!1),s=x({title:"",assigned_to:"",important:!1,files:[]}),h=async()=>{m.value=!0;try{const{data:g}=await b.get(`/api/tasks/${_.taskId}/checklists`);p.value=g}finally{m.value=!1}},C=async()=>{const g=new FormData;g.append("title",s.value.title),s.value.assigned_to&&g.append("assigned_to",s.value.assigned_to),g.append("important",s.value.important?1:0);for(let o of s.value.files)g.append("files[]",o);await b.post(`/api/tasks/${_.taskId}/checklists`,g),y.value=!1,s.value={title:"",assigned_to:"",important:!1,files:[]},await h()},v=async g=>{await b.patch(`/api/checklists/${g.id}/toggle`),await h()};return B(h),(g,o)=>(a(),l("div",tt,[o[10]||(o[10]=e("h3",{class:"text-lg font-semibold mb-2"},"Чек-листы",-1)),p.value.length?(a(),l("ul",st,[(a(!0),l($,null,j(p.value,n=>(a(),l("li",{key:n.id,class:"flex items-center gap-2"},[e("input",{type:"checkbox",checked:n.completed,onChange:k=>v(n)},null,40,at),e("span",{class:U({"font-bold text-red-600":n.important})},r(n.title),3),n.assignee?(a(),l("span",lt,"("+r(n.assignee.name)+")",1)):c("",!0)]))),128))])):(a(),l("p",ot,"Нет чек-листов")),e("button",{class:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded",onClick:o[0]||(o[0]=n=>y.value=!0)}," Добавить чек-лист "),y.value?(a(),l("div",it,[e("div",dt,[o[8]||(o[8]=e("h4",{class:"text-lg font-semibold mb-4"},"Новый пункт чек-листа",-1)),S(e("input",{"onUpdate:modelValue":o[1]||(o[1]=n=>s.value.title=n),type:"text",placeholder:"Название",class:"w-full border mb-2 p-2"},null,512),[[I,s.value.title]]),o[9]||(o[9]=e("label",{class:"block text-sm"},"Ответственный",-1)),S(e("select",{"onUpdate:modelValue":o[2]||(o[2]=n=>s.value.assigned_to=n),class:"w-full border mb-2 p-2"},[o[6]||(o[6]=e("option",{value:""},"—",-1)),e("option",{value:f.executor.id},r(f.executor.name),9,rt),e("option",{value:f.responsible.id},r(f.responsible.name),9,nt),e("option",{value:f.creator.id},r(f.creator.name),9,ut)],512),[[_e,s.value.assigned_to]]),e("label",gt,[S(e("input",{type:"checkbox","onUpdate:modelValue":o[3]||(o[3]=n=>s.value.important=n)},null,512),[[Ue,s.value.important]]),o[7]||(o[7]=w(" Важно ",-1))]),e("input",{type:"file",multiple:"",onChange:o[4]||(o[4]=n=>s.value.files=Array.from(n.target.files)),class:"mb-4"},null,32),e("div",ct,[e("button",{onClick:o[5]||(o[5]=n=>y.value=!1),class:"px-3 py-1 border"},"Отмена"),e("button",{onClick:C,class:"px-3 py-1 bg-indigo-600 text-white"},"Сохранить")])])])):c("",!0)]))}},vt={class:"relative overflow-hidden"},xt={class:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 text-white"},mt={class:"flex items-start gap-4"},yt={class:"flex-1"},bt={class:"text-2xl sm:text-3xl font-semibold"},kt={class:"mt-2 flex flex-wrap items-center gap-2 text-sm"},ft={class:"px-2 py-1 rounded-full bg-white/20"},ht={class:"px-2 py-1 rounded-full bg-white/20"},_t={class:"px-2 py-1 rounded-full bg-white/20"},wt={class:"px-2 py-1 rounded-full bg-white/20"},$t={class:"px-2 py-1 rounded-full bg-white/20"},Ct={class:"hidden sm:flex items-center gap-3"},jt=["href"],St={key:0,class:"mt-3"},Vt={key:1,class:"text-xs text-amber-600 mt-2"},It={key:0},Mt={key:2,class:"text-sm mt-2 text-emerald-700"},Ft={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-4 pb-10",style:{"margin-top":"3%"}},Tt={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Ut={class:"lg:col-span-2 space-y-4"},Dt={class:"rounded-2xl border bg-white dark:bg-gray-800 p-5"},Bt={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},qt={class:"text-sm font-medium text-gray-900 dark:text-white"},Nt={class:"text-sm font-medium text-gray-900 dark:text-white"},Ot={class:"mt-2"},zt={class:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},Lt={class:"mt-1 text-xs text-gray-600 dark:text-gray-300"},Et={class:"flex mt-3 gap-1"},Ht=["onClick","title"],At={class:"rounded-2xl border bg-white dark:bg-gray-800 p-5"},Pt={class:"flex items-center justify-between"},Qt={class:"flex items-center gap-2"},Zt={key:0,class:"mt-4 grid grid-cols-2 gap-2"},Gt={key:1,class:"mt-3"},Jt={key:0,class:"text-sm text-gray-600 dark:text-gray-300"},Kt={key:1,class:"flex flex-wrap gap-2"},Rt=["href"],Wt={class:"rounded-2xl border bg-white dark:bg-gray-800 p-5"},Xt={class:"flex items-center justify-between mb-3"},Yt={key:0,class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},es={key:1,class:"text-sm text-gray-600 dark:text-gray-300"},ts={key:2,class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},ss=["onClick"],as={class:"flex items-start justify-between gap-3"},ls={class:"text-base font-semibold text-gray-900 dark:text-white leading-snug"},os={class:"mt-2 text-sm text-gray-600 dark:text-gray-300 space-y-1.5"},is={class:"space-y-4"},ds={class:"rounded-2xl border bg-white dark:bg-gray-800 p-5"},rs={class:"mt-3 space-y-2 text-sm text-gray-700 dark:text-gray-300"},ns={class:"flex justify-between"},us={class:"font-medium"},gs={class:"flex justify-between"},cs={class:"font-medium"},ps={class:"flex justify-between"},vs={class:"font-medium"},xs={class:"flex justify-between"},ms={class:"font-medium"},ys={class:"flex justify-between"},bs={class:"font-medium"},ks={class:"flex justify-between"},fs={key:0,class:"rounded-2xl border bg-white dark:bg-gray-800 p-5"},hs={key:0,class:"space-y-4"},_s={class:"rounded-2xl border bg-white dark:bg-gray-800 p-5"},ws={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},$s={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Cs={class:"relative w-full max-w-md bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6"},js={class:"flex items-center justify-between"},Ss={key:0,class:"mt-3 text-sm text-rose-600"},Vs=["value"],Is={class:"grid grid-cols-2 gap-4"},Ms={class:"flex justify-end gap-2"},Fs=["disabled"],Ts={key:0},Us={key:1},Os={__name:"Show",setup(f){var z;const{props:_}=De(),p=_.id,m=(z=_.auth)==null?void 0:z.user,y=x(!0),s=x(null),h=x(!1),C=x(""),v=x(null),g=i=>{v.value=i.target.files},o=x(!1),n=x([]),k=x({title:"",executor_id:"",start_date:new Date().toISOString().slice(0,10),due_date:""}),we=F(()=>{var i,t,u;return!s.value||!m?!1:((i=s.value.responsible)==null?void 0:i.id)===m.id||((u=(t=s.value.project)==null?void 0:t.manager)==null?void 0:u.id)===m.id}),q=i=>i==="high"?"bg-rose-100 text-rose-700 ring-1 ring-rose-200":i==="medium"?"bg-amber-100 text-amber-700 ring-1 ring-amber-200":"bg-emerald-100 text-emerald-700 ring-1 ring-emerald-200",N=i=>i==="high"?"Высокая":i==="medium"?"Средняя":"Обычная",D=async()=>{y.value=!0;try{const{data:i}=await b.get(`/api/tasks/${p}`);s.value=i}finally{y.value=!1}},$e=async i=>{try{const{data:t}=await b.patch(`/api/tasks/${p}/progress`,{progress:i});s.value.progress=t.progress}catch{alert("Недостаточно прав для обновления прогресса.")}},Ce=async()=>{var t;if(!((t=v.value)!=null&&t.length))return alert("Выберите файлы");const i=new FormData;for(let u=0;u<v.value.length;u++)i.append("files[]",v.value[u]);try{await b.post(`/api/tasks/${p}/files`,i,{headers:{"Content-Type":"multipart/form-data"}}),v.value=null,await D()}catch{alert("Ошибка при загрузке файлов")}},je=async()=>{const{data:i}=await b.get(`/api/projects/${s.value.project.id}/employees`);n.value=i,o.value=!0},Se=async()=>{var i,t;h.value=!0,C.value="";try{await b.post(`/api/tasks/${p}/subtasks`,{...k.value,task_id:p}),o.value=!1,k.value={title:"",executor_id:"",start_date:new Date().toISOString().slice(0,10),due_date:""},await D()}catch(u){C.value=((t=(i=u==null?void 0:u.response)==null?void 0:i.data)==null?void 0:t.message)||"Ошибка при создании подзадачи"}finally{h.value=!1}},O=F(()=>{var i;return(((i=s.value)==null?void 0:i.subtasks)||[]).some(t=>!t.completed)}),Ve=F(()=>{var i,t;return((i=s.value)==null?void 0:i.progress)===100&&!((t=s.value)!=null&&t.completed)&&!O.value}),Ie=async()=>{var i,t;try{const{data:u}=await b.patch(`/api/tasks/${p}/complete`);s.value=u.task}catch(u){const M=((t=(i=u==null?void 0:u.response)==null?void 0:i.data)==null?void 0:t.message)||"Не удалось завершить задачу";alert(M)}},Me=F(()=>{var t,u;const i=(u=(t=_.auth)==null?void 0:t.user)==null?void 0:u.id;return!i||!s.value?!1:i===s.value.executor_id||i===s.value.responsible_id});return B(D),(i,t)=>{var u;return a(),l($,null,[T(Be(Ne),{title:(u=s.value)!=null&&u.title?`Задача — ${s.value.title}`:"Задача"},null,8,["title"]),T(Le,null,{default:qe(()=>{var M,L,E,H,A,P,Q,Z,G,J,K,R,W,X,Y,ee,te,se,ae,le,oe,ie,de,re,ne,ue,ge,ce,pe,ve,xe,me,ye,be,ke,fe,he;return[e("div",vt,[t[13]||(t[13]=e("div",{class:"absolute inset-0 bg-gradient-to-r from-sky-600 via-indigo-600 to-fuchsia-600 opacity-90"},null,-1)),e("div",xt,[e("div",mt,[e("div",yt,[e("h1",bt,r(((M=s.value)==null?void 0:M.title)??"Загрузка…"),1),e("div",kt,[e("span",ft,[t[7]||(t[7]=w(" Проект: ",-1)),e("b",null,r(((E=(L=s.value)==null?void 0:L.project)==null?void 0:E.name)??"—"),1)]),e("span",ht,[t[8]||(t[8]=w(" Компания: ",-1)),e("b",null,r(((P=(A=(H=s.value)==null?void 0:H.project)==null?void 0:A.company)==null?void 0:P.name)??"—"),1)]),e("span",_t,[t[9]||(t[9]=w(" От: ",-1)),e("b",null,r(((Z=(Q=s.value)==null?void 0:Q.creator)==null?void 0:Z.name)??"—"),1)]),e("span",wt,[t[10]||(t[10]=w(" Кому: ",-1)),e("b",null,r(((J=(G=s.value)==null?void 0:G.executor)==null?void 0:J.name)??"—"),1)]),e("span",$t,[t[11]||(t[11]=w(" Ответственный: ",-1)),e("b",null,r(((R=(K=s.value)==null?void 0:K.responsible)==null?void 0:R.name)??"—"),1)]),s.value?(a(),l("span",{key:0,class:U(["px-2 py-1 rounded-full ring-1 bg-white text-gray-900",q(s.value.priority)])},[t[12]||(t[12]=w(" Приоритет: ",-1)),e("b",null,r(N(s.value.priority)),1)],2)):c("",!0)])]),e("div",Ct,[(X=(W=s.value)==null?void 0:W.project)!=null&&X.id?(a(),l("a",{key:0,href:`/projects/${s.value.project.id}`,class:"rounded-xl bg-white text-gray-900 hover:bg-white/90 px-4 py-2 font-medium"}," К проекту ",8,jt)):c("",!0)]),Me.value?(a(),l("div",St,[Ve.value?(a(),l("button",{key:0,onClick:Ie,class:"px-4 py-2 rounded bg-emerald-600 text-white hover:bg-emerald-700",title:"Завершить задачу"}," Завершить задачу ")):((Y=s.value)==null?void 0:Y.progress)===100&&!((ee=s.value)!=null&&ee.completed)?(a(),l("div",Vt,[O.value?(a(),l("span",It," Есть незавершённые подзадачи — завершите их, чтобы закрыть задачу. ")):c("",!0)])):c("",!0),(te=s.value)!=null&&te.completed?(a(),l("div",Mt," Завершена "+r(((se=s.value)==null?void 0:se.completed_at)||""),1)):c("",!0)])):c("",!0)])])]),e("div",Ft,[e("div",Tt,[e("div",Ut,[e("div",Dt,[e("div",Bt,[e("div",null,[t[14]||(t[14]=e("div",{class:"text-xs text-gray-500"},"Дата начала",-1)),e("div",qt,r(((ae=s.value)==null?void 0:ae.start_date)??"—"),1)]),e("div",null,[t[15]||(t[15]=e("div",{class:"text-xs text-gray-500"},"Дата окончания",-1)),e("div",Nt,r(((le=s.value)==null?void 0:le.due_date)??"—"),1)]),e("div",null,[t[16]||(t[16]=e("div",{class:"text-xs text-gray-500"},"Прогресс",-1)),e("div",Ot,[e("div",zt,[e("div",{class:"h-2 bg-emerald-500",style:Oe({width:(((oe=s.value)==null?void 0:oe.progress)||0)+"%"})},null,4)]),e("div",Lt,"Выполнено "+r(((ie=s.value)==null?void 0:ie.progress)??0)+"%",1)]),e("div",Et,[(a(),l($,null,j(11,d=>{var V;return e("button",{key:d,onClick:Fe=>$e((d-1)*10),class:U(["flex-1 h-5 rounded bg-gray-200 dark:bg-gray-700 hover:bg-gray-300",{"!bg-emerald-500":(((V=s.value)==null?void 0:V.progress)||0)>=(d-1)*10}]),title:`${(d-1)*10}%`},null,10,Ht)}),64))])])])]),e("div",At,[e("div",Pt,[t[17]||(t[17]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Файлы",-1)),e("div",Qt,[e("input",{type:"file",multiple:"",onChange:g,accept:".pdf,.doc,.docx,.xls,.xlsx",class:"text-sm text-gray-600 dark:text-gray-300"},null,32),e("button",{onClick:Ce,class:"rounded-xl bg-indigo-600 text-white px-4 py-2 hover:bg-indigo-700"}," Загрузить ")])]),y.value?(a(),l("div",Zt,[(a(),l($,null,j(4,d=>e("div",{key:d,class:"h-8 rounded-lg bg-gray-200 dark:bg-gray-700 animate-pulse"})),64))])):(a(),l("div",Gt,[(re=(de=s.value)==null?void 0:de.files)!=null&&re.length?(a(),l("div",Kt,[(a(!0),l($,null,j(s.value.files,d=>(a(),l("a",{key:d.id,href:`/storage/${d.file_path}`,target:"_blank",class:"inline-flex items-center gap-1 text-xs px-2 py-1 rounded-full bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-100"},[t[18]||(t[18]=e("svg",{class:"w-3.5 h-3.5",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12V8l-4-6zM6 22V4h7v5h5v13H6z"})],-1)),w(" "+r(d.file_path.split("/").pop()),1)],8,Rt))),128))])):(a(),l("div",Jt," Файлы не прикреплены. "))]))]),e("div",Wt,[e("div",Xt,[t[19]||(t[19]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Подзадачи",-1)),we.value?(a(),l("button",{key:0,onClick:je,class:"rounded-xl bg-emerald-600 text-white px-4 py-2 hover:bg-emerald-700"}," + Подзадача ")):c("",!0)]),y.value?(a(),l("div",Yt,[(a(),l($,null,j(4,d=>e("div",{key:d,class:"rounded-xl border p-4 animate-pulse"},t[20]||(t[20]=[e("div",{class:"h-4 w-1/2 bg-gray-200 dark:bg-gray-700 rounded mb-3"},null,-1),e("div",{class:"h-3 w-2/3 bg-gray-200 dark:bg-gray-700 rounded mb-2"},null,-1),e("div",{class:"h-3 w-1/2 bg-gray-200 dark:bg-gray-700 rounded"},null,-1)]))),64))])):(ue=(ne=s.value)==null?void 0:ne.subtasks)!=null&&ue.length?(a(),l("div",ts,[(a(!0),l($,null,j(s.value.subtasks,d=>{var V;return a(),l("div",{key:d.id,class:"group rounded-xl border p-4 bg-white dark:bg-gray-800 hover:shadow-md transition cursor-pointer",onClick:Fe=>i.$inertia.visit(`/subtasks/${d.id}`)},[e("div",as,[e("h3",ls,r(d.title),1)]),e("div",os,[e("div",null,[t[21]||(t[21]=w("Исполнитель: ",-1)),e("b",null,r(((V=d.executor)==null?void 0:V.name)??"—"),1)]),e("div",null,"Сроки: "+r(d.start_date)+" — "+r(d.due_date),1)])],8,ss)}),128))])):(a(),l("div",es," Подзадач пока нет. "))])]),e("div",is,[e("div",ds,[t[28]||(t[28]=e("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Кратко о задаче",-1)),e("dl",rs,[e("div",ns,[t[22]||(t[22]=e("dt",null,"Автор",-1)),e("dd",us,r(((ce=(ge=s.value)==null?void 0:ge.creator)==null?void 0:ce.name)??"—"),1)]),e("div",gs,[t[23]||(t[23]=e("dt",null,"Исполнитель",-1)),e("dd",cs,r(((ve=(pe=s.value)==null?void 0:pe.executor)==null?void 0:ve.name)??"—"),1)]),e("div",ps,[t[24]||(t[24]=e("dt",null,"Ответственный",-1)),e("dd",vs,r(((me=(xe=s.value)==null?void 0:xe.responsible)==null?void 0:me.name)??"—"),1)]),e("div",xs,[t[25]||(t[25]=e("dt",null,"Проект",-1)),e("dd",ms,r(((be=(ye=s.value)==null?void 0:ye.project)==null?void 0:be.name)??"—"),1)]),e("div",ys,[t[26]||(t[26]=e("dt",null,"Компания",-1)),e("dd",bs,r(((he=(fe=(ke=s.value)==null?void 0:ke.project)==null?void 0:fe.company)==null?void 0:he.name)??"—"),1)]),e("div",ks,[t[27]||(t[27]=e("dt",null,"Приоритет",-1)),e("dd",null,[s.value?(a(),l("span",{key:0,class:U(["px-2 py-1 text-xs rounded-full ring-1",q(s.value.priority)])},r(N(s.value.priority)),3)):c("",!0)])])])]),s.value?(a(),l("div",fs,[T(pt,{"task-id":s.value.id,executor:s.value.executor,responsible:s.value.responsible,creator:s.value.creator},null,8,["task-id","executor","responsible","creator"])])):c("",!0)]),s.value?(a(),l("div",hs,[e("div",_s,[t[29]||(t[29]=e("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Чат",-1)),T(et,{"task-id":s.value.id,"can-chat":!0},null,8,["task-id"])])])):(a(),l("div",ws,"Загрузка…"))])]),o.value?(a(),l("div",$s,[e("div",{class:"absolute inset-0 bg-black/50",onClick:t[0]||(t[0]=d=>o.value=!1)}),e("div",Cs,[e("div",js,[t[30]||(t[30]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Новая подзадача",-1)),e("button",{onClick:t[1]||(t[1]=d=>o.value=!1),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200"},"✕")]),C.value?(a(),l("p",Ss,r(C.value),1)):c("",!0),e("form",{class:"mt-4 space-y-4",onSubmit:ze(Se,["prevent"])},[e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm mb-1 text-gray-700 dark:text-gray-300"},"Название",-1)),S(e("input",{"onUpdate:modelValue":t[2]||(t[2]=d=>k.value.title=d),class:"w-full rounded-xl border px-3 py-2 bg-white dark:bg-gray-700 dark:text-white",required:""},null,512),[[I,k.value.title]])]),e("div",null,[t[33]||(t[33]=e("label",{class:"block text-sm mb-1 text-gray-700 dark:text-gray-300"},"Исполнитель",-1)),S(e("select",{"onUpdate:modelValue":t[3]||(t[3]=d=>k.value.executor_id=d),class:"w-full rounded-xl border px-3 py-2 bg-white dark:bg-gray-700 dark:text-white",required:""},[t[32]||(t[32]=e("option",{disabled:"",value:""},"Выберите сотрудника",-1)),(a(!0),l($,null,j(n.value,d=>(a(),l("option",{key:d.id,value:d.id},r(d.name),9,Vs))),128))],512),[[_e,k.value.executor_id]])]),e("div",Is,[e("div",null,[t[34]||(t[34]=e("label",{class:"block text-sm mb-1 text-gray-700 dark:text-gray-300"},"Начало",-1)),S(e("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=d=>k.value.start_date=d),class:"w-full rounded-xl border px-3 py-2 bg-white dark:bg-gray-700 dark:text-white",required:""},null,512),[[I,k.value.start_date]])]),e("div",null,[t[35]||(t[35]=e("label",{class:"block text-sm mb-1 text-gray-700 dark:text-gray-300"},"Окончание",-1)),S(e("input",{type:"date","onUpdate:modelValue":t[5]||(t[5]=d=>k.value.due_date=d),class:"w-full rounded-xl border px-3 py-2 bg-white dark:bg-gray-700 dark:text-white",required:""},null,512),[[I,k.value.due_date]])])]),e("div",Ms,[e("button",{type:"button",onClick:t[6]||(t[6]=d=>o.value=!1),class:"px-4 py-2 rounded-xl border bg-white dark:bg-gray-700 dark:text-white"},"Отмена"),e("button",{type:"submit",disabled:h.value,class:"px-4 py-2 rounded-xl bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-60"},[h.value?(a(),l("span",Us,"Сохраняю…")):(a(),l("span",Ts,"Создать"))],8,Fs)])],32)])])):c("",!0)]}),_:1})],64)}}};export{Os as default};
