import{Q as q,r as z,m as $,q as L,o as n,f as i,a as S,u as M,w as N,F as V,i as v,Z as Q,b as t,t as o,n as B,d as T,g as y,x as U}from"./app-b0d40684.js";import{_ as Z}from"./AuthenticatedLayout-f963546f.js";import"./ApplicationLogo-6e0c1e87.js";import"./_plugin-vue_export-helper-c27b6911.js";const A={class:"flex items-center justify-between gap-3"},G={class:"text-xl font-bold text-gray-800 dark:text-gray-200"},H={key:0,class:"flex items-center gap-2"},J={class:"inline-flex items-center gap-2 text-sm px-3 py-1 rounded-full ring-1 ring-gray-200 dark:ring-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"},K={key:2,class:"px-3 py-1.5 rounded-md bg-emerald-100 text-emerald-700 text-sm dark:bg-emerald-900/30 dark:text-emerald-300"},O={class:"max-w-4xl mx-auto py-8 px-4"},R={key:0,class:"grid gap-6"},W={class:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6"},X={class:"grid sm:grid-cols-2 gap-4 text-sm"},Y={class:"font-medium text-gray-900 dark:text-white"},tt={class:"font-medium text-gray-900 dark:text-white"},et={class:"font-medium text-gray-900 dark:text-white"},st={class:"font-medium text-gray-900 dark:text-white"},at={class:"font-medium text-gray-900 dark:text-white"},rt={class:"mt-6 grid sm:grid-cols-3 gap-4"},ot={class:"font-medium text-gray-900 dark:text-white"},lt={class:"font-medium text-gray-900 dark:text-white"},dt={class:"font-medium text-gray-900 dark:text-white"},nt={class:"bg-white dark:bg-gray-800 rounded-2xl shadow p-6"},it={class:"flex items-center justify-between mb-3"},ut={class:"text-sm text-gray-500 dark:text-gray-400"},ct={class:"flex mt-2 space-x-1 select-none"},pt=["title","onClick"],gt={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-2"},mt={key:1,class:"text-gray-600 dark:text-gray-300"},ht={__name:"Show",setup(xt){var h;const{props:_}=q(),k=_.id,e=z(null),u=(h=_.auth)==null?void 0:h.user,E=async()=>{const{data:a}=await v.get(`/api/subtasks/${k}`);e.value=a},p=$(()=>!e.value||!u?!1:(e.value.executors||[]).some(s=>s.id===u.id)||u.id===e.value.creator_id),f=$(()=>e.value?p.value&&e.value.progress===100&&!e.value.completed:!1),D=async a=>{if(!p.value)return;const{data:s}=await v.patch(`/api/subtasks/${k}/progress`,{progress:a});e.value.progress=s.progress},F=async()=>{if(!f.value||!confirm("–ó–∞–≤–µ—Ä—à–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É?"))return;const{data:a}=await v.patch(`/api/subtasks/${k}/complete`);e.value.completed=a.completed,e.value.completed_at=a.completed_at},I=async a=>{var s,l;if(confirm("–£–¥–∞–ª–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É?"))try{await v.delete(`/api/subtasks/${a}`,{withCredentials:!0}),alert("–ü–æ–¥–∑–∞–¥–∞—á–∞ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞"),window.history.back()}catch(r){alert(((l=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:l.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–¥–∑–∞–¥–∞—á–∏")}},P=a=>{var l,r,c,g,m;const s=u==null?void 0:u.id;return s?s===a.creator_id||s===((c=(r=(l=a.task)==null?void 0:l.project)==null?void 0:r.company)==null?void 0:c.user_id)||(((m=(g=a.task)==null?void 0:g.project)==null?void 0:m.managers)||[]).some(x=>x.id===s):!1};return L(E),(a,s)=>(n(),i(V,null,[S(M(Q),{title:"–ü–æ–¥–∑–∞–¥–∞—á–∞"}),S(Z,null,{header:N(()=>{var l,r;return[t("div",A,[t("h2",G," –ü–æ–¥–∑–∞–¥–∞—á–∞: "+o(((l=e.value)==null?void 0:l.title)??"–ó–∞–≥—Ä—É–∑–∫–∞..."),1),e.value?(n(),i("div",H,[t("span",J,[t("span",{class:B(["w-2 h-2 rounded-full",{"bg-red-500":(e.value.progress??0)<30,"bg-amber-500":(e.value.progress??0)>=30&&(e.value.progress??0)<70,"bg-green-500":(e.value.progress??0)>=70}])},null,2),T(" "+o(e.value.progress??0)+"% ",1)]),f.value?(n(),i("button",{key:0,onClick:F,class:"px-3 py-1.5 rounded-md bg-emerald-600 text-white text-sm hover:bg-emerald-700"}," –ó–∞–≤–µ—Ä—à–∏—Ç—å ")):y("",!0),P(e.value)?(n(),i("button",{key:1,onClick:s[0]||(s[0]=c=>I(e.value.id)),class:"px-3 py-1 bg-rose-600 hover:bg-rose-700 text-white text-sm rounded-md"}," üóë –£–¥–∞–ª–∏—Ç—å ")):e.value.completed?(n(),i("span",K," –ó–∞–≤–µ—Ä—à–µ–Ω–∞ ‚Ä¢ "+o(((r=e.value.completed_at)==null?void 0:r.slice(0,16))??""),1)):y("",!0)])):y("",!0)])]}),default:N(()=>{var l,r,c,g,m,x,b,w,C;return[t("div",O,[e.value?(n(),i("div",R,[t("div",W,[t("div",X,[t("div",null,[s[1]||(s[1]=t("p",{class:"text-gray-500 dark:text-gray-400"},"–ê–≤—Ç–æ—Ä",-1)),t("p",Y,o((l=e.value.creator)==null?void 0:l.name),1)]),t("div",null,[s[2]||(s[2]=t("p",{class:"text-gray-500 dark:text-gray-400"},"–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å",-1)),t("p",tt,o((r=e.value.executors)!=null&&r.length?e.value.executors.map(d=>d.name).join(", "):"‚Äî"),1)]),t("div",null,[s[3]||(s[3]=t("p",{class:"text-gray-500 dark:text-gray-400"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π",-1)),t("p",et,o((c=e.value.responsibles)!=null&&c.length?e.value.responsibles.map(d=>d.name).join(", "):"‚Äî"),1)]),t("div",null,[s[4]||(s[4]=t("p",{class:"text-gray-500 dark:text-gray-400"},"–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞",-1)),t("p",st,o(e.value.start_date),1)]),t("div",null,[s[5]||(s[5]=t("p",{class:"text-gray-500 dark:text-gray-400"},"–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è",-1)),t("p",at,o(e.value.due_date),1)])]),t("div",rt,[t("div",null,[s[6]||(s[6]=t("p",{class:"text-gray-500 dark:text-gray-400 text-sm"},"–ó–∞–¥–∞—á–∞",-1)),t("p",ot,o((g=e.value.task)==null?void 0:g.title),1)]),t("div",null,[s[7]||(s[7]=t("p",{class:"text-gray-500 dark:text-gray-400 text-sm"},"–ü—Ä–æ–µ–∫—Ç",-1)),t("p",lt,o((x=(m=e.value.task)==null?void 0:m.project)==null?void 0:x.name),1)]),t("div",null,[s[8]||(s[8]=t("p",{class:"text-gray-500 dark:text-gray-400 text-sm"},"–ö–æ–º–ø–∞–Ω–∏—è",-1)),t("p",dt,o((C=(w=(b=e.value.task)==null?void 0:b.project)==null?void 0:w.company)==null?void 0:C.name),1)])])]),t("div",nt,[t("div",it,[s[9]||(s[9]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-white"},"–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–¥–∑–∞–¥–∞—á–∏",-1)),t("span",ut,"–í—ã–ø–æ–ª–Ω–µ–Ω–æ "+o(e.value.progress??0)+"%",1)]),t("div",ct,[(n(),i(V,null,U(10,d=>{var j;return t("div",{key:d,title:d*10+"%",onClick:vt=>p.value?D(d*10):null,class:B(["h-4 sm:h-5 flex-1 rounded transition",{"cursor-pointer hover:opacity-80":p.value,"bg-green-600":(e.value.progress??0)>=d*10,"bg-gray-200 dark:bg-gray-700":(e.value.progress??0)<d*10,"pointer-events-none opacity-60":(j=e.value)==null?void 0:j.completed}])},null,10,pt)}),64))]),p.value?y("",!0):(n(),i("p",gt," –ò–∑–º–µ–Ω—è—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –∏ –∞–≤—Ç–æ—Ä –ø–æ–¥–∑–∞–¥–∞—á–∏. "))])])):(n(),i("div",mt,"–ó–∞–≥—Ä—É–∑–∫–∞..."))])]}),_:1})],64))}};export{ht as default};
