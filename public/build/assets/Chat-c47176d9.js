import{V as L,r as u,x as S,o as l,L as W,H as F,f as b,a as t,k as A,u as P,Z as z,c as o,e as m,E as k,t as p,F as f,d as x,b as _,h as H,v as Q}from"./app-2097a917.js";import{_ as U}from"./AuthenticatedLayout-9323830d.js";import"./ApplicationLogo-fb32f1dc.js";import"./_plugin-vue_export-helper-c27b6911.js";const Z={class:"max-w-6xl mx-auto p-6 grid grid-cols-1 md:grid-cols-[260px,1fr] gap-4"},q={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-700 p-3 flex flex-col"},G={class:"flex items-center justify-between mb-3"},I={class:"flex-1 overflow-y-auto space-y-2"},J=["onClick"],K={class:"text-sm font-semibold"},O={class:"text-xs text-slate-500"},R={key:0,class:"text-xs text-slate-400"},X={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-700 flex flex-col"},Y={class:"border-b border-slate-200 dark:border-slate-700 px-4 py-3 flex justify-between items-center"},ee={class:"font-semibold"},te={class:"flex-1 overflow-y-auto px-4 py-3 space-y-3"},se={key:0,class:"text-sm text-slate-500"},ae={key:0,class:"whitespace-pre-line break-words"},le={key:1,class:"mt-2 space-y-1"},oe=["src"],re={key:1,controls:"",class:"rounded-lg max-w-xs border"},ne=["src"],de=["href"],ie={class:"text-[10px] mt-1 opacity-70 text-right"},ue={key:0,class:"border-t border-slate-200 dark:border-slate-700 px-4 py-3 space-y-2"},ce={key:0,class:"flex flex-wrap gap-2"},pe={class:"truncate max-w-[140px]"},ve=["onClick"],xe={class:"flex justify-between items-center"},ge={class:"flex items-center gap-2"},he={class:"text-xs px-2 py-1 rounded-lg bg-slate-100 dark:bg-slate-800 cursor-pointer"},be=["disabled"],we={__name:"Chat",setup(me){L();const h=u([]),r=u(null),v=u([]),y=u(!1),w=u(!1),g=u(!1),C=u(""),c=u(""),i=u([]),V=async()=>{y.value=!0;const{data:a}=await b.get("/api/support/threads");h.value=a,y.value=!1},D=async a=>{r.value=a,w.value=!0;const{data:e}=await b.get(`/api/support/threads/${a.id}`);v.value=e.messages,w.value=!1},$=async()=>{if(!c.value.trim()&&!i.value.length)return;const a=new FormData;a.append("subject",C.value||""),a.append("message",c.value||""),i.value.forEach((s,n)=>a.append(`files[${n}]`,s)),g.value=!0;const{data:e}=await b.post("/api/support/threads",a,{headers:{"Content-Type":"multipart/form-data"}});g.value=!1,h.value.unshift(e),r.value=e,v.value=e.messages||[],C.value="",c.value="",i.value=[]},M=async()=>{if(!r.value)return $();if(r.value.status==="closed"){alert("–û–±—Ä–∞—â–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ. –ù–µ–ª—å–∑—è –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è.");return}if(!c.value.trim()&&!i.value.length)return;const a=new FormData;a.append("message",c.value||""),i.value.forEach((s,n)=>a.append(`files[${n}]`,s)),g.value=!0;const{data:e}=await b.post(`/api/support/threads/${r.value.id}/messages`,a,{headers:{"Content-Type":"multipart/form-data"}});g.value=!1,v.value.push(e),c.value="",i.value=[]},B=a=>{const e=Array.from(a.target.files||[]);i.value.push(...e),a.target.value=""},E=a=>{var s;const e=((s=a.clipboardData)==null?void 0:s.items)||[];for(const n of e)if(n.kind==="file"){const d=n.getAsFile();d&&d.type.startsWith("image/")&&(i.value.push(d),a.preventDefault())}},N=a=>{i.value.splice(a,1)};return S(V),(a,e)=>(l(),W(U,null,{header:F(()=>e[3]||(e[3]=[t("h2",{class:"text-2xl font-semibold text-slate-800 dark:text-slate-100"}," üõ† –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞ ",-1)])),default:F(()=>[A(P(z),{title:"–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞"}),t("div",Z,[t("div",q,[t("div",G,[e[4]||(e[4]=t("span",{class:"font-semibold"},"–î–∏–∞–ª–æ–≥–∏",-1)),t("button",{class:"text-xs px-2 py-1 rounded-lg bg-blue-600 text-white",onClick:e[0]||(e[0]=s=>{r.value=null,v.value=[]})}," –ù–æ–≤–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ ")]),t("div",I,[(l(!0),o(f,null,m(h.value,s=>(l(),o("div",{key:s.id,class:k(["p-2 rounded-xl cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800",r.value&&r.value.id===s.id?"bg-slate-100 dark:bg-slate-800":""]),onClick:n=>D(s)},[t("div",K,p(s.subject||"–ë–µ–∑ —Ç–µ–º—ã"),1),t("div",O,p(s.status==="closed"?"–ó–∞–∫—Ä—ã—Ç–æ":"–û—Ç–∫—Ä—ã—Ç–æ"),1)],10,J))),128)),!h.value.length&&!y.value?(l(),o("div",R," –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏–π. ")):x("",!0)])]),t("div",X,[t("div",Y,[t("div",null,[t("div",ee,p(r.value?r.value.subject||"–û–±—Ä–∞—â–µ–Ω–∏–µ":"–ù–æ–≤–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ"),1)])]),t("div",te,[!r.value&&!v.value.length?(l(),o("div",se,e[5]||(e[5]=[_(" –ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫—É. –í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ, –∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ‚Äî –≤—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ ",-1),t("strong",null,"Ctrl + V",-1),_(". ",-1)]))):x("",!0),(l(!0),o(f,null,m(v.value,s=>{var n;return l(),o("div",{key:s.id,class:k(["flex",s.is_support?"justify-end":"justify-start"])},[t("div",{class:k(["max-w-[75%] rounded-2xl px-3 py-2 text-sm shadow-sm",s.is_support?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-slate-100"])},[s.body?(l(),o("div",ae,p(s.body),1)):x("",!0),(n=s.attachments)!=null&&n.length?(l(),o("div",le,[(l(!0),o(f,null,m(s.attachments,d=>{var T,j;return l(),o("div",{key:d.id,class:"text-xs"},[(T=d.mime_type)!=null&&T.startsWith("image")?(l(),o("img",{key:0,src:`/storage/${d.path}`,class:"rounded-lg max-w-xs border"},null,8,oe)):(j=d.mime_type)!=null&&j.startsWith("video")?(l(),o("video",re,[t("source",{src:`/storage/${d.path}`},null,8,ne)])):(l(),o("a",{key:2,href:`/storage/${d.path}`,target:"_blank",class:"underline"}," üìé "+p(d.original_name),9,de))])}),128))])):x("",!0),t("div",ie,p(new Date(s.created_at).toLocaleTimeString()),1)],2)],2)}),128))]),!r.value||r.value.status!=="closed"?(l(),o("div",ue,[i.value.length?(l(),o("div",ce,[(l(!0),o(f,null,m(i.value,(s,n)=>(l(),o("div",{key:n,class:"flex items-center gap-1 px-2 py-1 rounded-lg bg-slate-100 dark:bg-slate-800 text-xs"},[t("span",pe,p(s.name),1),t("button",{onClick:d=>N(n),class:"text-red-500"},"√ó",8,ve)]))),128))])):x("",!0),H(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=s=>c.value=s),rows:"2",class:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 text-sm dark:bg-slate-800 dark:text-slate-100",placeholder:"–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...",onPaste:E},null,544),[[Q,c.value]]),t("div",xe,[t("div",ge,[t("label",he,[e[6]||(e[6]=_(" üìé –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å ",-1)),t("input",{type:"file",class:"hidden",multiple:"",onChange:B},null,32)]),e[7]||(e[7]=t("span",{class:"text-[11px] text-slate-400"},[_(" –ú–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–ª—è—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫–∏ –ø–æ "),t("b",null,"Ctrl + V")],-1))]),t("button",{class:"px-4 py-2 rounded-lg bg-blue-600 text-white text-sm hover:bg-blue-700 disabled:opacity-50",disabled:g.value,onClick:e[2]||(e[2]=s=>r.value?M():$())},p(r.value?"–û—Ç–ø—Ä–∞–≤–∏—Ç—å":"–°–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ"),9,be)])])):x("",!0)])])]),_:1}))}};export{we as default};
