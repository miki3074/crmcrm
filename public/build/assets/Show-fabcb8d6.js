import{r as w,o as d,f as i,b as e,t as o,e as k,j as n,v as p,s as m,F as b,x as v,N as j}from"./app-09c6da56.js";const _={class:"p-6"},V={class:"text-2xl font-bold mb-2"},F={class:"text-gray-600 mb-4"},U={class:"bg-white shadow rounded p-4 mb-6"},q={class:"grid grid-cols-2 gap-4"},D={class:"grid grid-cols-2 gap-4"},S=["value"],h=["value"],B={key:0,class:"space-y-2"},M={class:"font-medium"},N={class:"text-sm text-gray-500"},A={class:"text-sm"},E={class:"text-sm"},T={key:1,class:"text-gray-500"},L={__name:"Show",props:{subproject:Object,users:Array},setup(u){const x=u,s=w({title:"",priority:"low",start_date:"",due_date:"",executor_id:null,responsible_id:null,files:[]}),y=r=>{s.value.files=Array.from(r.target.files)},g=()=>{const r=new FormData;for(const t in s.value)t==="files"?s.value.files.forEach(a=>r.append("files[]",a)):r.append(t,s.value[t]??"");j.post(`/api/subprojects/${x.subproject.id}/tasks`,r,{forceFormData:!0,onSuccess:()=>{s.value={title:"",priority:"low",start_date:"",due_date:"",executor_id:null,responsible_id:null,files:[]}}})};return(r,t)=>{var a;return d(),i("div",_,[e("h1",V,o(u.subproject.title),1),e("p",F," Ответственный: "+o(((a=u.subproject.responsible)==null?void 0:a.name)??"не назначен"),1),e("div",U,[t[14]||(t[14]=e("h2",{class:"text-lg font-semibold mb-3"},"Добавить задачу",-1)),e("form",{onSubmit:k(g,["prevent"]),class:"space-y-3"},[e("div",null,[n(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.value.title=l),type:"text",placeholder:"Название задачи",class:"border p-2 rounded w-full",required:""},null,512),[[p,s.value.title]])]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium"},"Приоритет",-1)),n(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.priority=l),class:"border p-2 rounded w-full"},t[6]||(t[6]=[e("option",{value:"low"},"Низкий",-1),e("option",{value:"medium"},"Средний",-1),e("option",{value:"high"},"Высокий",-1)]),512),[[m,s.value.priority]])]),e("div",q,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium"},"Дата начала",-1)),n(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.value.start_date=l),type:"date",class:"border p-2 rounded w-full",required:""},null,512),[[p,s.value.start_date]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium"},"Дедлайн",-1)),n(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>s.value.due_date=l),type:"date",class:"border p-2 rounded w-full",required:""},null,512),[[p,s.value.due_date]])])]),e("div",D,[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium"},"Исполнитель",-1)),n(e("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.executor_id=l),class:"border p-2 rounded w-full",required:""},[(d(!0),i(b,null,v(u.users,l=>(d(),i("option",{key:l.id,value:l.id},o(l.name),9,S))),128))],512),[[m,s.value.executor_id]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium"},"Ответственный",-1)),n(e("select",{"onUpdate:modelValue":t[5]||(t[5]=l=>s.value.responsible_id=l),class:"border p-2 rounded w-full",required:""},[(d(!0),i(b,null,v(u.users,l=>(d(),i("option",{key:l.id,value:l.id},o(l.name),9,h))),128))],512),[[m,s.value.responsible_id]])])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium"},"Файлы",-1)),e("input",{type:"file",multiple:"",onChange:y},null,32)]),t[13]||(t[13]=e("button",{type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"}," Создать задачу ",-1))],32)]),e("div",null,[t[15]||(t[15]=e("h2",{class:"text-lg font-semibold mb-3"},"Задачи подпроекта",-1)),u.subproject.tasks.length?(d(),i("ul",B,[(d(!0),i(b,null,v(u.subproject.tasks,l=>{var f,c;return d(),i("li",{key:l.id,class:"border rounded p-3 bg-white shadow"},[e("h3",M,o(l.title),1),e("p",N," Исполнитель: "+o((f=l.executor)==null?void 0:f.name)+", Ответственный: "+o((c=l.responsible)==null?void 0:c.name),1),e("p",A,"Приоритет: "+o(l.priority),1),e("p",E,o(l.start_date)+" → "+o(l.due_date),1)])}),128))])):(d(),i("p",T,"Задач пока нет"))])])}}};export{L as default};
