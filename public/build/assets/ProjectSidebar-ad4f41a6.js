import{h as p,c as w,z as $,o as a,a as l,b as e,L as V,t as r,f as m,g as n,m as y,M as j,O as _,F as k,d as M,k as H}from"./app-c38d94e2.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";const S={class:"rounded-3xl border border-slate-100 bg-white dark:bg-slate-800 dark:border-slate-700 p-6 shadow-sm sticky top-6"},N={class:"space-y-4"},T={class:"flex items-start justify-between group"},D={class:"text-sm font-semibold text-slate-800 dark:text-slate-200 text-right truncate max-w-[150px]"},I={class:"flex items-start justify-between group"},P={class:"text-sm font-semibold text-slate-800 dark:text-slate-200 text-right truncate max-w-[150px]"},F={class:"flex items-start justify-between group"},R={class:"text-sm font-semibold text-slate-800 dark:text-slate-200"},A={class:"flex items-start justify-between group"},E={class:"text-sm font-bold text-emerald-600 dark:text-emerald-400"},O={class:"mt-6 pt-4 border-t border-slate-100 dark:border-slate-700"},U={class:"relative"},q={class:"text-sm text-slate-600 dark:text-slate-300 whitespace-pre-line leading-relaxed break-words"},G={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},J={class:"relative w-full max-w-2xl bg-white dark:bg-slate-800 rounded-2xl shadow-2xl flex flex-col max-h-[85vh] transform transition-all animate-in zoom-in-95 duration-200"},K={class:"px-6 py-4 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center bg-slate-50/50 dark:bg-slate-800"},Q={class:"p-6 overflow-y-auto custom-scrollbar"},W={class:"prose prose-sm prose-slate dark:prose-invert max-w-none whitespace-pre-line leading-relaxed"},X={class:"px-6 py-4 border-t border-slate-100 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 rounded-b-2xl flex justify-end"},Y={class:"mt-8"},Z={key:0,class:"ml-1 text-xs bg-white/20 px-2 py-0.5 rounded-full"},ee={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},te={class:"px-6 py-4 border-b flex justify-between items-center"},se={class:"p-6 overflow-y-auto space-y-6"},oe={key:0,class:"text-sm text-slate-400"},ae={key:1},le={class:"space-y-2"},re=["href"],ne={key:2},ie={class:"space-y-2"},de=["href"],ce={class:"text-slate-400 text-xs"},ue={class:"px-6 py-4 border-t flex justify-end"},C=150,xe={__name:"ProjectSidebar",props:["project"],setup(i){const v=i,u=p(!1),b=w(()=>v.project.description&&v.project.description.length>C),z=w(()=>{const o=v.project.description;return o?b.value?o.slice(0,C)+"...":o:"Нет описания"}),B=o=>o?Number(o).toLocaleString("ru-RU")+" ₽":"—",x=p(!1),d=p([]),c=p([]),h=(o,t=!1)=>t?`/subtasks/${o.id}`:`/tasks/${o.id}`;return $(async()=>{try{const{data:o}=await axios.get(`/api/projects/${v.project.id}/completed-tasks`);d.value=o.tasks.map(t=>({...t,link:h(t)})),c.value=o.subtasks.map(t=>({...t,link:h(t,!0)}))}catch(o){console.error("Ошибка загрузки завершенных задач:",o)}}),(o,t)=>{var f,g;return a(),l(k,null,[e("div",S,[t[15]||(t[15]=V('<div class="flex items-center gap-2 border-b border-slate-100 dark:border-slate-700 pb-4 mb-4" data-v-bcc3eeba><div class="p-2 bg-indigo-50 dark:bg-indigo-900/30 rounded-lg text-indigo-600 dark:text-indigo-400" data-v-bcc3eeba><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-bcc3eeba><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-bcc3eeba></path></svg></div><h3 class="font-bold text-slate-800 dark:text-white" data-v-bcc3eeba>Кратко о проекте</h3></div>',1)),e("div",N,[e("div",T,[t[9]||(t[9]=e("div",{class:"flex items-center gap-2 text-sm text-slate-500"},[e("svg",{class:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})]),e("span",null,"Компания")],-1)),e("span",D,r(((f=i.project.company)==null?void 0:f.name)||"—"),1)]),e("div",I,[t[10]||(t[10]=e("div",{class:"flex items-center gap-2 text-sm text-slate-500"},[e("svg",{class:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]),e("span",null,"Инициатор")],-1)),e("span",P,r(((g=i.project.initiator)==null?void 0:g.name)||"—"),1)]),e("div",F,[t[11]||(t[11]=e("div",{class:"flex items-center gap-2 text-sm text-slate-500"},[e("svg",{class:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",null,"Длительность")],-1)),e("span",R,r(i.project.duration_days)+" дн. ",1)]),e("div",A,[t[12]||(t[12]=e("div",{class:"flex items-center gap-2 text-sm text-slate-500"},[e("svg",{class:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})]),e("span",null,"Бюджет")],-1)),e("span",E,r(B(i.project.budget)),1)])]),e("div",O,[t[14]||(t[14]=e("div",{class:"flex items-center gap-2 mb-2"},[e("svg",{class:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h7"})]),e("span",{class:"text-xs font-bold text-slate-400 uppercase tracking-wider"},"Описание")],-1)),e("div",U,[e("p",q,r(z.value),1),b.value?(a(),l("button",{key:0,onClick:t[0]||(t[0]=s=>u.value=!0),class:"mt-2 text-xs font-bold text-indigo-600 hover:text-indigo-700 dark:text-indigo-400 dark:hover:text-indigo-300 flex items-center gap-1 transition-colors"},t[13]||(t[13]=[m(" Читать полностью ",-1),e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14 5l7 7m0 0l-7 7m7-7H3"})],-1)]))):n("",!0)])])]),y(_,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:j(()=>[u.value?(a(),l("div",G,[e("div",{class:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm",onClick:t[1]||(t[1]=s=>u.value=!1)}),e("div",J,[e("div",K,[t[17]||(t[17]=e("h3",{class:"font-bold text-lg text-slate-800 dark:text-white flex items-center gap-2"},[e("svg",{class:"w-5 h-5 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),m(" Описание проекта ")],-1)),e("button",{onClick:t[2]||(t[2]=s=>u.value=!1),class:"p-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-400 transition-colors"},t[16]||(t[16]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Q,[e("div",W,r(i.project.description),1)]),e("div",X,[e("button",{onClick:t[3]||(t[3]=s=>u.value=!1),class:"px-4 py-2 bg-white border border-slate-300 dark:bg-slate-700 dark:border-slate-600 text-slate-700 dark:text-white rounded-lg font-medium hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors shadow-sm"}," Закрыть ")])])])):n("",!0)]),_:1}),e("div",Y,[e("button",{onClick:t[4]||(t[4]=s=>x.value=!0),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-semibold transition shadow"},[t[18]||(t[18]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2l4-4M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1)),t[19]||(t[19]=m(" Завершённые задачи проекта ",-1)),d.value.length||c.value.length?(a(),l("span",Z,r(d.value.length+c.value.length),1)):n("",!0)])]),y(_,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:j(()=>[x.value?(a(),l("div",ee,[e("div",{class:"absolute inset-0 bg-slate-900/60",onClick:t[5]||(t[5]=s=>x.value=!1)}),e("div",{class:"relative w-full max-w-xl bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-h-[80vh] flex flex-col z-10",onClick:t[8]||(t[8]=H(()=>{},["stop"]))},[e("div",te,[t[20]||(t[20]=e("h3",{class:"font-bold text-lg"},"Завершённые задачи проекта",-1)),e("button",{onClick:t[6]||(t[6]=s=>x.value=!1),class:"text-slate-400 hover:text-slate-600"},"✕")]),e("div",se,[!d.value.length&&!c.value.length?(a(),l("div",oe," Пока нет завершённых задач ")):n("",!0),d.value.length?(a(),l("div",ae,[t[21]||(t[21]=e("h4",{class:"text-sm font-semibold mb-2"},"Задачи",-1)),e("ul",le,[(a(!0),l(k,null,M(d.value,s=>(a(),l("li",{key:s.id},[e("a",{href:s.link,class:"text-indigo-600 hover:underline"}," ✔ "+r(s.title),9,re)]))),128))])])):n("",!0),c.value.length?(a(),l("div",ne,[t[22]||(t[22]=e("h4",{class:"text-sm font-semibold mb-2"},"Подзадачи",-1)),e("ul",ie,[(a(!0),l(k,null,M(c.value,s=>(a(),l("li",{key:s.id},[e("a",{href:s.link,class:"text-emerald-600 hover:underline"},[m(" ✔ "+r(s.title)+" ",1),e("span",ce," ("+r(s.task&&s.task.title?s.task.title:"Без задачи")+") ",1)],8,de)]))),128))])])):n("",!0)]),e("div",ue,[e("button",{onClick:t[7]||(t[7]=s=>x.value=!1),class:"px-4 py-2 rounded-lg bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600"}," Закрыть ")])])])):n("",!0)]),_:1})],64)}}},me=L(xe,[["__scopeId","data-v-bcc3eeba"]]);export{me as default};
