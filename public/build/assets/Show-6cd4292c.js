import{r as y,q as z,I as qe,o as a,f as l,b as e,F as f,x as h,t as r,g as v,j,v as U,i as k,n as q,s as N,k as De,d as $,Q as Be,m as M,a as T,u as Ne,w as ze,Z as Le,y as Oe,e as Ae}from"./app-562a7a64.js";import{_ as Ee}from"./AuthenticatedLayout-df9aad9a.js";import"./ApplicationLogo-71dd096f.js";import"./_plugin-vue_export-helper-c27b6911.js";const He={class:"rounded-2xl border bg-white dark:bg-gray-800 p-5 mt-8"},Pe={class:"space-y-3 max-h-80 overflow-y-auto pr-1"},Qe={class:"flex-1"},Ze={class:"flex items-center gap-2"},Ge={class:"text-sm font-medium text-gray-900 dark:text-white"},Je={class:"text-xs text-gray-500"},Ke=["onClick"],Re={class:"mt-1 text-sm text-gray-800 dark:text-gray-200 whitespace-pre-wrap"},We={key:0,class:"text-sm text-gray-500"},Xe={key:0,class:"mt-4"},Ye={class:"mt-2 flex justify-end"},et=["disabled"],tt={key:1,class:"mt-3 text-xs text-gray-500"},st={__name:"TaskChat",props:{taskId:{type:Number,required:!0},canChat:{type:Boolean,default:!0}},setup(_){const C=_,c=y([]),p=y("");let b=null;const s=async()=>{const{data:x}=await k.get(`/api/tasks/${C.taskId}/comments`,{withCredentials:!0});c.value=x},w=async()=>{p.value.trim()&&(await k.get("/sanctum/csrf-cookie"),await k.post(`/api/tasks/${C.taskId}/comments`,{body:p.value},{withCredentials:!0}),p.value="",await s())},S=async x=>{await k.delete(`/api/task-comments/${x}`),await s()};return z(async()=>{await s(),b=setInterval(s,1e4)}),qe(()=>{b&&clearInterval(b)}),(x,g)=>(a(),l("div",He,[g[1]||(g[1]=e("div",{class:"mb-4 flex items-center justify-between"},[e("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Комментарии")],-1)),e("div",Pe,[(a(!0),l(f,null,h(c.value,i=>{var n;return a(),l("div",{key:i.id,class:"flex gap-3"},[e("div",Qe,[e("div",Ze,[e("div",Ge,r(((n=i.user)==null?void 0:n.name)??"—"),1),e("div",Je,r(new Date(i.created_at).toLocaleString()),1),x.$page.props.auth.user&&i.user&&i.user.id===x.$page.props.auth.user.id?(a(),l("button",{key:0,class:"ml-auto text-xs text-red-600 hover:underline",onClick:m=>S(i.id)},"Удалить",8,Ke)):v("",!0)]),e("div",Re,r(i.body),1)])])}),128)),c.value.length?v("",!0):(a(),l("div",We,"Пока нет сообщений."))]),_.canChat?(a(),l("div",Xe,[j(e("textarea",{"onUpdate:modelValue":g[0]||(g[0]=i=>p.value=i),rows:"2",placeholder:"Напишите комментарий…",class:"w-full rounded-lg border bg-white/80 dark:bg-gray-700 px-3 py-2 text-sm dark:text-white"},null,512),[[U,p.value]]),e("div",Ye,[e("button",{onClick:w,disabled:!p.value.trim(),class:"px-4 py-2 rounded-lg bg-indigo-600 text-white disabled:opacity-40"},"Отправить",8,et)])])):(a(),l("div",tt," У вас нет прав на участие в чате этой задачи. "))]))}},at={class:"mt-6"},lt={key:0,class:"space-y-2"},ot=["checked","onChange"],it={key:0,class:"text-sm text-gray-500"},dt={key:1,class:"text-gray-500"},rt={key:2,class:"fixed inset-0 bg-black/50 flex items-center justify-center"},nt={class:"bg-white rounded p-6 w-96"},ut=["value"],pt=["value"],gt=["value"],vt={class:"flex items-center gap-2 mb-2"},ct={class:"flex justify-end gap-2"},xt={__name:"TaskChecklists",props:{taskId:{type:Number,required:!0},executors:{type:Array,default:()=>[]},responsibles:{type:Array,default:()=>[]},creator:{type:Object,default:()=>null}},setup(_){const C=_,c=y([]),p=y(!1),b=y(!1),s=y({title:"",assigned_to:[],important:!1,files:[]}),w=async()=>{p.value=!0;try{const{data:g}=await k.get(`/api/tasks/${C.taskId}/checklists`);c.value=g}finally{p.value=!1}},S=async()=>{const g=new FormData;g.append("title",s.value.title),s.value.assigned_to&&g.append("assigned_to",s.value.assigned_to),g.append("important",s.value.important?1:0);for(let i of s.value.files)g.append("files[]",i);await k.post(`/api/tasks/${C.taskId}/checklists`,g),b.value=!1,s.value={title:"",assigned_to:"",important:!1,files:[]},await w()},x=async g=>{await k.patch(`/api/checklists/${g.id}/toggle`),await w()};return z(w),(g,i)=>(a(),l("div",at,[i[10]||(i[10]=e("h3",{class:"text-lg font-semibold mb-2"},"Чек-листы",-1)),c.value.length?(a(),l("ul",lt,[(a(!0),l(f,null,h(c.value,n=>(a(),l("li",{key:n.id,class:"flex items-center gap-2"},[e("input",{type:"checkbox",checked:n.completed,onChange:m=>x(n)},null,40,ot),e("span",{class:q({"font-bold text-red-600":n.important})},r(n.title),3),n.assignee?(a(),l("span",it,"("+r(n.assignee.name)+")",1)):v("",!0)]))),128))])):(a(),l("p",dt,"Нет чек-листов")),e("button",{class:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded",onClick:i[0]||(i[0]=n=>b.value=!0)}," Добавить чек-лист "),b.value?(a(),l("div",rt,[e("div",nt,[i[8]||(i[8]=e("h4",{class:"text-lg font-semibold mb-4"},"Новый пункт чек-листа",-1)),j(e("input",{"onUpdate:modelValue":i[1]||(i[1]=n=>s.value.title=n),type:"text",placeholder:"Название",class:"w-full border mb-2 p-2"},null,512),[[U,s.value.title]]),i[9]||(i[9]=e("label",{class:"block text-sm"},"Ответственный",-1)),j(e("select",{"onUpdate:modelValue":i[2]||(i[2]=n=>s.value.assigned_to=n),class:"w-full border mb-2 p-2"},[i[6]||(i[6]=e("option",{value:""},"—",-1)),(a(!0),l(f,null,h(_.executors,n=>(a(),l("option",{key:"exec-"+n.id,value:n.id},r(n.name),9,ut))),128)),(a(!0),l(f,null,h(_.responsibles,n=>(a(),l("option",{key:"resp-"+n.id,value:n.id},r(n.name),9,pt))),128)),_.creator?(a(),l("option",{key:0,value:_.creator.id},r(_.creator.name),9,gt)):v("",!0)],512),[[N,s.value.assigned_to]]),e("label",vt,[j(e("input",{type:"checkbox","onUpdate:modelValue":i[3]||(i[3]=n=>s.value.important=n)},null,512),[[De,s.value.important]]),i[7]||(i[7]=$(" Важно ",-1))]),e("input",{type:"file",multiple:"",onChange:i[4]||(i[4]=n=>s.value.files=Array.from(n.target.files)),class:"mb-4"},null,32),e("div",ct,[e("button",{onClick:i[5]||(i[5]=n=>b.value=!1),class:"px-3 py-1 border"},"Отмена"),e("button",{onClick:S,class:"px-3 py-1 bg-indigo-600 text-white"},"Сохранить")])])])):v("",!0)]))}},mt={class:"relative overflow-hidden"},yt={class:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 text-white"},bt={class:"flex items-start gap-4"},kt={class:"flex-1"},ft={class:"text-2xl sm:text-3xl font-semibold"},ht={class:"mt-2 flex flex-wrap items-center gap-2 text-sm"},_t={class:"px-2 py-1 rounded-full bg-white/20"},wt={class:"px-2 py-1 rounded-full bg-white/20"},$t={class:"px-2 py-1 rounded-full bg-white/20"},Ct={class:"px-2 py-1 rounded-full bg-white/20"},jt={class:"px-2 py-1 rounded-full bg-white/20"},St={class:"hidden sm:flex items-center gap-3"},Vt=["href"],It={key:0,class:"mt-3"},Mt={key:1,class:"text-xs text-amber-600 mt-2"},Ut={key:0},Ft={key:2,class:"text-sm mt-2 text-emerald-700"},Tt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-4 pb-10",style:{"margin-top":"3%"}},qt={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Dt={class:"lg:col-span-2 space-y-4"},Bt={class:"rounded-2xl border bg-white dark:bg-gray-800 p-5"},Nt={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},zt={class:"text-sm font-medium text-gray-900 dark:text-white"},Lt={class:"text-sm font-medium text-gray-900 dark:text-white"},Ot={class:"mt-2"},At={class:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},Et={class:"mt-1 text-xs text-gray-600 dark:text-gray-300"},Ht={class:"flex mt-3 gap-1"},Pt=["onClick","title"],Qt={class:"rounded-2xl border bg-white dark:bg-gray-800 p-5"},Zt={key:0,class:"flex items-center gap-2"},Gt={key:1,class:"mt-4 grid grid-cols-2 gap-2"},Jt={key:2,class:"mt-3"},Kt={key:0,class:"text-sm text-gray-600 dark:text-gray-300"},Rt={key:1,class:"flex flex-wrap gap-2"},Wt=["href"],Xt={class:"rounded-2xl border bg-white dark:bg-gray-800 p-5"},Yt={class:"flex items-center justify-between mb-3"},es={key:0,class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},ts={key:1,class:"text-sm text-gray-600 dark:text-gray-300"},ss={key:2,class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},as=["onClick"],ls={class:"flex items-start justify-between gap-3"},os={class:"text-base font-semibold text-gray-900 dark:text-white leading-snug"},is={class:"mt-2 text-sm text-gray-600 dark:text-gray-300 space-y-1.5"},ds={class:"space-y-4"},rs={class:"rounded-2xl border bg-white dark:bg-gray-800 p-5"},ns={class:"mt-3 space-y-2 text-sm text-gray-700 dark:text-gray-300"},us={class:"flex justify-between"},ps={class:"font-medium"},gs={class:"flex justify-between"},vs={class:"font-medium"},cs={class:"flex justify-between"},xs={class:"font-medium"},ms={class:"flex justify-between"},ys={class:"font-medium"},bs={class:"flex justify-between"},ks={class:"font-medium"},fs={class:"flex justify-between"},hs={key:0,class:"rounded-2xl border bg-white dark:bg-gray-800 p-5"},_s={key:0,class:"space-y-4"},ws={class:"rounded-2xl border bg-white dark:bg-gray-800 p-5"},$s={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},Cs={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},js={class:"relative w-full max-w-md bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6"},Ss={class:"flex items-center justify-between"},Vs={key:0,class:"mt-3 text-sm text-rose-600"},Is=["value"],Ms=["value"],Us={class:"grid grid-cols-2 gap-4"},Fs={class:"flex justify-end gap-2"},Ts=["disabled"],qs={key:0},Ds={key:1},Os={__name:"Show",setup(_){var E;const{props:C}=Be(),c=C.id,p=(E=C.auth)==null?void 0:E.user,b=y(!0),s=y(null),w=y(!1),S=y(""),x=y(null),g=d=>{x.value=d.target.files},i=y(!1),n=y([]),m=y({title:"",executor_id:"",responsible_id:"",start_date:new Date().toISOString().slice(0,10),due_date:""}),Ce=M(()=>{var d;return!s.value||!p?!1:(s.value.responsibles||[]).some(t=>t.id===p.id)||(((d=s.value.project)==null?void 0:d.managers)||[]).some(t=>t.id===p.id)}),L=d=>d==="high"?"bg-rose-100 text-rose-700 ring-1 ring-rose-200":d==="medium"?"bg-amber-100 text-amber-700 ring-1 ring-amber-200":"bg-emerald-100 text-emerald-700 ring-1 ring-emerald-200",O=d=>d==="high"?"Высокая":d==="medium"?"Средняя":"Обычная",D=async()=>{b.value=!0;try{const{data:d}=await k.get(`/api/tasks/${c}`);s.value=d}finally{b.value=!1}},je=async d=>{try{const{data:t}=await k.patch(`/api/tasks/${c}/progress`,{progress:d});s.value.progress=t.progress}catch{alert("Недостаточно прав для обновления прогресса.")}},Se=async()=>{var t;if(!((t=x.value)!=null&&t.length))return alert("Выберите файлы");const d=new FormData;for(let u=0;u<x.value.length;u++)d.append("files[]",x.value[u]);try{await k.post(`/api/tasks/${c}/files`,d,{headers:{"Content-Type":"multipart/form-data"}}),x.value=null,await D()}catch{alert("Ошибка при загрузке файлов")}},Ve=async()=>{const{data:d}=await k.get(`/api/projects/${s.value.project.id}/employees`);n.value=d,i.value=!0},Ie=async()=>{var d,t;w.value=!0,S.value="";try{await k.post(`/api/tasks/${c}/subtasks`,{...m.value,task_id:c}),i.value=!1,m.value={title:"",executor_id:"",responsible_id:"",start_date:new Date().toISOString().slice(0,10),due_date:""},await D()}catch(u){S.value=((t=(d=u==null?void 0:u.response)==null?void 0:d.data)==null?void 0:t.message)||"Ошибка при создании подзадачи"}finally{w.value=!1}},A=M(()=>{var d;return(((d=s.value)==null?void 0:d.subtasks)||[]).some(t=>!t.completed)}),Me=M(()=>{var d,t;return((d=s.value)==null?void 0:d.progress)===100&&!((t=s.value)!=null&&t.completed)&&!A.value}),Ue=async()=>{var d,t;try{const{data:u}=await k.patch(`/api/tasks/${c}/complete`);s.value=u.task}catch(u){const V=((t=(d=u==null?void 0:u.response)==null?void 0:d.data)==null?void 0:t.message)||"Не удалось завершить задачу";alert(V)}},Fe=M(()=>{var t,u;const d=(u=(t=C.auth)==null?void 0:t.user)==null?void 0:u.id;return!d||!s.value?!1:(s.value.executors||[]).some(V=>V.id===d)||(s.value.responsibles||[]).some(V=>V.id===d)}),Te=M(()=>{var d,t;return!s.value||!p?!1:(s.value.executors||[]).some(u=>u.id===p.id)||(s.value.responsibles||[]).some(u=>u.id===p.id)||p.id===((t=(d=s.value.project)==null?void 0:d.company)==null?void 0:t.user_id)});return z(D),(d,t)=>{var u;return a(),l(f,null,[T(Ne(Le),{title:(u=s.value)!=null&&u.title?`Задача — ${s.value.title}`:"Задача"},null,8,["title"]),T(Ee,null,{default:ze(()=>{var V,H,P,Q,Z,G,J,K,R,W,X,Y,ee,te,se,ae,le,oe,ie,de,re,ne,ue,pe,ge,ve,ce,xe,me,ye,be,ke,fe,he,_e,we,$e;return[e("div",mt,[t[14]||(t[14]=e("div",{class:"absolute inset-0 bg-gradient-to-r from-sky-600 via-indigo-600 to-fuchsia-600 opacity-90"},null,-1)),e("div",yt,[e("div",bt,[e("div",kt,[e("h1",ft,r(((V=s.value)==null?void 0:V.title)??"Загрузка…"),1),e("div",ht,[e("span",_t,[t[8]||(t[8]=$(" Проект: ",-1)),e("b",null,r(((P=(H=s.value)==null?void 0:H.project)==null?void 0:P.name)??"—"),1)]),e("span",wt,[t[9]||(t[9]=$(" Компания: ",-1)),e("b",null,r(((G=(Z=(Q=s.value)==null?void 0:Q.project)==null?void 0:Z.company)==null?void 0:G.name)??"—"),1)]),e("span",$t,[t[10]||(t[10]=$(" От: ",-1)),e("b",null,r(((K=(J=s.value)==null?void 0:J.creator)==null?void 0:K.name)??"—"),1)]),e("span",Ct,[t[11]||(t[11]=$(" Кому: ",-1)),e("b",null,r((W=(R=s.value)==null?void 0:R.executors)!=null&&W.length?s.value.executors.map(o=>o.name).join(", "):"—"),1)]),e("span",jt,[t[12]||(t[12]=$(" Ответственный: ",-1)),e("b",null,r((Y=(X=s.value)==null?void 0:X.responsibles)!=null&&Y.length?s.value.responsibles.map(o=>o.name).join(", "):"—"),1)]),s.value?(a(),l("span",{key:0,class:q(["px-2 py-1 rounded-full ring-1 bg-white text-gray-900",L(s.value.priority)])},[t[13]||(t[13]=$(" Приоритет: ",-1)),e("b",null,r(O(s.value.priority)),1)],2)):v("",!0)])]),e("div",St,[(te=(ee=s.value)==null?void 0:ee.project)!=null&&te.id?(a(),l("a",{key:0,href:`/projects/${s.value.project.id}`,class:"rounded-xl bg-white text-gray-900 hover:bg-white/90 px-4 py-2 font-medium"}," К проекту ",8,Vt)):v("",!0)]),Fe.value?(a(),l("div",It,[Me.value?(a(),l("button",{key:0,onClick:Ue,class:"px-4 py-2 rounded bg-emerald-600 text-white hover:bg-emerald-700",title:"Завершить задачу"}," Завершить задачу ")):((se=s.value)==null?void 0:se.progress)===100&&!((ae=s.value)!=null&&ae.completed)?(a(),l("div",Mt,[A.value?(a(),l("span",Ut," Есть незавершённые подзадачи — завершите их, чтобы закрыть задачу. ")):v("",!0)])):v("",!0),(le=s.value)!=null&&le.completed?(a(),l("div",Ft," Завершена "+r(((oe=s.value)==null?void 0:oe.completed_at)||""),1)):v("",!0)])):v("",!0)])])]),e("div",Tt,[e("div",qt,[e("div",Dt,[e("div",Bt,[e("div",Nt,[e("div",null,[t[15]||(t[15]=e("div",{class:"text-xs text-gray-500"},"Дата начала",-1)),e("div",zt,r(((ie=s.value)==null?void 0:ie.start_date)??"—"),1)]),e("div",null,[t[16]||(t[16]=e("div",{class:"text-xs text-gray-500"},"Дата окончания",-1)),e("div",Lt,r(((de=s.value)==null?void 0:de.due_date)??"—"),1)]),e("div",null,[t[17]||(t[17]=e("div",{class:"text-xs text-gray-500"},"Прогресс",-1)),e("div",Ot,[e("div",At,[e("div",{class:"h-2 bg-emerald-500",style:Oe({width:(((re=s.value)==null?void 0:re.progress)||0)+"%"})},null,4)]),e("div",Et,"Выполнено "+r(((ne=s.value)==null?void 0:ne.progress)??0)+"%",1)]),e("div",Ht,[(a(),l(f,null,h(11,o=>{var I;return e("button",{key:o,onClick:B=>je((o-1)*10),class:q(["flex-1 h-5 rounded bg-gray-200 dark:bg-gray-700 hover:bg-gray-300",{"!bg-emerald-500":(((I=s.value)==null?void 0:I.progress)||0)>=(o-1)*10}]),title:`${(o-1)*10}%`},null,10,Pt)}),64))])])])]),e("div",Qt,[Te.value?(a(),l("div",Zt,[e("input",{type:"file",multiple:"",onChange:g,accept:".pdf,.doc,.docx,.xls,.xlsx",class:"text-sm text-gray-600 dark:text-gray-300"},null,32),e("button",{onClick:Se,class:"rounded-xl bg-indigo-600 text-white px-4 py-2 hover:bg-indigo-700"}," Загрузить ")])):v("",!0),b.value?(a(),l("div",Gt,[(a(),l(f,null,h(4,o=>e("div",{key:o,class:"h-8 rounded-lg bg-gray-200 dark:bg-gray-700 animate-pulse"})),64))])):(a(),l("div",Jt,[(pe=(ue=s.value)==null?void 0:ue.files)!=null&&pe.length?(a(),l("div",Rt,[(a(!0),l(f,null,h(s.value.files,o=>(a(),l("a",{key:o.id,href:`/storage/${o.file_path}`,target:"_blank",class:"inline-flex items-center gap-1 text-xs px-2 py-1 rounded-full bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-100"},[t[18]||(t[18]=e("svg",{class:"w-3.5 h-3.5",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12V8l-4-6zM6 22V4h7v5h5v13H6z"})],-1)),$(" "+r(o.file_path.split("/").pop()),1)],8,Wt))),128))])):(a(),l("div",Kt," Файлы не прикреплены. "))]))]),e("div",Xt,[e("div",Yt,[t[19]||(t[19]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Подзадачи",-1)),Ce.value?(a(),l("button",{key:0,onClick:Ve,class:"rounded-xl bg-emerald-600 text-white px-4 py-2 hover:bg-emerald-700"}," + Подзадача ")):v("",!0)]),b.value?(a(),l("div",es,[(a(),l(f,null,h(4,o=>e("div",{key:o,class:"rounded-xl border p-4 animate-pulse"},t[20]||(t[20]=[e("div",{class:"h-4 w-1/2 bg-gray-200 dark:bg-gray-700 rounded mb-3"},null,-1),e("div",{class:"h-3 w-2/3 bg-gray-200 dark:bg-gray-700 rounded mb-2"},null,-1),e("div",{class:"h-3 w-1/2 bg-gray-200 dark:bg-gray-700 rounded"},null,-1)]))),64))])):(ve=(ge=s.value)==null?void 0:ge.subtasks)!=null&&ve.length?(a(),l("div",ss,[(a(!0),l(f,null,h(s.value.subtasks,o=>{var I,B;return a(),l("div",{key:o.id,class:"group rounded-xl border p-4 bg-white dark:bg-gray-800 hover:shadow-md transition cursor-pointer",onClick:F=>d.$inertia.visit(`/subtasks/${o.id}`)},[e("div",ls,[e("h3",os,r(o.title),1)]),e("div",is,[e("div",null,[t[21]||(t[21]=$(" Исполнитель: ",-1)),e("b",null,r(((I=o.executors)==null?void 0:I.map(F=>F.name).join(", "))||"—"),1)]),e("div",null,[t[22]||(t[22]=$(" Ответсвенный: ",-1)),e("b",null,r(((B=o.responsibles)==null?void 0:B.map(F=>F.name).join(", "))||"—"),1)]),e("div",null,"Сроки: "+r(o.start_date)+" — "+r(o.due_date),1)])],8,as)}),128))])):(a(),l("div",ts," Подзадач пока нет. "))])]),e("div",ds,[e("div",rs,[t[29]||(t[29]=e("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Кратко о задаче",-1)),e("dl",ns,[e("div",us,[t[23]||(t[23]=e("dt",null,"Автор",-1)),e("dd",ps,r(((xe=(ce=s.value)==null?void 0:ce.creator)==null?void 0:xe.name)??"—"),1)]),e("div",gs,[t[24]||(t[24]=e("dt",null,"Исполнитель",-1)),e("dd",vs,r((ye=(me=s.value)==null?void 0:me.executors)!=null&&ye.length?s.value.executors.map(o=>o.name).join(", "):"—"),1)]),e("div",cs,[t[25]||(t[25]=e("dt",null,"Ответственный",-1)),e("dd",xs,r((ke=(be=s.value)==null?void 0:be.responsibles)!=null&&ke.length?s.value.responsibles.map(o=>o.name).join(", "):"—"),1)]),e("div",ms,[t[26]||(t[26]=e("dt",null,"Проект",-1)),e("dd",ys,r(((he=(fe=s.value)==null?void 0:fe.project)==null?void 0:he.name)??"—"),1)]),e("div",bs,[t[27]||(t[27]=e("dt",null,"Компания",-1)),e("dd",ks,r((($e=(we=(_e=s.value)==null?void 0:_e.project)==null?void 0:we.company)==null?void 0:$e.name)??"—"),1)]),e("div",fs,[t[28]||(t[28]=e("dt",null,"Приоритет",-1)),e("dd",null,[s.value?(a(),l("span",{key:0,class:q(["px-2 py-1 text-xs rounded-full ring-1",L(s.value.priority)])},r(O(s.value.priority)),3)):v("",!0)])])])]),s.value?(a(),l("div",hs,[T(xt,{"task-id":s.value.id,executors:s.value.executors,responsibles:s.value.responsibles,creator:s.value.creator},null,8,["task-id","executors","responsibles","creator"])])):v("",!0)]),s.value?(a(),l("div",_s,[e("div",ws,[t[30]||(t[30]=e("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Чат",-1)),T(st,{"task-id":s.value.id,"can-chat":!0},null,8,["task-id"])])])):(a(),l("div",$s,"Загрузка…"))])]),i.value?(a(),l("div",Cs,[e("div",{class:"absolute inset-0 bg-black/50",onClick:t[0]||(t[0]=o=>i.value=!1)}),e("div",js,[e("div",Ss,[t[31]||(t[31]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Новая подзадача",-1)),e("button",{onClick:t[1]||(t[1]=o=>i.value=!1),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200"},"✕")]),S.value?(a(),l("p",Vs,r(S.value),1)):v("",!0),e("form",{class:"mt-4 space-y-4",onSubmit:Ae(Ie,["prevent"])},[e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm mb-1 text-gray-700 dark:text-gray-300"},"Название",-1)),j(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>m.value.title=o),class:"w-full rounded-xl border px-3 py-2 bg-white dark:bg-gray-700 dark:text-white",required:""},null,512),[[U,m.value.title]])]),e("div",null,[t[34]||(t[34]=e("label",{class:"block text-sm mb-1 text-gray-700 dark:text-gray-300"},"Исполнитель",-1)),j(e("select",{"onUpdate:modelValue":t[3]||(t[3]=o=>m.value.executor_id=o),class:"w-full rounded-xl border px-3 py-2 bg-white dark:bg-gray-700 dark:text-white",required:""},[t[33]||(t[33]=e("option",{disabled:"",value:""},"Выберите сотрудника",-1)),(a(!0),l(f,null,h(n.value,o=>(a(),l("option",{key:o.id,value:o.id},r(o.name),9,Is))),128))],512),[[N,m.value.executor_id]])]),e("div",null,[t[36]||(t[36]=e("label",{class:"block text-sm mb-1 text-gray-700 dark:text-gray-300"},"Ответственный",-1)),j(e("select",{"onUpdate:modelValue":t[4]||(t[4]=o=>m.value.responsible_id=o),class:"w-full rounded-xl border px-3 py-2 bg-white dark:bg-gray-700 dark:text-white",required:""},[t[35]||(t[35]=e("option",{disabled:"",value:""},"Выберите сотрудника",-1)),(a(!0),l(f,null,h(n.value,o=>(a(),l("option",{key:o.id,value:o.id},r(o.name),9,Ms))),128))],512),[[N,m.value.responsible_id]])]),e("div",Us,[e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm mb-1 text-gray-700 dark:text-gray-300"},"Начало",-1)),j(e("input",{type:"date","onUpdate:modelValue":t[5]||(t[5]=o=>m.value.start_date=o),class:"w-full rounded-xl border px-3 py-2 bg-white dark:bg-gray-700 dark:text-white",required:""},null,512),[[U,m.value.start_date]])]),e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm mb-1 text-gray-700 dark:text-gray-300"},"Окончание",-1)),j(e("input",{type:"date","onUpdate:modelValue":t[6]||(t[6]=o=>m.value.due_date=o),class:"w-full rounded-xl border px-3 py-2 bg-white dark:bg-gray-700 dark:text-white",required:""},null,512),[[U,m.value.due_date]])])]),e("div",Fs,[e("button",{type:"button",onClick:t[7]||(t[7]=o=>i.value=!1),class:"px-4 py-2 rounded-xl border bg-white dark:bg-gray-700 dark:text-white"},"Отмена"),e("button",{type:"submit",disabled:w.value,class:"px-4 py-2 rounded-xl bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-60"},[w.value?(a(),l("span",Ds,"Сохраняю…")):(a(),l("span",qs,"Создать"))],8,Ts)])],32)])])):v("",!0)]}),_:1})],64)}}};export{Os as default};
