import{Q as D,r as d,z as F,m as U,q as T,o as a,f as o,a as q,u as L,w as E,F as u,i as k,Z as O,b as l,x as r,n as j,t as p,e as Q,j as i,v,k as I,s as y,g as C}from"./app-7fb329a1.js";import{_ as Z}from"./AuthenticatedLayout-ec93dfd8.js";import{_ as A}from"./_plugin-vue_export-helper-c27b6911.js";import"./ApplicationLogo-8a711471.js";const G={class:"max-w-7xl mx-auto p-6 space-y-6"},H={class:"mt-8"},J={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},K=["onClick"],R={class:"flex items-center gap-3 mb-2"},W={class:"font-bold text-lg text-slate-700 dark:text-slate-100"},X={key:1,class:"text-slate-400 text-sm"},Y={class:"mt-12"},ee={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},te=["onClick"],le={class:"flex items-center gap-3 mb-2"},se={class:"font-bold text-lg text-slate-700 dark:text-slate-100"},ae={key:1,class:"text-slate-400 text-sm"},oe={key:0,class:"fixed inset-0 bg-black/50 flex justify-center items-center z-50 px-4"},ne={class:"bg-white dark:bg-slate-900 p-6 rounded-2xl shadow-xl w-full max-w-lg relative"},ie={class:"flex mb-4 border-b border-slate-300 dark:border-slate-700"},ue={class:"flex items-center gap-2"},de={key:0,class:"space-y-2"},re=["label"],pe=["value"],ve=["value"],me={key:0,class:"text-xs text-slate-400 mt-1"},be={key:1},xe=["value"],ye={class:"flex items-center gap-2"},ce={key:0,class:"space-y-2"},fe=["label"],ke=["value"],ge=["value"],_e={key:0,class:"text-xs text-slate-400 mt-1"},we={key:1},je=["value"],he={class:"flex justify-end gap-2 pt-3 border-t border-slate-200 dark:border-slate-700 mt-4"},Ve={__name:"Index",setup(Ue){const{props:h}=D(),V=d([]),g=d(!1),x=d("jur"),b=d(!1),_=d([]),s=d({type:"jur",name:"",organization_name:"",description:"",city:"",address:"",phone:"",email:"",project_id:null,responsible_id:null,company_id:null});d([]);const c=d([]),f=d([]),w=d(!1),$=async()=>{const{data:n}=await k.get("/api/clients");V.value=n},S=async()=>{const{data:n}=await k.get("api/projects/grouped");_.value=n},B=async()=>{const{data:n}=await k.get("/api/employeesqw");c.value=n,f.value=n};F(()=>s.value.project_id,async n=>{if(s.value.responsible_id=null,!b.value||!n){f.value=c.value;return}const t=_.value.flatMap(e=>e.projects).find(e=>e.id===n);if(!(t!=null&&t.company_id)){f.value=[];return}w.value=!0;try{const{data:e}=await k.get(`/api/companies/${t.company_id}/employees`);f.value=e}catch(e){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð² ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸:",e)}finally{w.value=!1}});const N=async()=>{const n={...s.value,type:x.value};await k.post("/api/clients",n),g.value=!1,s.value={type:x.value,name:"",organization_name:"",description:"",city:"",address:"",phone:"",email:"",project_id:null,responsible_id:null,company_id:null},b.value=!1,await $()},z=U(()=>V.value.filter(n=>n.created_by===h.auth.user.id)),M=U(()=>V.value.filter(n=>n.responsible_id===h.auth.user.id&&n.created_by!==h.auth.user.id)),P=U(()=>{const n=new Set;return c.value.filter(t=>n.has(t.id)?!1:(n.add(t.id),!0))});return T(async()=>{await Promise.all([$(),S(),B()])}),(n,t)=>(a(),o(u,null,[q(L(O),{title:"ÐšÐ»Ð¸ÐµÐ½Ñ‚Ñ‹"}),q(Z,null,{header:E(()=>t[22]||(t[22]=[l("h2",{class:"font-semibold text-xl text-slate-700 dark:text-slate-200"},"ÐšÐ»Ð¸ÐµÐ½Ñ‚Ñ‹",-1)])),default:E(()=>[l("div",G,[l("button",{onClick:t[0]||(t[0]=e=>g.value=!0),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-xl font-semibold shadow"}," âž• ÐÐ¾Ð²Ñ‹Ð¹ ÐºÐ»Ð¸ÐµÐ½Ñ‚ "),l("div",H,[t[23]||(t[23]=l("h2",{class:"text-xl font-semibold text-slate-700 dark:text-slate-200 mb-4"}," ðŸ‘¤ ÐšÐ»Ð¸ÐµÐ½Ñ‚Ñ‹ ",-1)),z.value.length?(a(),o("div",J,[(a(!0),o(u,null,r(z.value,e=>(a(),o("div",{key:e.id,class:"p-4 bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm hover:shadow-md cursor-pointer transition",onClick:m=>n.$inertia.visit(`/clients/${e.id}`)},[l("div",R,[l("span",{class:j(["px-3 py-1 text-xs rounded-full",e.type==="jur"?"bg-blue-100 text-blue-700":"bg-emerald-100 text-emerald-700"])},p(e.type==="jur"?"Ð®Ñ€Ð¸Ð´Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð»Ð¸Ñ†Ð¾":"Ð¤Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð»Ð¸Ñ†Ð¾"),3)]),l("h3",W,p(e.name),1)],8,K))),128))])):(a(),o("p",X,"ÐÐµÑ‚ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð², ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð²Ñ‹ ÑÐ¾Ð·Ð´Ð°Ð»Ð¸."))]),l("div",Y,[t[24]||(t[24]=l("h2",{class:"text-xl font-semibold text-slate-700 dark:text-slate-200 mb-4"}," ðŸ’¼ ÐšÐ»Ð¸ÐµÐ½Ñ‚Ñ‹, Ð³Ð´Ðµ Ñ Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ ",-1)),M.value.length?(a(),o("div",ee,[(a(!0),o(u,null,r(M.value,e=>(a(),o("div",{key:e.id,class:"p-4 bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm hover:shadow-md cursor-pointer transition",onClick:m=>n.$inertia.visit(`/clients/${e.id}`)},[l("div",le,[l("span",{class:j(["px-3 py-1 text-xs rounded-full",e.type==="jur"?"bg-blue-100 text-blue-700":"bg-emerald-100 text-emerald-700"])},p(e.type==="jur"?"Ð®Ñ€Ð¸Ð´Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð»Ð¸Ñ†Ð¾":"Ð¤Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð»Ð¸Ñ†Ð¾"),3)]),l("h3",se,p(e.name),1)],8,te))),128))])):(a(),o("p",ae,"ÐÐµÑ‚ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð², Ð³Ð´Ðµ Ð²Ñ‹ Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹."))])]),g.value?(a(),o("div",oe,[l("div",ne,[t[34]||(t[34]=l("h2",{class:"text-xl font-bold mb-4 text-slate-800 dark:text-white"},"âž• ÐÐ¾Ð²Ñ‹Ð¹ ÐºÐ»Ð¸ÐµÐ½Ñ‚",-1)),l("div",ie,[l("button",{onClick:t[1]||(t[1]=e=>x.value="jur"),class:j(["flex-1 py-2 font-medium",x.value==="jur"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700"])}," Ð®Ñ€. Ð»Ð¸Ñ†Ð¾ ",2),l("button",{onClick:t[2]||(t[2]=e=>x.value="fiz"),class:j(["flex-1 py-2 font-medium",x.value==="fiz"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700"])}," Ð¤Ð¸Ð·. Ð»Ð¸Ñ†Ð¾ ",2)]),l("form",{onSubmit:Q(N,["prevent"]),class:"space-y-3 max-h-[70vh] overflow-y-auto pr-2"},[x.value==="jur"?(a(),o(u,{key:0},[i(l("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>s.value.organization_name=e),placeholder:"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¸ *",class:"input",required:""},null,512),[[v,s.value.organization_name]]),i(l("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>s.value.name=e),placeholder:"Ð¤Ð˜Ðž ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð½Ð¾Ð³Ð¾ Ð»Ð¸Ñ†Ð° *",class:"input",required:""},null,512),[[v,s.value.name]]),i(l("textarea",{"onUpdate:modelValue":t[5]||(t[5]=e=>s.value.description=e),placeholder:"ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ",class:"input"},null,512),[[v,s.value.description]]),l("div",ue,[t[25]||(t[25]=l("label",{class:"text-sm text-slate-600 dark:text-slate-400"},"ÐšÐ»Ð¸ÐµÐ½Ñ‚ Ð² Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ?",-1)),i(l("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>b.value=e)},null,512),[[I,b.value]])]),b.value?(a(),o("div",de,[i(l("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>s.value.project_id=e),class:"input"},[t[26]||(t[26]=l("option",{value:""},"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚",-1)),(a(!0),o(u,null,r(_.value,e=>(a(),o("optgroup",{key:e.id,label:e.name},[(a(!0),o(u,null,r(e.projects,m=>(a(),o("option",{key:m.id,value:m.id},p(m.name),9,pe))),128))],8,re))),128))],512),[[y,s.value.project_id]]),i(l("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>s.value.responsible_id=e),class:"input"},[t[27]||(t[27]=l("option",{value:""},"ÐžÑ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹",-1)),(a(!0),o(u,null,r(P.value,e=>(a(),o("option",{key:e.id,value:e.id},p(e.name),9,ve))),128))],512),[[y,s.value.responsible_id]]),w.value?(a(),o("div",me,"Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²â€¦")):C("",!0)])):(a(),o("div",be,[i(l("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>s.value.responsible_id=e),class:"input"},[t[28]||(t[28]=l("option",{value:""},"ÐžÑ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹",-1)),(a(!0),o(u,null,r(c.value,e=>(a(),o("option",{key:e.id,value:e.id},p(e.name),9,xe))),128))],512),[[y,s.value.responsible_id]])])),i(l("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>s.value.city=e),placeholder:"Ð“Ð¾Ñ€Ð¾Ð´",class:"input"},null,512),[[v,s.value.city]]),i(l("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>s.value.address=e),placeholder:"ÐÐ´Ñ€ÐµÑ",class:"input"},null,512),[[v,s.value.address]]),i(l("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>s.value.email=e),placeholder:"Email",type:"email",class:"input"},null,512),[[v,s.value.email]]),i(l("input",{"onUpdate:modelValue":t[13]||(t[13]=e=>s.value.phone=e),placeholder:"Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½",class:"input"},null,512),[[v,s.value.phone]])],64)):(a(),o(u,{key:1},[i(l("input",{"onUpdate:modelValue":t[14]||(t[14]=e=>s.value.name=e),placeholder:"Ð¤Ð˜Ðž *",class:"input",required:""},null,512),[[v,s.value.name]]),i(l("input",{"onUpdate:modelValue":t[15]||(t[15]=e=>s.value.phone=e),placeholder:"Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½",class:"input"},null,512),[[v,s.value.phone]]),i(l("input",{"onUpdate:modelValue":t[16]||(t[16]=e=>s.value.email=e),placeholder:"Email",type:"email",class:"input"},null,512),[[v,s.value.email]]),l("div",ye,[t[29]||(t[29]=l("label",{class:"text-sm text-slate-600 dark:text-slate-400"},"ÐšÐ»Ð¸ÐµÐ½Ñ‚ Ð² Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ?",-1)),i(l("input",{type:"checkbox","onUpdate:modelValue":t[17]||(t[17]=e=>b.value=e)},null,512),[[I,b.value]])]),b.value?(a(),o("div",ce,[i(l("select",{"onUpdate:modelValue":t[18]||(t[18]=e=>s.value.project_id=e),class:"input"},[t[30]||(t[30]=l("option",{value:""},"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚",-1)),(a(!0),o(u,null,r(_.value,e=>(a(),o("optgroup",{key:e.id,label:e.name},[(a(!0),o(u,null,r(e.projects,m=>(a(),o("option",{key:m.id,value:m.id},p(m.name),9,ke))),128))],8,fe))),128))],512),[[y,s.value.project_id]]),i(l("select",{"onUpdate:modelValue":t[19]||(t[19]=e=>s.value.responsible_id=e),class:"input"},[t[31]||(t[31]=l("option",{value:""},"ÐžÑ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹",-1)),(a(!0),o(u,null,r(f.value,e=>(a(),o("option",{key:e.id,value:e.id},p(e.name),9,ge))),128))],512),[[y,s.value.responsible_id]]),w.value?(a(),o("div",_e,"Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²â€¦")):C("",!0)])):(a(),o("div",we,[i(l("select",{"onUpdate:modelValue":t[20]||(t[20]=e=>s.value.responsible_id=e),class:"input"},[t[32]||(t[32]=l("option",{value:""},"ÐžÑ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹",-1)),(a(!0),o(u,null,r(c.value,e=>(a(),o("option",{key:e.id,value:e.id},p(e.name),9,je))),128))],512),[[y,s.value.responsible_id]])]))],64)),l("div",he,[l("button",{type:"button",onClick:t[21]||(t[21]=e=>g.value=!1),class:"btn-gray"}," ÐžÑ‚Ð¼ÐµÐ½Ð° "),t[33]||(t[33]=l("button",{type:"submit",class:"btn-green"}," ðŸ’¾ Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ ",-1))])],32)])])):C("",!0)]),_:1})],64))}},qe=A(Ve,[["__scopeId","data-v-acf757db"]]);export{qe as default};
