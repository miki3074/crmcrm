import{j as w,P as z,o as s,G as L,J as N,a as e,t as r,E as b,c as i,b as m,d as l,h as y,v as f,u as c,e as V,F as $,N as k}from"./app-0c17e5ad.js";import{_ as j}from"./AuthenticatedLayout-e4f4bca7.js";import"./ApplicationLogo-792ed34e.js";import"./_plugin-vue_export-helper-c27b6911.js";const F={class:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},P={class:"bg-white shadow sm:rounded-lg mb-6 p-6"},T={class:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4"},A={class:"text-2xl font-bold text-gray-900"},D={class:"text-gray-500"},E={key:0,class:"flex gap-3"},U={key:2,class:"text-sm text-gray-500 italic border p-2 rounded"},G={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},H={class:"md:col-span-2 space-y-6"},J={class:"bg-white shadow sm:rounded-lg p-6"},O={key:0},R={key:1,class:"prose bg-gray-50 p-4 rounded"},q={class:"bg-white shadow sm:rounded-lg p-6"},I={key:0},K={key:1},Q={class:"prose bg-gray-50 p-4 rounded whitespace-pre-line"},W={key:0,class:"mt-4"},X={class:"md:col-span-1 space-y-6"},Y={key:0},Z={class:"flex gap-2"},ee={key:1},te={class:"text-sm"},se={class:"bg-white shadow sm:rounded-lg p-6"},ne={class:"space-y-3"},ie={class:"text-sm text-gray-900 font-medium"},oe={class:"text-xs"},de={key:0,class:"text-gray-400"},le={key:1,class:"text-green-600"},ae={key:2,class:"text-red-600"},re={key:0,class:"text-green-500"},ue={key:1,class:"text-red-500"},ve={__name:"Show",props:{meeting:Object,auth_user_id:Number},setup(n){const d=n,_=w(()=>d.meeting.creator_id===d.auth_user_id||d.meeting.responsible_id===d.auth_user_id),p=d.meeting.responsible_id===d.auth_user_id,h=g=>{confirm("Вы уверены, что хотите изменить статус совещания?")&&k.put(route("meetings.status.update",d.meeting.id),{status:g},{preserveScroll:!0})},u=z({agenda:d.meeting.agenda||"",minutes:d.meeting.minutes||"",status:d.meeting.status}),v=()=>{u.put(route("meetings.update",d.meeting.id),{preserveScroll:!0,onSuccess:()=>alert("Сохранено!")})},C=()=>{confirm("Отправить протокол на согласование? Редактирование будет заблокировано.")&&(u.status="on_approval",v())},M=()=>{confirm("Вы подтверждаете подписание протокола?")&&alert("Функционал подписи нужно реализовать через отдельный контроллер")},a=w(()=>d.meeting.participants.find(g=>g.id===d.auth_user_id)),x=g=>{k.put(route("meetings.participation.update",d.meeting.id),{status:g},{preserveScroll:!0,onSuccess:()=>{}})},S={invited:"Приглашен",accepted:"Принято",declined:"Отклонено"},B={scheduled:"Планирование",in_progress:"Начато (Идет)",completed:"Завершено (Протокол)",on_approval:"На согласовании",signed:"Подписано"};return(g,t)=>(s(),L(j,null,{default:N(()=>[e("div",F,[e("div",P,[e("div",T,[e("div",null,[e("h2",A,r(n.meeting.title),1),e("p",D,r(n.meeting.company.name),1),e("div",{class:b(["mt-2 inline-flex items-center px-3 py-1 rounded-full text-sm font-medium",{"bg-yellow-100 text-yellow-800":n.meeting.status==="scheduled","bg-blue-100 text-blue-800 animate-pulse":n.meeting.status==="in_progress","bg-purple-100 text-purple-800":n.meeting.status==="completed","bg-orange-100 text-orange-800":n.meeting.status==="on_approval","bg-green-100 text-green-800":n.meeting.status==="signed"}])},r(B[n.meeting.status]||n.meeting.status),3)]),_.value?(s(),i("div",E,[n.meeting.status==="scheduled"?(s(),i("button",{key:0,onClick:t[0]||(t[0]=o=>h("in_progress")),class:"bg-blue-600 text-white px-4 py-2 rounded shadow hover:bg-blue-700 transition flex items-center gap-2"},t[7]||(t[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"})],-1),m(" Начать совещание ",-1)]))):l("",!0),n.meeting.status==="in_progress"?(s(),i("button",{key:1,onClick:t[1]||(t[1]=o=>h("completed")),class:"bg-red-600 text-white px-4 py-2 rounded shadow hover:bg-red-700 transition flex items-center gap-2"},t[8]||(t[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z","clip-rule":"evenodd"})],-1),m(" Завершить совещание ",-1)]))):l("",!0),n.meeting.status==="completed"?(s(),i("div",U,t[9]||(t[9]=[m(" Совещание завершено. ",-1),e("br",null,null,-1),m(" Ответственный заполняет протокол. ",-1)]))):l("",!0)])):l("",!0)])]),e("div",G,[e("div",H,[e("div",J,[t[10]||(t[10]=e("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Повестка дня",-1)),p&&n.meeting.status==="scheduled"?(s(),i("div",O,[y(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=o=>c(u).agenda=o),class:"w-full border-gray-300 rounded-md shadow-sm h-32"},null,512),[[f,c(u).agenda]]),e("button",{onClick:v,class:"mt-2 bg-gray-600 text-white px-3 py-1 rounded text-sm"},"Сохранить повестку")])):(s(),i("div",R,r(n.meeting.agenda||"Повестка не заполнена"),1))]),e("div",q,[t[11]||(t[11]=e("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Протокол совещания",-1)),p&&["scheduled","draft"].includes(n.meeting.status)?(s(),i("div",I,[y(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=o=>c(u).minutes=o),placeholder:"Заполните результаты совещания...",class:"w-full border-gray-300 rounded-md shadow-sm h-48"},null,512),[[f,c(u).minutes]]),e("div",{class:"mt-4 flex gap-2"},[e("button",{onClick:v,class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"}," Сохранить черновик "),e("button",{onClick:C,class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"}," Отправить на согласование ")])])):(s(),i("div",K,[e("div",Q,r(n.meeting.minutes||"Протокол еще не сформирован"),1),n.meeting.status==="on_approval"&&!p?(s(),i("div",W,[e("button",{onClick:M,class:"bg-green-600 text-white px-4 py-2 rounded"}," Подписать протокол ")])):l("",!0)]))])]),e("div",X,[a.value?(s(),i("div",{key:0,class:b(["bg-white shadow sm:rounded-lg p-6 border-l-4",{"border-blue-500":a.value.pivot.status==="invited","border-green-500":a.value.pivot.status==="accepted","border-red-500":a.value.pivot.status==="declined"}])},[t[14]||(t[14]=e("h3",{class:"text-lg font-medium mb-2"},"Мое участие",-1)),a.value.pivot.status==="invited"?(s(),i("div",Y,[t[12]||(t[12]=e("p",{class:"text-sm text-gray-600 mb-3"},"Вас пригласили на это совещание. Вы придете?",-1)),e("div",Z,[e("button",{onClick:t[4]||(t[4]=o=>x("accepted")),class:"flex-1 bg-green-600 text-white px-3 py-2 rounded text-sm hover:bg-green-700 transition"}," ✓ Принять "),e("button",{onClick:t[5]||(t[5]=o=>x("declined")),class:"flex-1 bg-red-100 text-red-700 px-3 py-2 rounded text-sm hover:bg-red-200 transition"}," ✕ Отклонить ")])])):(s(),i("div",ee,[e("p",te,[t[13]||(t[13]=m(" Ваш статус: ",-1)),e("span",{class:b(["font-bold",{"text-green-600":a.value.pivot.status==="accepted","text-red-600":a.value.pivot.status==="declined"}])},r(S[a.value.pivot.status]),3)]),n.meeting.status==="scheduled"?(s(),i("button",{key:0,onClick:t[6]||(t[6]=o=>x("invited")),class:"text-xs text-gray-400 underline mt-2"}," Изменить решение ")):l("",!0)]))],2)):l("",!0),e("div",se,[t[17]||(t[17]=e("h3",{class:"text-lg font-medium mb-4"},"Список участников",-1)),e("ul",ne,[(s(!0),i($,null,V(n.meeting.participants,o=>(s(),i("li",{key:o.id,class:"flex items-center justify-between border-b pb-2 last:border-0"},[e("div",null,[e("div",ie,r(o.name),1),e("div",oe,[o.pivot.status==="invited"?(s(),i("span",de,"Ожидание ответа")):o.pivot.status==="accepted"?(s(),i("span",le,"Подтвердил")):o.pivot.status==="declined"?(s(),i("span",ae,"Отклонил")):l("",!0)])]),o.pivot.status==="accepted"?(s(),i("div",re,t[15]||(t[15]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)]))):l("",!0),o.pivot.status==="declined"?(s(),i("div",ue,t[16]||(t[16]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))):l("",!0)]))),128))])])])])])]),_:1}))}};export{ve as default};
