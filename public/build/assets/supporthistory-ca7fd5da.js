import{r as p,q as R,o as t,c as S,w as c,i as h,b as a,f as s,s as m,t as n,g as i,n as $,F as x,a as g,h as C,ae as V,d as W,j as B,v as N}from"./app-801c533d.js";import{_ as z}from"./AuthenticatedLayout-40f8c9ed.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";import"./ApplicationLogo-d0e78184.js";const M={class:"max-w-6xl mx-auto p-6 relative"},q={class:"grid md:grid-cols-2 lg:grid-cols-3 gap-4"},E=["onClick"],G={class:"flex justify-between items-center mb-2"},H={class:"font-semibold text-slate-800 dark:text-slate-100"},I={class:"flex items-center gap-2"},O={key:0,class:"w-2 h-2 rounded-full bg-blue-500 animate-pulse",title:"–ï—Å—Ç—å –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è"},U={class:"text-slate-600 dark:text-slate-300 line-clamp-3"},A={key:0,class:"fixed right-0 top-0 h-full w-full sm:w-[1020px] bg-white dark:bg-slate-900 shadow-xl z-50 border-l border-slate-200 dark:border-slate-700 flex flex-col"},J={class:"p-4 border-b dark:border-slate-700 flex justify-between items-center"},K={class:"font-semibold text-lg text-slate-800 dark:text-slate-100"},P={key:0,class:"mt-3 space-y-3"},Q=["src"],X={key:1,controls:"",class:"rounded-lg max-w-full border"},Y=["src"],Z=["href"],ee={class:"p-4 flex-1 overflow-y-auto space-y-4"},te={class:"bg-slate-50 dark:bg-slate-800 rounded-lg p-3"},se={style:{"overflow-wrap":"break-word",width:"58%"},class:"text-slate-700 dark:text-slate-200 whitespace-pre-line"},ae={key:0,class:"space-y-3 px-2"},le={key:0,class:"max-w-[75%] mt-5 bg-slate-100 dark:bg-slate-800 text-slate-800 dark:text-slate-100 rounded-2xl px-4 py-2 shadow-sm"},oe={style:{"overflow-wrap":"break-word"},class:"text-sm whitespace-pre-line"},re={class:"text-xs text-slate-400 mt-1 text-right"},ne={key:0,class:"mt-2"},de=["src"],ie=["href"],ce={key:1,class:"max-w-[75%] mt-5 bg-blue-600 text-white rounded-2xl px-4 py-2 shadow-sm"},ue={key:0,style:{"overflow-wrap":"break-word"},class:"whitespace-pre-line text-sm mt-1"},pe={key:1,class:"mt-2"},_e=["src"],he={key:1,controls:"",class:"rounded-lg max-w-xs border"},me=["src"],xe=["href"],ge={class:"text-xs text-blue-100 mt-1 text-right"},be={key:1,class:"p-4 border-t dark:border-slate-700 space-y-2"},ye={__name:"supporthistory",setup(ve){const b=p([]),l=p(null),u=p(!1),F=p(!0),j=async()=>{const{data:r}=await h.get("/api/support/history");b.value=r.data,F.value=!1},T=async r=>{l.value=r,u.value=!0,r.has_unread&&(await h.post(`/api/support/read/${r.id}`),r.has_unread=!1)},y=()=>{u.value=!1,l.value=null},D=async()=>{var d;if(!((d=l.value.newReply)!=null&&d.trim())&&!l.value.newFile)return alert("–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∏–ª–∏ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Ñ–∞–π–ª");const r=new FormData;r.append("support_message_id",l.value.id),r.append("reply",l.value.newReply||""),l.value.newFile&&r.append("file",l.value.newFile);try{const{data:o}=await h.post("/api/support/reply",r,{headers:{"Content-Type":"multipart/form-data"}});l.value.replies.push(o.reply),l.value.newReply="",l.value.newFile=null}catch(o){console.error(o),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –æ—Ç–≤–µ—Ç–∞")}};return R(j),(r,d)=>(t(),S(z,null,{header:c(()=>d[2]||(d[2]=[a("h2",{class:"text-2xl font-semibold text-slate-800 dark:text-slate-100 flex items-center gap-2"}," üí¨ –ò—Å—Ç–æ—Ä–∏—è –æ–±—Ä–∞—â–µ–Ω–∏–π ",-1)])),default:c(()=>[a("div",M,[a("div",q,[(t(!0),s(x,null,m(b.value,o=>(t(),s("div",{key:o.id,onClick:e=>T(o),class:"cursor-pointer p-5 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl shadow-sm hover:shadow-md transition"},[a("div",G,[a("h3",H," –û–±—Ä–∞—â–µ–Ω–∏–µ ‚Ññ"+n(o.id),1),a("div",I,[o.has_unread?(t(),s("span",O)):i("",!0),a("span",{class:$(["px-2 py-1 text-xs rounded-full",o.status==="closed"?"bg-gray-200 text-gray-700":"bg-blue-100 text-blue-700"])},n(o.status==="closed"?"–ó–∞–≤–µ—Ä—à–µ–Ω–æ":"–û—Ç–∫—Ä—ã—Ç–æ"),3)])]),a("p",U,n(o.message),1)],8,E))),128))]),g(C,{name:"fade"},{default:c(()=>[u.value?(t(),s("div",{key:0,class:"fixed inset-0 bg-black/40 z-40",onClick:y})):i("",!0)]),_:1}),g(C,{name:"slide"},{default:c(()=>{var o;return[u.value&&l.value?(t(),s("div",A,[a("div",J,[a("h3",K," –û–±—Ä–∞—â–µ–Ω–∏–µ ‚Ññ"+n(l.value.id),1),a("button",{onClick:y,class:"text-slate-500 hover:text-slate-800"},"‚úï")]),(o=l.value.attachments)!=null&&o.length?(t(),s("div",P,[(t(!0),s(x,null,m(l.value.attachments,e=>(t(),s("div",{key:e.id,class:"flex flex-col gap-2"},[e.mime_type.startsWith("image")?(t(),s("img",{key:0,src:`/storage/${e.path}`,class:"rounded-lg max-w-96 border"},null,8,Q)):e.mime_type.startsWith("video")?(t(),s("video",X,[a("source",{src:`/storage/${e.path}`},null,8,Y)])):(t(),s("a",{key:2,href:`/storage/${e.path}`,target:"_blank",class:"text-blue-600 underline"}," üìé "+n(e.original_name),9,Z))]))),128))])):i("",!0),a("div",ee,[a("div",te,[a("p",se,n(l.value.message),1)]),l.value.replies.length?(t(),s("div",ae,[g(V,{name:"fade",tag:"div"},{default:c(()=>[(t(!0),s(x,null,m(l.value.replies,e=>{var v,f,w,k;return t(),s("div",{key:e.id,class:$(["flex",(f=(v=e.user)==null?void 0:v.roles)!=null&&f.some(_=>_.name==="support")?"justify-end":"justify-start"])},[(k=(w=e.user)==null?void 0:w.roles)!=null&&k.some(_=>_.name==="support")?(t(),s("div",ce,[d[3]||(d[3]=a("p",{class:"flex items-center gap-1 text-sm"},[W(" üõ† "),a("strong",null,"–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞:")],-1)),e.reply?(t(),s("p",ue,n(e.reply),1)):i("",!0),e.attachment?(t(),s("div",pe,[e.attachment.mime_type.startsWith("image")?(t(),s("img",{key:0,src:`/storage/${e.attachment.path}`,class:"rounded-lg max-w-xs border"},null,8,_e)):e.attachment.mime_type.startsWith("video")?(t(),s("video",he,[a("source",{src:`/storage/${e.attachment.path}`},null,8,me)])):(t(),s("a",{key:2,href:`/storage/${e.attachment.path}`,class:"text-blue-200 underline block",target:"_blank"}," üìé "+n(e.attachment.original_name),9,xe))])):i("",!0),a("p",ge,n(new Date(e.created_at).toLocaleTimeString()),1)])):(t(),s("div",le,[a("p",oe,n(e.reply),1),a("p",re,n(new Date(e.created_at).toLocaleTimeString()),1),e.attachment?(t(),s("div",ne,[e.attachment.mime_type.startsWith("image")?(t(),s("img",{key:0,src:`/storage/${e.attachment.path}`,class:"rounded-lg max-w-xs border"},null,8,de)):(t(),s("a",{key:1,href:`/storage/${e.attachment.path}`,class:"text-blue-400 underline",target:"_blank"}," üìé "+n(e.attachment.original_name),9,ie))])):i("",!0)]))],2)}),128))]),_:1})])):i("",!0)]),l.value.status!=="closed"?(t(),s("div",be,[B(a("textarea",{"onUpdate:modelValue":d[0]||(d[0]=e=>l.value.newReply=e),placeholder:"–ù–∞–ø–∏—à–∏—Ç–µ –æ—Ç–≤–µ—Ç...",rows:"2",class:"w-full border border-slate-300 dark:border-slate-600 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 dark:bg-slate-800 dark:text-slate-100"},null,512),[[N,l.value.newReply]]),a("input",{type:"file",onChange:d[1]||(d[1]=e=>l.value.newFile=e.target.files[0]),accept:"image/*,.jpg,.jpeg,.png,.webp,.gif,.pdf",class:"text-sm text-slate-700 dark:text-slate-300"},null,32),a("button",{onClick:D,class:"w-full bg-blue-600 text-white rounded-lg py-2 text-sm hover:bg-blue-700 transition"}," –û—Ç–ø—Ä–∞–≤–∏—Ç—å ")])):i("",!0)])):i("",!0)]}),_:1})])]),_:1}))}},Ce=L(ye,[["__scopeId","data-v-831bb9a8"]]);export{Ce as default};
