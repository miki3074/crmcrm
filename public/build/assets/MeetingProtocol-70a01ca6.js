import{K as h,h as g,o,a as n,b as e,f as k,t as m,g as u,w as p,v as b,u as v,N as x}from"./app-e2bfa4e1.js";const j={class:"bg-white shadow sm:rounded-lg p-6 relative"},C={key:0,class:"mb-4 bg-red-50 border-l-4 border-red-500 p-4"},S={class:"text-sm text-red-700"},B={key:1},M={key:2},N={class:"prose bg-gray-50 p-4 rounded whitespace-pre-line border border-gray-200"},R={key:0,class:"mt-6 border-t pt-4 flex gap-3"},V={key:1,class:"mt-4 text-green-700 font-bold"},P={key:3,class:"fixed inset-0 z-50 flex items-center justify-center bg-gray-500 bg-opacity-75"},T={class:"bg-white rounded-lg p-6 max-w-lg w-full"},D={class:"mt-4 flex justify-end gap-2"},z={__name:"MeetingProtocol",props:{meeting:Object,canManage:Boolean,isResponsible:Boolean},setup(s){const r=s,i=h({minutes:r.meeting.minutes||"",status:r.meeting.status}),c=()=>{i.put(route("meetings.update",r.meeting.id),{preserveScroll:!0,onSuccess:()=>alert("Сохранено!")})},f=()=>{confirm("Отправить на согласование?")&&(i.status="on_approval",c())},y=()=>{confirm("Утвердить протокол?")&&x.post(route("meetings.review",r.meeting.id),{decision:"approve"},{preserveScroll:!0})},l=g(!1),d=g(""),w=()=>{if(!d.value.trim())return alert("Укажите причину");x.post(route("meetings.review",r.meeting.id),{decision:"reject",reason:d.value},{preserveScroll:!0,onSuccess:()=>l.value=!1})};return(U,t)=>(o(),n("div",j,[t[6]||(t[6]=e("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Протокол совещания",-1)),s.meeting.rejection_reason&&s.meeting.status!=="signed"?(o(),n("div",C,[e("p",S,[t[4]||(t[4]=e("span",{class:"font-bold"},"Требуется доработка:",-1)),k(" "+m(s.meeting.rejection_reason),1)])])):u("",!0),s.canManage&&["scheduled","in_progress","completed"].includes(s.meeting.status)?(o(),n("div",B,[p(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=a=>v(i).minutes=a),placeholder:"Результаты...",class:"w-full border-gray-300 rounded-md shadow-sm h-48"},null,512),[[b,v(i).minutes]]),e("div",{class:"mt-4 flex gap-2"},[e("button",{onClick:c,class:"bg-blue-600 text-white px-4 py-2 rounded"},"Сохранить черновик"),e("button",{onClick:f,class:"bg-green-600 text-white px-4 py-2 rounded"},"Отправить на согласование")])])):(o(),n("div",M,[e("div",N,m(s.meeting.minutes||"Протокол еще не сформирован"),1),s.meeting.status==="on_approval"&&s.isResponsible?(o(),n("div",R,[e("button",{onClick:y,class:"flex-1 bg-green-600 text-white px-4 py-2 rounded"},"Утвердить и Подписать"),e("button",{onClick:t[1]||(t[1]=a=>l.value=!0),class:"flex-1 bg-red-100 text-red-700 px-4 py-2 rounded"},"На доработку")])):u("",!0),s.meeting.status==="signed"?(o(),n("div",V,"Протокол подписан.")):u("",!0)])),l.value?(o(),n("div",P,[e("div",T,[t[5]||(t[5]=e("h3",{class:"text-lg font-medium text-gray-900"},"На доработку",-1)),p(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=a=>d.value=a),class:"w-full mt-2 border-gray-300 rounded",rows:"4"},null,512),[[b,d.value]]),e("div",D,[e("button",{onClick:w,class:"bg-red-600 text-white px-4 py-2 rounded"},"Отправить"),e("button",{onClick:t[3]||(t[3]=a=>l.value=!1),class:"bg-gray-200 text-gray-700 px-4 py-2 rounded"},"Отмена")])])])):u("",!0)]))}};export{z as default};
