import{r as n,q as k,o as r,c as _,w as C,i as b,b as t,f as d,t as u,g as v,F as U,x as $,j as y,v as x}from"./app-d2aacd93.js";import{_ as V}from"./AuthenticatedLayout-ce283c93.js";import"./ApplicationLogo-523424a7.js";import"./_plugin-vue_export-helper-c27b6911.js";const B={class:"p-6"},E={key:0,class:"text-red-600 mb-3"},j={key:1,class:"text-gray-500"},D={key:2,class:"w-full border-collapse border border-gray-200 dark:border-gray-700"},F={class:"border px-3 py-2"},I={class:"border px-3 py-2"},M={class:"border px-3 py-2"},N={class:"border px-3 py-2 flex gap-2"},T=["onClick"],q=["onClick"],z={key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},L={class:"bg-white dark:bg-gray-800 rounded-xl p-6 w-96"},S={class:"flex justify-end gap-2"},O={__name:"Index",setup(A){const g=n([]),p=n(!0),i=n(""),o=n(null),l=n({name:"",email:"",password:""}),c=async()=>{var s,e;p.value=!0,i.value="";try{const{data:a}=await b.get("/api/users",{withCredentials:!0});g.value=a}catch(a){i.value=((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||"Ошибка загрузки пользователей"}finally{p.value=!1}},f=s=>{o.value=s,l.value={name:s.name,email:s.email,password:""}},h=async()=>{var s,e;if(o.value)try{await b.put(`/api/users/${o.value.id}`,l.value,{withCredentials:!0}),await c(),o.value=null,alert("Пользователь обновлён")}catch(a){alert(((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||"Ошибка при обновлении")}},w=async s=>{var e,a;if(confirm("Удалить пользователя?"))try{await b.delete(`/api/users/${s}`,{withCredentials:!0}),await c(),alert("Пользователь удалён")}catch(m){alert(((a=(e=m.response)==null?void 0:e.data)==null?void 0:a.message)||"Ошибка при удалении")}};return k(c),(s,e)=>(r(),_(V,null,{default:C(()=>[t("div",B,[e[6]||(e[6]=t("h1",{class:"text-2xl font-semibold text-gray-700 dark:text-gray-100 mb-4"}," Управление пользователями ",-1)),i.value?(r(),d("p",E,u(i.value),1)):v("",!0),p.value?(r(),d("p",j,"Загрузка...")):(r(),d("table",D,[e[4]||(e[4]=t("thead",{class:"bg-gray-100 dark:bg-gray-800"},[t("tr",null,[t("th",{class:"border px-3 py-2 text-left"},"ID"),t("th",{class:"border px-3 py-2 text-left"},"Имя"),t("th",{class:"border px-3 py-2 text-left"},"Email"),t("th",{class:"border px-3 py-2 text-left"},"Действия")])],-1)),t("tbody",null,[(r(!0),d(U,null,$(g.value,a=>(r(),d("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",F,u(a.id),1),t("td",I,u(a.name),1),t("td",M,u(a.email),1),t("td",N,[t("button",{onClick:m=>f(a),class:"text-indigo-600 hover:underline"},"Редактировать",8,T),t("button",{onClick:m=>w(a.id),class:"text-rose-600 hover:underline"},"Удалить",8,q)])]))),128))])])),o.value?(r(),d("div",z,[t("div",L,[e[5]||(e[5]=t("h3",{class:"text-lg font-semibold mb-4"},"Редактировать пользователя",-1)),y(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.name=a),type:"text",placeholder:"Имя",class:"w-full border rounded p-2 mb-2 dark:bg-gray-700 dark:text-white"},null,512),[[x,l.value.name]]),y(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.email=a),type:"email",placeholder:"Email",class:"w-full border rounded p-2 mb-2 dark:bg-gray-700 dark:text-white"},null,512),[[x,l.value.email]]),y(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.password=a),type:"password",placeholder:"Новый пароль (если нужно)",autocomplete:"new-password",class:"w-full border rounded p-2 mb-4 dark:bg-gray-700 dark:text-white"},null,512),[[x,l.value.password]]),t("div",S,[t("button",{onClick:e[3]||(e[3]=a=>o.value=null),class:"px-4 py-2 border rounded-lg"},"Отмена"),t("button",{onClick:h,class:"px-4 py-2 bg-indigo-600 text-white rounded-lg"},"Сохранить")])])])):v("",!0)])]),_:1}))}};export{O as default};
