import{r,x as B,o as a,L as D,I as k,f as v,a as e,k as E,u as F,Z as N,h as _,K as U,v as w,c as l,e as g,t as i,F as x,d as f,E as C}from"./app-e92293fe.js";import{_ as A}from"./AuthenticatedLayout-93dd1f4c.js";import"./ApplicationLogo-b041db19.js";import"./_plugin-vue_export-helper-c27b6911.js";const I={class:"max-w-7xl mx-auto p-6 grid grid-cols-[260px,1fr] gap-4"},L={class:"bg-white dark:bg-slate-900 p-3 rounded-xl border"},S={class:"space-y-2 mb-4"},W={class:"overflow-y-auto max-h-[600px] space-y-2"},z=["onClick"],K={class:"font-semibold text-sm"},Z={class:"text-xs text-slate-500"},q={class:"bg-white dark:bg-slate-900 p-4 rounded-xl border flex flex-col"},G={key:0,class:"flex justify-between items-center mb-3 border-b pb-3"},H={class:"font-semibold"},J={class:"text-sm text-slate-500"},O={class:"flex-1 overflow-y-auto space-y-3"},P={key:0,class:"mt-2 space-y-1"},Q=["src"],R={key:1,controls:"",class:"max-w-xs rounded border"},X=["src"],Y=["href"],ee={key:1,class:"border-t pt-3 space-y-2"},se=["disabled"],de={__name:"Admin",setup(te){const y=r([]),n=r(null),h=r([]),u=r({status:"all",search:""}),c=r(""),b=r(!1),m=r([]),p=async()=>{const{data:o}=await v.get("/api/support/admin/threads",{params:u.value});y.value=o},$=async o=>{n.value=o;const{data:t}=await v.get(`/api/support/admin/threads/${o.id}`);h.value=t.messages},T=async()=>{if(!c.value.trim()&&!m.value.length)return;const o=new FormData;o.append("message",c.value),m.value.forEach((s,d)=>o.append(`files[${d}]`,s)),b.value=!0;const{data:t}=await v.post(`/api/support/admin/threads/${n.value.id}/messages`,o,{headers:{"Content-Type":"multipart/form-data"}});b.value=!1,h.value.push(t),c.value="",m.value=[]},V=o=>{m.value.push(...Array.from(o.target.files)),o.target.value=""},j=async()=>{await v.post(`/api/support/admin/threads/${n.value.id}/close`),n.value.status="closed",await p()},M=async()=>{await v.post(`/api/support/admin/threads/${n.value.id}/reopen`),n.value.status="open",await p()};return B(p),(o,t)=>(a(),D(A,null,{header:k(()=>t[3]||(t[3]=[e("h2",{class:"text-2xl font-semibold"},"üõ† –ü–∞–Ω–µ–ª—å —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏",-1)])),default:k(()=>[E(F(N),{title:"–ü–∞–Ω–µ–ª—å —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏"}),e("div",I,[e("div",L,[t[5]||(t[5]=e("h3",{class:"font-semibold mb-4"},"–í—Å–µ —Ç–∏–∫–µ—Ç—ã",-1)),e("div",S,[_(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>u.value.status=s),class:"input",onChange:p},t[4]||(t[4]=[e("option",{value:"all"},"–í—Å–µ",-1),e("option",{value:"open"},"–û—Ç–∫—Ä—ã—Ç—ã–µ",-1),e("option",{value:"closed"},"–ó–∞–∫—Ä—ã—Ç—ã–µ",-1)]),544),[[U,u.value.status]]),_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>u.value.search=s),onInput:p,placeholder:"–ü–æ–∏—Å–∫...",class:"input"},null,544),[[w,u.value.search]])]),e("div",W,[(a(!0),l(x,null,g(y.value,s=>(a(),l("div",{key:s.id,class:"p-2 rounded cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800",onClick:d=>$(s)},[e("div",K,i(s.subject||"–ë–µ–∑ —Ç–µ–º—ã"),1),e("div",Z,i(s.user.name)+" ‚Äî "+i(s.status==="closed"?"–ó–∞–∫—Ä—ã—Ç":"–û—Ç–∫—Ä—ã—Ç"),1)],8,z))),128))])]),e("div",q,[n.value?(a(),l("div",G,[e("div",null,[e("div",H,i(n.value.subject||"–û–±—Ä–∞—â–µ–Ω–∏–µ"),1),e("div",J," –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "+i(n.value.user.name),1)]),e("div",null,[n.value.status==="open"?(a(),l("button",{key:0,class:"btn-red",onClick:j}," –ó–∞–∫—Ä—ã—Ç—å ")):(a(),l("button",{key:1,class:"btn-blue",onClick:M}," –û—Ç–∫—Ä—ã—Ç—å "))])])):f("",!0),e("div",O,[(a(!0),l(x,null,g(h.value,s=>(a(),l("div",{key:s.id,class:C(["flex",s.is_support?"justify-end":"justify-start"])},[e("div",{class:C(["max-w-[75%] px-3 py-2 rounded-xl",s.is_support?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-800"])},[e("div",null,i(s.body),1),s.attachments.length?(a(),l("div",P,[(a(!0),l(x,null,g(s.attachments,d=>(a(),l("div",{key:d.id},[d.mime_type.startsWith("image/")?(a(),l("img",{key:0,src:`/storage/${d.path}`,class:"max-w-xs rounded border"},null,8,Q)):d.mime_type.startsWith("video/")?(a(),l("video",R,[e("source",{src:`/storage/${d.path}`},null,8,X)])):(a(),l("a",{key:2,href:`/storage/${d.path}`,target:"_blank",class:"underline text-xs"}," üìé "+i(d.original_name),9,Y))]))),128))])):f("",!0)],2)],2))),128))]),n.value?(a(),l("div",ee,[e("input",{type:"file",multiple:"",class:"hidden",id:"file-upload",onChange:V},null,32),t[6]||(t[6]=e("label",{for:"file-upload",class:"btn-gray cursor-pointer"}," üìé –§–∞–π–ª—ã ",-1)),_(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>c.value=s),class:"w-full input",placeholder:"–í–∞—à –æ—Ç–≤–µ—Ç..."},null,512),[[w,c.value]]),e("button",{class:"btn-blue",disabled:b.value,onClick:T}," –û—Ç–ø—Ä–∞–≤–∏—Ç—å ",8,se)])):f("",!0)])])]),_:1}))}};export{de as default};
