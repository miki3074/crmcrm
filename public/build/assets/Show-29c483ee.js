import{Q as H,r as v,m as J,q as K,A as P,o,f as r,a as y,u as R,w,F as T,i as b,Z as W,b as t,t as n,d as F,g as i,n as D,j as u,v as g,s as X,e as q,x as Y}from"./app-a5a3f45a.js";import{_ as tt}from"./AuthenticatedLayout-b25ea513.js";import"./ApplicationLogo-900c99c9.js";import"./_plugin-vue_export-helper-c27b6911.js";const et={class:"flex items-center justify-between"},at={class:"text-xl font-bold text-gray-800 dark:text-gray-100"},st={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},lt={class:"font-medium"},ot={class:"max-w-7xl mx-auto p-6 space-y-6"},rt={class:"flex gap-2 border-b dark:border-gray-700"},dt={key:0,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},nt={class:"lg:col-span-2 bg-white dark:bg-gray-800 rounded-2xl shadow p-6"},it={key:0,class:"space-y-6"},ut={class:"flex items-center gap-3"},xt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},gt={key:0},pt={key:1},yt={key:2},mt={key:3,class:"md:col-span-2"},vt={class:"mt-1 border rounded-lg px-3 py-2 dark:bg-gray-700 dark:text-white flex items-center justify-between"},bt={key:4,class:"md:col-span-2"},ct={class:"mt-1 border rounded-lg px-3 py-2 dark:bg-gray-700 dark:text-white"},kt={class:"flex flex-col"},wt={class:"font-medium text-gray-900 dark:text-gray-100"},ft={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},ht={class:"md:col-span-2"},_t={key:1,class:"text-slate-500"},jt={class:"space-y-4"},Ct={class:"bg-white dark:bg-gray-800 rounded-2xl shadow p-5"},$t={class:"text-2xl font-bold text-gray-900 dark:text-white"},Vt={class:"bg-white dark:bg-gray-800 rounded-2xl shadow p-5"},Mt={class:"text-2xl font-bold text-gray-900 dark:text-white"},St={key:1},Dt={class:"flex justify-between items-center mb-4"},Ut={class:"bg-white dark:bg-gray-800 rounded-2xl shadow divide-y dark:divide-gray-700"},zt={class:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-700"},Ft={class:"text-xs uppercase"},It={class:"flex-1"},Nt={class:"flex justify-between"},Ot={class:"font-medium text-gray-900 dark:text-white"},Bt={class:"ml-2 text-xs px-2 py-0.5 rounded bg-gray-100 dark:bg-gray-700"},Lt={class:"text-xs text-gray-500"},Pt={class:"text-sm text-gray-700 dark:text-gray-300 mt-1 whitespace-pre-line"},Tt={key:0,class:"p-6 text-sm text-gray-500 dark:text-gray-400"},qt={key:2},At={class:"flex justify-between items-center mb-4"},Et={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Qt={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},Zt={class:"bg-white dark:bg-gray-800 rounded-xl shadow p-6 w-full max-w-lg"},Gt={class:"flex justify-end gap-2"},Ht={key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},Jt={class:"bg-white dark:bg-gray-800 rounded-xl shadow p-6 w-full max-w-md"},Kt={class:"flex justify-end gap-2"},Rt={components:{PipelineCol:{props:{title:String,items:Array,color:String},template:`
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow p-4 border-t-4" :class="color">
          <div class="flex items-center justify-between mb-3">
            <h4 class="font-semibold text-gray-900 dark:text-white">{{ title }}</h4>
            <span class="text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-0.5 rounded">{{ items.length }}</span>
          </div>
          <div class="space-y-3">
            <slot v-for="i in items" name="item" :item="i" :key="i.id"></slot>
          </div>
        </div>
      `},DealCard:{emits:["move"],props:{deal:Object},template:`
        <div class="p-3 rounded-lg bg-gray-50 dark:bg-gray-700/40 border dark:border-gray-700">
          <div class="flex justify-between items-start">
            <div class="font-medium text-gray-900 dark:text-white">{{ deal.title }}</div>
            <div class="text-xs text-gray-500">#{{ deal.id }}</div>
          </div>
          <div class="text-sm text-gray-600 dark:text-gray-300 mt-1" v-if="deal.amount">‚âà {{ Number(deal.amount).toLocaleString() }} ‚ÇΩ</div>
          <div class="mt-3 flex flex-wrap gap-1">
            <button class="text-xs px-2 py-1 bg-sky-600 text-white rounded" @click="$emit('move','new')">–ù–æ–≤—ã–π</button>
            <button class="text-xs px-2 py-1 bg-amber-600 text-white rounded" @click="$emit('move','in_progress')">–í —Ä–∞–±–æ—Ç–µ</button>
            <button class="text-xs px-2 py-1 bg-emerald-600 text-white rounded" @click="$emit('move','won')">–£—Å–ø–µ—à–Ω–æ</button>
            <button class="text-xs px-2 py-1 bg-rose-600 text-white rounded" @click="$emit('move','lost')">–ü—Ä–æ–≤–∞–ª</button>
          </div>
        </div>
      `}}},ae=Object.assign(Rt,{__name:"Show",setup(Wt){const{props:A}=H(),c=A.id,l=v(null),x=v("profile"),d=v({name:"",phone:"",email:"",notes:""}),m=v({type:"call",content:"",interaction_date:new Date().toISOString().slice(0,16)}),j=v(!1),C=v(!1),k=v({title:"",amount:""}),f=v([]),U=async()=>{const{data:s}=await b.get(`/api/clients/${c}`);l.value=s,d.value={name:s.name||"",organization_name:s.organization_name||"",city:s.city||"",address:s.address||"",phone:s.phone||"",email:s.email||"",notes:s.notes||""}},z=async()=>{const{data:s}=await b.get(`/api/clients/${c}/deals`);f.value=s},E=async()=>{await b.put(`/api/clients/${c}`,d.value),await U()},Q=async()=>{await b.post(`/api/clients/${c}/interactions`,m.value),j.value=!1,m.value={type:"call",content:"",interaction_date:new Date().toISOString().slice(0,16)},await U(),x.value="interactions"},Z=async()=>{await b.post(`/api/clients/${c}/deals`,k.value),C.value=!1,k.value={title:"",amount:""},await z(),x.value="deals"},$=J(()=>({new:f.value.filter(s=>s.status==="new"),in_progress:f.value.filter(s=>s.status==="in_progress"),won:f.value.filter(s=>s.status==="won"),lost:f.value.filter(s=>s.status==="lost")})),V=async(s,e)=>{s.status!==e&&(await b.patch(`/api/deals/${s.id}/status`,{status:e}),await z())},G=async()=>{var s;if(confirm("–£–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞?"))try{await b.delete(`/api/clients/${c}`),alert("–ö–ª–∏–µ–Ω—Ç —É–¥–∞–ª—ë–Ω"),window.location.href="/clients"}catch(e){((s=e.response)==null?void 0:s.status)===403?alert("‚ùå –¢–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞"):alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏")}};return K(async()=>{await U(),await z()}),(s,e)=>{var I;const M=P("DealCard"),S=P("PipelineCol");return o(),r(T,null,[y(R(W),{title:(I=l.value)!=null&&I.name?`–ö–ª–∏–µ–Ω—Ç ‚Äî ${l.value.name}`:"–ö–ª–∏–µ–Ω—Ç"},null,8,["title"]),y(tt,null,{header:w(()=>{var h,_;return[t("div",et,[t("h2",at," –ö–ª–∏–µ–Ω—Ç: "+n(((h=l.value)==null?void 0:h.name)??"..."),1),(_=l.value)!=null&&_.company?(o(),r("div",st,[e[19]||(e[19]=F(" –ö–æ–º–ø–∞–Ω–∏—è: ",-1)),t("span",lt,n(l.value.company.name),1)])):i("",!0)])]}),default:w(()=>{var h,_,N,O,B,L;return[t("div",ot,[t("div",rt,[t("button",{class:D(["px-4 py-2 -mb-px",x.value==="profile"?"border-b-2 border-indigo-600 text-indigo-600":"text-gray-600 dark:text-gray-400"]),onClick:e[0]||(e[0]=a=>x.value="profile")},"–ü—Ä–æ—Ñ–∏–ª—å",2),t("button",{class:D(["px-4 py-2 -mb-px",x.value==="interactions"?"border-b-2 border-indigo-600 text-indigo-600":"text-gray-600 dark:text-gray-400"]),onClick:e[1]||(e[1]=a=>x.value="interactions")},"–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è",2),t("button",{disabled:"",class:D(["px-4 py-2 -mb-px",x.value==="deals"?"border-b-2 border-indigo-600 text-indigo-600":"text-gray-600 dark:text-gray-400"]),onClick:e[2]||(e[2]=a=>x.value="deals")},e[20]||(e[20]=[F("–°–¥–µ–ª–∫–∏ ",-1),t("span",{style:{color:"red"}},"(–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)",-1)]),2)]),x.value==="profile"?(o(),r("div",dt,[t("div",nt,[e[30]||(e[30]=t("h3",{class:"text-lg font-semibold mb-4 text-gray-800 dark:text-gray-100"}," üßæ –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞ ",-1)),l.value?(o(),r("div",it,[t("div",ut,[t("span",{class:D(["px-3 py-1 text-xs rounded-full",l.value.type==="jur"?"bg-blue-100 text-blue-700":"bg-emerald-100 text-emerald-700"])},n(l.value.type==="jur"?"–Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ":"–§–∏–∑–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ"),3)]),t("div",xt,[l.value.type==="jur"?(o(),r("div",gt,[e[21]||(e[21]=t("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏",-1)),u(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>d.value.organization_name=a),class:"mt-1 w-full border rounded-lg px-3 py-2 dark:bg-gray-700 dark:text-white",placeholder:"–û–û–û –†–æ–º–∞—à–∫–∞"},null,512),[[g,d.value.organization_name]])])):i("",!0),t("div",null,[e[22]||(e[22]=t("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"–§–ò–û",-1)),u(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>d.value.name=a),class:"mt-1 w-full border rounded-lg px-3 py-2 dark:bg-gray-700 dark:text-white",placeholder:"–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á"},null,512),[[g,d.value.name]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"Email",-1)),u(t("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>d.value.email=a),type:"email",class:"mt-1 w-full border rounded-lg px-3 py-2 dark:bg-gray-700 dark:text-white",placeholder:"example@mail.ru"},null,512),[[g,d.value.email]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"–¢–µ–ª–µ—Ñ–æ–Ω",-1)),u(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>d.value.phone=a),class:"mt-1 w-full border rounded-lg px-3 py-2 dark:bg-gray-700 dark:text-white",placeholder:"+7 (999) 999-99-99"},null,512),[[g,d.value.phone]])]),l.value.type==="jur"?(o(),r("div",pt,[e[25]||(e[25]=t("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"–ì–æ—Ä–æ–¥",-1)),u(t("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>d.value.city=a),class:"mt-1 w-full border rounded-lg px-3 py-2 dark:bg-gray-700 dark:text-white",placeholder:"–ú–æ—Å–∫–≤–∞"},null,512),[[g,d.value.city]])])):i("",!0),l.value.type==="jur"?(o(),r("div",yt,[e[26]||(e[26]=t("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"–ê–¥—Ä–µ—Å",-1)),u(t("input",{"onUpdate:modelValue":e[8]||(e[8]=a=>d.value.address=a),class:"mt-1 w-full border rounded-lg px-3 py-2 dark:bg-gray-700 dark:text-white",placeholder:"—É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10"},null,512),[[g,d.value.address]])])):i("",!0),l.value.responsible?(o(),r("div",mt,[e[27]||(e[27]=t("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π",-1)),t("div",vt,[t("span",null,n(l.value.responsible.name),1)])])):i("",!0),l.value.project?(o(),r("div",bt,[e[28]||(e[28]=t("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"–ü—Ä–æ–µ–∫—Ç",-1)),t("div",ct,[t("div",kt,[t("span",wt,n(l.value.project.name),1),l.value.project.company?(o(),r("span",ft," –ö–æ–º–ø–∞–Ω–∏—è: "+n(l.value.project.company.name),1)):i("",!0)])])])):i("",!0),t("div",ht,[e[29]||(e[29]=t("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"–ó–∞–º–µ—Ç–∫–∏",-1)),u(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=a=>d.value.notes=a),rows:"5",class:"mt-1 w-full border rounded-lg px-3 py-2 dark:bg-gray-700 dark:text-white"},null,512),[[g,d.value.notes]])])]),t("div",{class:"mt-4 flex justify-end"},[t("button",{onClick:E,class:"px-5 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-medium shadow transition"}," üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è "),t("button",{onClick:G,class:"ml-5 bg-rose-600 hover:bg-rose-700 text-white px-4 py-2 rounded-lg shadow transition"}," üóë ")])])):(o(),r("div",_t,"–ó–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞..."))]),t("div",jt,[t("div",Ct,[e[31]||(e[31]=t("div",{class:"text-sm text-gray-500 dark:text-gray-400"},"–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π",-1)),t("div",$t,n(((_=(h=l.value)==null?void 0:h.interactions)==null?void 0:_.length)??0),1)]),t("div",Vt,[e[32]||(e[32]=t("div",{class:"text-sm text-gray-500 dark:text-gray-400"},"–°–¥–µ–ª–æ–∫",-1)),t("div",Mt,n(((O=(N=l.value)==null?void 0:N.deals)==null?void 0:O.length)??0),1)])])])):i("",!0),x.value==="interactions"?(o(),r("div",St,[t("div",Dt,[e[33]||(e[33]=t("h3",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100"},"–ò—Å—Ç–æ—Ä–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π",-1)),t("button",{onClick:e[10]||(e[10]=a=>j.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"}," + –î–æ–±–∞–≤–∏—Ç—å ")]),t("div",Ut,[(o(!0),r(T,null,X(((B=l.value)==null?void 0:B.interactions)||[],a=>{var p;return o(),r("div",{key:a.id,class:"p-4 flex items-start gap-3"},[t("span",zt,[t("span",Ft,n(a.type[0]),1)]),t("div",It,[t("div",Nt,[t("div",Ot,[F(n(((p=a.user)==null?void 0:p.name)||"‚Äî")+" ",1),t("span",Bt,n(a.type),1)]),t("div",Lt,n(new Date(a.interaction_date).toLocaleString()),1)]),t("div",Pt,n(a.content),1)])])}),128)),(((L=l.value)==null?void 0:L.interactions)||[]).length===0?(o(),r("div",Tt," –ü–æ–∫–∞ –Ω–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π. ")):i("",!0)])])):i("",!0),x.value==="deals"?(o(),r("div",qt,[t("div",At,[e[34]||(e[34]=t("h3",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100"},"–°–¥–µ–ª–∫–∏",-1)),t("button",{onClick:e[11]||(e[11]=a=>C.value=!0),class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"}," + –ù–æ–≤–∞—è —Å–¥–µ–ª–∫–∞ ")]),t("div",Et,[y(S,{title:"–ù–æ–≤—ã–µ",items:$.value.new,color:"border-sky-500"},{item:w(({item:a})=>[y(M,{deal:a,onMove:p=>V(a,p)},null,8,["deal","onMove"])]),_:1},8,["items"]),y(S,{title:"–í —Ä–∞–±–æ—Ç–µ",items:$.value.in_progress,color:"border-amber-500"},{item:w(({item:a})=>[y(M,{deal:a,onMove:p=>V(a,p)},null,8,["deal","onMove"])]),_:1},8,["items"]),y(S,{title:"–£—Å–ø–µ—à–Ω—ã–µ",items:$.value.won,color:"border-emerald-500"},{item:w(({item:a})=>[y(M,{deal:a,onMove:p=>V(a,p)},null,8,["deal","onMove"])]),_:1},8,["items"]),y(S,{title:"–ü—Ä–æ–≤–∞–ª–µ–Ω–Ω—ã–µ",items:$.value.lost,color:"border-rose-500"},{item:w(({item:a})=>[y(M,{deal:a,onMove:p=>V(a,p)},null,8,["deal","onMove"])]),_:1},8,["items"])])])):i("",!0)]),j.value?(o(),r("div",Qt,[t("div",Zt,[e[40]||(e[40]=t("h3",{class:"text-lg font-semibold mb-4 text-gray-900 dark:text-white"},"–ù–æ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ",-1)),t("form",{onSubmit:q(Q,["prevent"]),class:"space-y-3"},[t("div",null,[e[36]||(e[36]=t("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"–¢–∏–ø",-1)),u(t("select",{"onUpdate:modelValue":e[12]||(e[12]=a=>m.value.type=a),class:"mt-1 w-full border rounded px-3 py-2 dark:bg-gray-700 dark:text-white"},e[35]||(e[35]=[t("option",{value:"call"},"–ó–≤–æ–Ω–æ–∫",-1),t("option",{value:"meeting"},"–í—Å—Ç—Ä–µ—á–∞",-1),t("option",{value:"email"},"–ü–∏—Å—å–º–æ",-1),t("option",{value:"comment"},"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π",-1)]),512),[[Y,m.value.type]])]),t("div",null,[e[37]||(e[37]=t("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"–î–∞—Ç–∞/–≤—Ä–µ–º—è",-1)),u(t("input",{type:"datetime-local","onUpdate:modelValue":e[13]||(e[13]=a=>m.value.interaction_date=a),class:"mt-1 w-full border rounded px-3 py-2 dark:bg-gray-700 dark:text-white"},null,512),[[g,m.value.interaction_date]])]),t("div",null,[e[38]||(e[38]=t("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ",-1)),u(t("textarea",{"onUpdate:modelValue":e[14]||(e[14]=a=>m.value.content=a),rows:"5",class:"mt-1 w-full border rounded px-3 py-2 dark:bg-gray-700 dark:text-white"},null,512),[[g,m.value.content]])]),t("div",Gt,[t("button",{type:"button",onClick:e[15]||(e[15]=a=>j.value=!1),class:"px-3 py-2 bg-gray-500 text-white rounded"},"–û—Ç–º–µ–Ω–∞"),e[39]||(e[39]=t("button",{type:"submit",class:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"},"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å",-1))])],32)])])):i("",!0),C.value?(o(),r("div",Ht,[t("div",Jt,[e[44]||(e[44]=t("h3",{class:"text-lg font-semibold mb-4 text-gray-900 dark:text-white"},"–ù–æ–≤–∞—è —Å–¥–µ–ª–∫–∞",-1)),t("form",{onSubmit:q(Z,["prevent"]),class:"space-y-3"},[t("div",null,[e[41]||(e[41]=t("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"–ù–∞–∑–≤–∞–Ω–∏–µ",-1)),u(t("input",{"onUpdate:modelValue":e[16]||(e[16]=a=>k.value.title=a),class:"mt-1 w-full border rounded px-3 py-2 dark:bg-gray-700 dark:text-white",required:""},null,512),[[g,k.value.title]])]),t("div",null,[e[42]||(e[42]=t("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"–°—É–º–º–∞ (‚ÇΩ)",-1)),u(t("input",{type:"number",min:"0",step:"0.01","onUpdate:modelValue":e[17]||(e[17]=a=>k.value.amount=a),class:"mt-1 w-full border rounded px-3 py-2 dark:bg-gray-700 dark:text-white"},null,512),[[g,k.value.amount]])]),t("div",Kt,[t("button",{type:"button",onClick:e[18]||(e[18]=a=>C.value=!1),class:"px-3 py-2 bg-gray-500 text-white rounded"},"–û—Ç–º–µ–Ω–∞"),e[43]||(e[43]=t("button",{type:"submit",class:"px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700"},"–°–æ–∑–¥–∞—Ç—å",-1))])],32)])])):i("",!0)]}),_:1})],64)}}});export{ae as default};
